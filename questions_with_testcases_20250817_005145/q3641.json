{
  "problem_code": "problems",
  "title": "Naughty and Balls",
  "tags": [],
  "text": "Mr. Naughty likes to play with balls. So his friend, Mr. Nice, gave himnballs to play a game. Each ball has exactly two numbers (the number on the top and the number on the bottom). In one move Mr. Naughty can rotate any ball so that its bottom now becomes the top. Mr. Nice knows the minimum number of such moves that can make at least half of the balls show same number on their top. So to win Mr. Nice's game, Mr. Naughty should figure out the minimum number of moves. It's not always possible to make such moves that satisfy the given condition. In this case Mr. Naughty should figure out that it is \"Impossible\" to make such moves.Help Mr. Naughty to win the game.InputThe first line contains a single integern- the number of balls. The followingnlines contain the description of all balls, one ball per line. Each description has a pair of non-negative integers not exceeding105- numbers on top and bottom. The first number in a line is the number on top, the second one - on the bottom. The number on the top of the ball may be same as the number on the bottom.The numbers in the lines are separated by single spaces.OutputOn a single line print a single integer - the minimum number of moves to win the game. If it is impossible to make the set funny, print \"Impossible\" (quotes for clarity).Constraints:1 ≤ n ≤ 105SampleInput:3\r\n3 100\r\n100 3\r\n5 4Output:1ExplanationIn this case Mr Naughty can rotate the first ball so that number on the top becomes 100. Since two of the three balls have same number on their top (100), you do not need to change anything else, so the answer is 1.Input:5\r\n5 9\r\n5 9\r\n3 2\r\n1 4\r\n5 7Output:0Input:3\r\n1 2\r\n3 4\r\n5 6Output:ImpossibleProblem Setter: Prateek Sachdev",
  "sample_input": "Input:3\r\n3 100\r\n100 3\r\n5 4Output:1",
  "sample_output": "Input:5\r\n5 9\r\n5 9\r\n3 2\r\n1 4\r\n5 7Output:0",
  "link": "https://www.spoj.com/problems/NAUGHTY",
  "scraped_at": "2025-08-17 00:34:16",
  "test_cases": [
    {
      "input": "3\r\n3 100\r\n100 3\r\n5 4",
      "expected_output": "1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5\r\n5 9\r\n5 9\r\n3 2\r\n1 4\r\n5 7",
      "expected_output": "0",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "5\n9\n9\n8\n1\n1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n5",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n6",
      "expected_output": "To be computed",
      "type": "small_case_5",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "12\n99815814\n66126142\n75244306\n43049036\n57379386\n60277754\n65623605\n53918245\n93790140\n86364569\n2517932\n1821478",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "18\n87198413\n49545561\n38084390\n60339219\n30724050\n69126482\n82390633\n89484920\n7807956\n81209679\n50383561\n70763339\n84608227\n3502540\n32722976\n18872396\n26112694\n50040605",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "9\n87221612\n66961686\n47895180\n67577055\n69471385\n29445624\n94473396\n50747530\n35022130",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n93269946\n78616739\n75272053\n82204793\n22596650\n9588261\n97663757\n65640268",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "13\n78898073\n72816792\n83511925\n81757632\n17677215\n92951745\n90585966\n92719772\n13949872\n67025730\n19763050\n86604960\n81318058",
      "expected_output": "To be computed",
      "type": "medium_case_10",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "29\n84911\n39389\n63433\n65806\n61145\n23743\n44488\n98982\n76451\n38828\n2865\n77940\n5402\n24744\n46680\n58720\n81570\n6297\n86779\n99962\n38270\n3566\n8443\n72783\n34207\n15813\n37036\n59199\n96512",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "46\n69064\n37085\n4867\n799\n89827\n26163\n24936\n84978\n20629\n73918\n47981\n21063\n89680\n43725\n69620\n17792\n44052\n67313\n65289\n13895\n88647\n48315\n42901\n15431\n84894\n33274\n22737\n13480\n73272\n57828\n15901\n81985\n29213\n68884\n85054\n66444\n11265\n2385\n60156\n35473\n29908\n24520\n3841\n25132\n86969\n38939",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "65\n81041\n22908\n83553\n8732\n74331\n4624\n83064\n62187\n59829\n87408\n10770\n75671\n67896\n20233\n17985\n18357\n59225\n18757\n51415\n95794\n59449\n66589\n66569\n30967\n27751\n42861\n20012\n49433\n18534\n8954\n5102\n50225\n66874\n81004\n480\n74774\n2932\n66912\n9837\n36772\n44528\n92515\n97357\n60265\n37262\n28946\n73516\n50024\n39964\n89011\n44107\n34147\n86301\n13206\n63745\n42395\n60594\n46969\n20345\n6929\n707\n10476\n56742\n20475\n34241",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "77\n35000\n52082\n73231\n85800\n36452\n97432\n39253\n12005\n39734\n21769\n74973\n67027\n70868\n94617\n14349\n30554\n11837\n49377\n11580\n34731\n27121\n64786\n59016\n76686\n14242\n80851\n90871\n35832\n18929\n27291\n86412\n90976\n58948\n21264\n92507\n69607\n5024\n61861\n4057\n86518\n4322\n50695\n4964\n44468\n47219\n63418\n43543\n80731\n2537\n79272\n36469\n22395\n46199\n32147\n38300\n45077\n90171\n39961\n47524\n48374\n63570\n21350\n40343\n73456\n67329\n1826\n809\n42329\n98941\n13591\n30878\n40379\n20481\n3755\n13545\n44700\n88498",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "40\n70592\n21723\n55637\n13883\n75803\n79221\n61683\n47365\n48596\n69187\n36894\n21182\n40869\n41339\n57390\n67548\n1564\n53741\n13089\n60170\n93846\n70643\n96684\n21692\n40779\n16388\n81408\n87927\n46927\n93950\n54493\n69533\n66300\n38108\n25133\n60160\n51630\n54159\n83930\n20112",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "27\n15845\n83507\n67027\n7791\n95941\n63146\n84818\n20928\n13279\n45944\n79048\n57792\n95093\n41964\n33044\n65188\n12414\n93965\n72562\n49355\n72200\n25155\n77604\n78836\n79945\n42804\n9528",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "82\n51723\n6264\n38674\n8276\n41401\n69897\n15750\n2194\n58297\n66291\n23461\n56594\n43374\n18685\n80597\n9460\n11502\n59037\n44699\n18764\n52025\n4189\n44785\n60431\n39002\n60321\n55345\n66050\n88879\n15788\n36169\n88399\n99585\n61517\n62593\n94016\n89607\n95256\n80294\n28439\n37410\n37570\n73991\n65915\n21298\n4564\n2662\n15897\n93396\n55673\n59595\n97455\n81333\n75137\n83940\n18130\n33828\n41260\n33758\n65160\n15300\n3208\n72510\n80184\n21261\n97024\n18566\n19653\n4836\n88258\n56681\n41588\n45794\n45959\n58256\n23175\n65495\n52566\n28585\n86608\n18516\n85032",
      "expected_output": "To be computed",
      "type": "large_case_17",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "105\n32520746\n76554986\n6487314\n21968013\n5348501\n44103000\n70130225\n18861260\n55688523\n36805075\n88545370\n77771787\n51669888\n91908760\n87149877\n51041567\n40072027\n372686\n75396241\n24922248\n95068067\n39257429\n85953358\n45607667\n50492967\n78750621\n8184308\n87485804\n36592167\n1026622\n63166829\n12731616\n37666176\n12755876\n6745909\n19438244\n16458249\n84519407\n76746618\n60844449\n27250974\n1384576\n33181596\n83421717\n77651041\n99571726\n12458996\n68606146\n74341763\n25863049\n96830291\n27782987\n29916818\n52741327\n78881884\n2769676\n6624449\n86082753\n86533563\n67771632\n68202560\n18666001\n3034087\n26341565\n7675110\n78326120\n29803560\n20599480\n33104020\n13837180\n40762729\n63528222\n96420640\n75257079\n18814889\n24586243\n79742120\n12929093\n81373723\n97090990\n74491116\n97695952\n97821097\n47462126\n8747584\n56114934\n21591116\n2211006\n35484400\n18397880\n47801440\n26525818\n36206319\n40914890\n87431850\n38139599\n34241451\n63130202\n44951951\n3061689\n16499758\n85714109\n17088375\n19898168\n84079780",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n56634467\n72157507\n65881721\n6966841\n120280\n83110723\n69814297\n85956024\n70326405\n86129728\n83886874\n49667831\n24550527\n44534545\n1226027\n53656655\n76887448\n76059952\n28652774\n14985494\n50537533\n75968001\n51913629\n3790645\n353235\n22309842\n62456085\n68408531\n52021212\n47007313\n34953701\n72289173\n38514290\n14721093\n18117176\n10269205\n23903844\n20301563\n5066475\n27890106\n18980080\n77312775\n45281607\n53424540\n65787402\n23601918\n25225148\n62814075\n21566801\n48071234\n22078967\n77554261\n32861953\n74012485\n21988437\n42663862\n56587592\n11049034\n79766798\n26799939\n57479977\n92266405\n79683901\n53370024\n11720041\n28028456\n23041403\n76743144\n55462360\n23255331\n14336305\n33064427\n98649921\n77130658\n36599788\n34613021\n48655186\n26056089\n94411582\n65224037\n41636627\n47574349\n18070043\n66812260\n24035493\n7742840\n89802576\n12008732\n88896179\n46534884\n72522790\n74751483\n52078037\n6600583\n48328576\n31747155\n32781338\n71948860\n91710008\n52909614\n74929820\n52765210\n43623075\n56989553\n93443169",
      "expected_output": "To be computed",
      "type": "max_case_19",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n100000000\n100000000\n1\n1\n100000000\n29179675\n1\n85702089\n100000000\n38183697\n1\n1\n100000000\n1\n1\n100000000\n1\n100000000\n100000000\n56435090\n3690659\n23175268\n1\n96360501\n39240959\n1\n82493122\n93760821\n100000000\n1\n1\n100000000\n1\n62705903\n1\n50623203\n100000000\n60645419\n47281782\n1\n1\n2359210\n94255962\n1\n100000000\n11258960\n100000000\n1\n100000000\n1\n100000000\n100000000\n1\n1\n1\n47913528\n100000000\n72723443\n100000000\n99471258\n100000000\n100000000\n1\n75764213\n58654589\n1\n100000000\n84856005\n1\n31038788\n100000000\n100000000\n1\n20141584\n100000000\n1\n100000000\n20467223\n1\n100000000\n1\n100000000\n100000000\n1\n100000000\n6067361\n1\n1\n48770535\n1\n100000000\n37866418\n99704560\n100000000\n71395247\n100000000\n100000000\n100000000\n73914197\n10219647\n1\n97887027\n1\n45402182\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 105)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:57",
  "total_test_cases": 20
}