{
  "problem_code": "problems",
  "title": "Game, Set and Match",
  "tags": [],
  "text": "In this problem you need to assist in computing the probability of winning at tennis. Here is a brief explanation of how the scoring system works. In a tennismatch, players play a certain number of consecutivesets. Eachsetis in turn made up of a series ofgames(and may include atie-breakif needed). Finally each game is made ofpoints.PointsEvery point is started by one of the players serving (i.e. hitting the ball into the service box in the opposite court) and the other receiving serve. The server then attempts to return the ball into the server’s court and players alternate hitting the ball across the net. When one of the players fails to make a legal return (e.g. if the ball is knocked out of the court), he or she loses the point. The specifics of how points are won are not important to us.GamesThe scoring system within a game is peculiar to say the least. As the player wins points in a game, his score goes from the initial value of 0 (read “love”) to 15, 30, or 40 (yes, just when you think you’re starting to spot a pattern in this mess it breaks down). There is no a-priori limit to the length of a game (meaning the number of points played), but a player’s score is always indicated by one of these numbers according to the following rules. When a player has three points (score 40) and wins the following point as well, he wins the game unless the score was 40−40 (read “deuce”) to start with. A player needs to win two consecutive points from deuce to win the game. Winning one gives him advantage; if followed by a second winning point the game is won by him, but if followed by a losing point the score reverts to deuce.Example: at 40−30, if the first player wins the next point he wins the game. However, if the second player wins the next three points the game is his.SetsA player wins a set if he wins at least six games (in the current set) and he is two games ahead of his opponent but, as you may be starting to suspect, there is yet another exception. In case the score for the number of games won reaches six-all (6−6), a tie-break is played instead to decide the set.Example: at 5−4, if the first player wins the next game he takes the set 6−4. But if he loses, the set is still undecided and can eventually go to either 7−5, 5−7 or a tie-break.Tie-breakA tie-break (and the set to which it belongs) is won when a player wins at least seven points by a margin of two points or more.MatchThe winner of a match is the first player to win 2 sets (the wins do not need to be consecutive). Hence a match may go to 2 or 3 sets depending on how the game develops.Rafa has been carefully studying his past performances against his next opponent and he knows he wins each point with probability preciselyp, irrespective of whether he is serving or receiving and regardless of all other points played. Can you help him assess his chances of winning the match?InputEach test case is described by a single floating point numberp, 0 ≤p≤ 1 in its own line. A value of −1 forpmarks the end of the input.OutputFor each test case, print a single line with the probabilities of Rafa winning a given game, set and match, respectively. These three numbers must be separated by a space character. Your answers should be accurate to within an absolute error of 10−6.ExampleInput:0.5\r\n0.3\r\n0.7\r\n-1Output:0.50000000000 0.50000000000 0.50000000000\r\n0.09921103448 0.00016770463 0.00000008437\r\n0.90078896552 0.99983229537 0.99999991563Problem setter: David García Soriano",
  "sample_input": "Input:0.5\r\n0.3\r\n0.7\r\n-1Output:0.50000000000 0.50000000000 0.50000000000\r\n0.09921103448 0.00016770463 0.00000008437\r\n0.90078896552 0.99983229537 0.99999991563",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/GSM",
  "scraped_at": "2025-08-17 00:33:59",
  "test_cases": [
    {
      "input": "0.5\r\n0.3\r\n0.7\r\n-1",
      "expected_output": "0.50000000000 0.50000000000 0.50000000000\r\n0.09921103448 0.00016770463 0.00000008437\r\n0.90078896552 0.99983229537 0.99999991563",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "10\n6\n9\n8",
      "expected_output": "0",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "7\n2\n3\n2",
      "expected_output": "0",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "8\n1\n7\n6",
      "expected_output": "0",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "65\n89\n29\n22",
      "expected_output": "0",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "66\n42\n42\n10",
      "expected_output": "0",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "83\n24\n16\n37",
      "expected_output": "0",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "21\n81\n99\n88",
      "expected_output": "0",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "16\n3\n65\n72",
      "expected_output": "0",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "298\n364\n88\n264",
      "expected_output": "0",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "416\n202\n312\n424",
      "expected_output": "0",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "233\n72\n260\n384",
      "expected_output": "0",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "67\n100\n389\n451",
      "expected_output": "0",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "311\n93\n230\n478",
      "expected_output": "0",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "390\n72\n158\n466",
      "expected_output": "0",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "257\n132\n282\n140",
      "expected_output": "0",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000\n1000\n1000\n1000",
      "expected_output": "0",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000\n1000\n1000\n1000",
      "expected_output": "0",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "2\n999\n2\n1000",
      "expected_output": "0",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "1\n1\n1\n2",
      "expected_output": "0",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:52",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:25"
}