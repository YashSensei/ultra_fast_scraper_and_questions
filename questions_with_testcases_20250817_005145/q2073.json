{
  "problem_code": "problems",
  "title": "Isabella Message",
  "tags": [],
  "text": "Isabella and Steve are very good friends, and they often write letters to each other. They exchange funny experiences, talk about people around, share their feelings and write about almost everything through the letters. When the letters are delivered, they are quite afraid that some other people (maybe their parents) would peek. So they encrypted the letter, and only they know how to decrypt it. This guarantees their privacy.The encrypted message is anN×Nmatrix, and each grid contains a character.Steve uses a special mask to work as a key. The mask isN×N(whereNis an even number) matrix with (N×N)/4 holes of size1×1on it.The decrypt process consist of the following steps:Put the mask on the encrypted message matrix.Write down the characters you can see through the holes, from top to down, then from left to right.Rotate the mask by 90 degrees clockwise.Go to step 2, unless you have wrote down all theN×Ncharacters in the message matrix.Erase all the redundant white spaces in the message.For example, you got a message shown in figure 1, and you have a mask looks like figure 2. The decryption process is shown in figure 3, and finally you may get a message\"good morning\".You can assume that the mask is always carefully chosen that each character in the encrypted message will appear exactly once during decryption.However, in the first step of decryption, there are several ways to put the mask on the message matrix, because the mask can be rotated (but not flipped). So you may get different results such as\"od morning go\"(as showed in figure 4), and you may also get other messages like\"orning good m\",\"ng good morni\".Steve didn't know which direction of the mask should be chosen at the beginning, but after he tried all possibilities, he found that the message\"good morning\"is the only one he wanted because he couldn't recognize some words in the other messages. So he will always consider the message he can understand the correct one. Whether he can understand a message depends whether he knows all the words in the message. If there are more than one ways to decrypt the message into an understandable one, he will choose the lexicographically smallest one. The way to compare two messages is to compare the words of two messages one by one, and the first pair of different words in the two messages will determine the lexicographic order of them.Isabella sends letters to Steve almost every day. As decrypting Isabella's message takes a lot of time, and Steve can wait no longer to know the content of the message, he asked you for help. Now you are given the message he received, the mask, and the list of words he already knew, can you write a program to help him decrypt it?InputThe first line contains an integerT(1 ≤T≤ 100), indicating the number of test cases.Each test case contains several lines. The first line contains an even integerN(2 ≤N≤ 50), indicating the size of the matrix.The followingNlines each contains exactlyNcharacters, representing the message matrix. The message only contains lowercase letters and periods ('.'), where periods represent the white spaces. You can assume the matrix contains at least one letter.The followingNlines each containsNcharacters, representing the mask matrix. The asterisk ('*') represents a hole, and period ('.') otherwise.\r\nThe next line contains an integerM(1 ≤M≤ 100), the number of words he knew.Then the followingMlines each contains a string represents a word. The words only contain lowercase letters, and its length will not exceed 20.OutputFor each test case in the input, print one line:\"Case #X: Y\", whereXis the test case number (starting with 1) andYis Isabella's message.If Steve cannot understand the message, just print theYas\"FAIL TO DECRYPT\".ExampleInput:3\r\n4\r\no.do\r\n.ng.\r\ngrmn\r\no.i.\r\n.*..\r\n*.*.\r\n....\r\n*...\r\n2\r\ngood\r\nmorning\r\n4\r\n..lf\r\neoyv\r\noeou\r\nvrer\r\n..*.\r\n.*..\r\n....\r\n*.*.\r\n5\r\ni\r\nyou\r\nthe\r\nlove\r\nforever\r\n4\r\n.sle\r\ns.c.\r\ne.fs\r\n..uu\r\n*...\r\n.*..\r\n...*\r\n..*.\r\n1\r\nsuccessfulOutput:Case #1: good morning\r\nCase #2: love you forever\r\nCase #3: FAIL TO DECRYPT",
  "sample_input": "Input:3\r\n4\r\no.do\r\n.ng.\r\ngrmn\r\no.i.\r\n.*..\r\n*.*.\r\n....\r\n*...\r\n2\r\ngood\r\nmorning\r\n4\r\n..lf\r\neoyv\r\noeou\r\nvrer\r\n..*.\r\n.*..\r\n....\r\n*.*.\r\n5\r\ni\r\nyou\r\nthe\r\nlove\r\nforever\r\n4\r\n.sle\r\ns.c.\r\ne.fs\r\n..uu\r\n*...\r\n.*..\r\n...*\r\n..*.\r\n1\r\nsuccessfulOutput:Case #1: good morning\r\nCase #2: love you forever\r\nCase #3: FAIL TO DECRYPT",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ISAB",
  "scraped_at": "2025-08-17 00:33:47",
  "test_cases": [
    {
      "input": "3\r\n4\r\no.do\r\n.ng.\r\ngrmn\r\no.i.\r\n.*..\r\n*.*.\r\n....\r\n*...\r\n2\r\ngood\r\nmorning\r\n4\r\n..lf\r\neoyv\r\noeou\r\nvrer\r\n..*.\r\n.*..\r\n....\r\n*.*.\r\n5\r\ni\r\nyou\r\nthe\r\nlove\r\nforever\r\n4\r\n.sle\r\ns.c.\r\ne.fs\r\n..uu\r\n*...\r\n.*..\r\n...*\r\n..*.\r\n1\r\nsuccessful",
      "expected_output": "Case #1: good morning\r\nCase #2: love you forever\r\nCase #3: FAIL TO DECRYPT",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5\n4\n4\n6\n5\n5",
      "expected_output": "5\n4\n4\n6\n5\n5",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n3\n2\n5\n6",
      "expected_output": "4\n3\n2\n5\n6",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n9\n9\n7\n9\n3",
      "expected_output": "5\n9\n9\n7\n9\n3",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "7\n82368358\n88618549\n67212872\n39068721\n1563080\n87185924\n39247161",
      "expected_output": "7\n82368358\n88618549\n67212872\n39068721\n1563080\n87185924\n39247161",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "19\n25098213\n36048863\n15440861\n75987578\n86518280\n65750269\n61027255\n79772043\n28690538\n76777334\n72170224\n97962785\n14187851\n12774481\n3744635\n16929023\n95059205\n61979942\n58951154",
      "expected_output": "19\n25098213\n36048863\n15440861\n75987578\n86518280\n65750269\n61027255\n79772043\n28690538\n76777334\n72170224\n97962785\n14187851\n12774481\n3744635\n16929023\n95059205\n61979942\n58951154",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n69100781\n53088471\n44934267\n58079543\n992657\n71714474\n59622501\n2543389\n18782512\n43492803\n70551350\n14780337\n78265961\n67682856\n23741723\n26893871",
      "expected_output": "16\n69100781\n53088471\n44934267\n58079543\n992657\n71714474\n59622501\n2543389\n18782512\n43492803\n70551350\n14780337\n78265961\n67682856\n23741723\n26893871",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "20\n47410021\n20478699\n97016961\n3342665\n75831064\n59302669\n58646889\n23962908\n43065546\n41495447\n30527917\n16901034\n23619239\n65317516\n6840317\n42929043\n15306780\n34688047\n53273748\n45444975",
      "expected_output": "20\n47410021\n20478699\n97016961\n3342665\n75831064\n59302669\n58646889\n23962908\n43065546\n41495447\n30527917\n16901034\n23619239\n65317516\n6840317\n42929043\n15306780\n34688047\n53273748\n45444975",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "7\n1790080\n71693304\n84319196\n30747858\n6672130\n19128543\n11544514",
      "expected_output": "7\n1790080\n71693304\n84319196\n30747858\n6672130\n19128543\n11544514",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "26\n43741\n6272\n74741\n94666\n37719\n69039\n57832\n1754\n13061\n49722\n65064\n12961\n18572\n72610\n46999\n98786\n34832\n81407\n15913\n68038\n9166\n5590\n46791\n63512\n35635\n69492",
      "expected_output": "26\n43741\n6272\n74741\n94666\n37719\n69039\n57832\n1754\n13061\n49722\n65064\n12961\n18572\n72610\n46999\n98786\n34832\n81407\n15913\n68038\n9166\n5590\n46791\n63512\n35635\n69492",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "37\n67980\n21520\n92379\n17124\n9086\n56824\n311\n83620\n57871\n28633\n37811\n22231\n4205\n22946\n89122\n99081\n73800\n74567\n31712\n10040\n10853\n36501\n49589\n69787\n76647\n8249\n32501\n35382\n55163\n28430\n28911\n62596\n90571\n4592\n99854\n140\n73191",
      "expected_output": "37\n67980\n21520\n92379\n17124\n9086\n56824\n311\n83620\n57871\n28633\n37811\n22231\n4205\n22946\n89122\n99081\n73800\n74567\n31712\n10040\n10853\n36501\n49589\n69787\n76647\n8249\n32501\n35382\n55163\n28430\n28911\n62596\n90571\n4592\n99854\n140\n73191",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "36\n94082\n32817\n94156\n25928\n47408\n20596\n92202\n41669\n36259\n2569\n20763\n16978\n31630\n18837\n2879\n22164\n8313\n89377\n58192\n36318\n15426\n16320\n37227\n70942\n3663\n12229\n14608\n11915\n81664\n95659\n48063\n89064\n91998\n18282\n53101\n98418",
      "expected_output": "36\n94082\n32817\n94156\n25928\n47408\n20596\n92202\n41669\n36259\n2569\n20763\n16978\n31630\n18837\n2879\n22164\n8313\n89377\n58192\n36318\n15426\n16320\n37227\n70942\n3663\n12229\n14608\n11915\n81664\n95659\n48063\n89064\n91998\n18282\n53101\n98418",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "43\n35701\n93387\n52932\n69723\n60013\n63289\n64140\n705\n65618\n63680\n69391\n31797\n2244\n3616\n74317\n19773\n70765\n81897\n48755\n67819\n71310\n48683\n59481\n95051\n84558\n972\n65677\n4312\n51080\n71339\n93360\n98035\n20078\n5469\n36530\n90111\n21630\n91711\n24846\n25490\n42403\n71781\n70793",
      "expected_output": "43\n35701\n93387\n52932\n69723\n60013\n63289\n64140\n705\n65618\n63680\n69391\n31797\n2244\n3616\n74317\n19773\n70765\n81897\n48755\n67819\n71310\n48683\n59481\n95051\n84558\n972\n65677\n4312\n51080\n71339\n93360\n98035\n20078\n5469\n36530\n90111\n21630\n91711\n24846\n25490\n42403\n71781\n70793",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "42\n39548\n57751\n95629\n22675\n8523\n89776\n86749\n71946\n91104\n34433\n94850\n61473\n9944\n32214\n62032\n88520\n65338\n14081\n12365\n55277\n7817\n29004\n38259\n1959\n39817\n94991\n17548\n74004\n46913\n12132\n91700\n34643\n10389\n98445\n7774\n48287\n91760\n64016\n18259\n72310\n13227\n9212",
      "expected_output": "42\n39548\n57751\n95629\n22675\n8523\n89776\n86749\n71946\n91104\n34433\n94850\n61473\n9944\n32214\n62032\n88520\n65338\n14081\n12365\n55277\n7817\n29004\n38259\n1959\n39817\n94991\n17548\n74004\n46913\n12132\n91700\n34643\n10389\n98445\n7774\n48287\n91760\n64016\n18259\n72310\n13227\n9212",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "49\n82259\n43034\n32498\n27422\n33569\n19181\n23914\n51490\n1025\n60987\n6635\n66934\n98474\n1760\n92870\n65001\n12236\n37765\n48282\n21499\n9898\n21083\n18667\n81349\n69474\n22011\n78061\n97612\n97949\n65172\n97148\n27475\n78744\n2068\n28368\n18751\n15888\n24829\n16317\n32943\n11080\n46892\n72100\n51019\n54812\n3884\n97709\n74290\n73550",
      "expected_output": "49\n82259\n43034\n32498\n27422\n33569\n19181\n23914\n51490\n1025\n60987\n6635\n66934\n98474\n1760\n92870\n65001\n12236\n37765\n48282\n21499\n9898\n21083\n18667\n81349\n69474\n22011\n78061\n97612\n97949\n65172\n97148\n27475\n78744\n2068\n28368\n18751\n15888\n24829\n16317\n32943\n11080\n46892\n72100\n51019\n54812\n3884\n97709\n74290\n73550",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "49\n24765\n7383\n56239\n77657\n11218\n34837\n62626\n49124\n96580\n20806\n41248\n86171\n32302\n14479\n59013\n88712\n23725\n43986\n96167\n25819\n75596\n69970\n16995\n71664\n20870\n59530\n45326\n30284\n76500\n50338\n46676\n74371\n19937\n65821\n29340\n51879\n48816\n7152\n70276\n83503\n84811\n10300\n74555\n8254\n94919\n31537\n99699\n61978\n17680",
      "expected_output": "49\n24765\n7383\n56239\n77657\n11218\n34837\n62626\n49124\n96580\n20806\n41248\n86171\n32302\n14479\n59013\n88712\n23725\n43986\n96167\n25819\n75596\n69970\n16995\n71664\n20870\n59530\n45326\n30284\n76500\n50338\n46676\n74371\n19937\n65821\n29340\n51879\n48816\n7152\n70276\n83503\n84811\n10300\n74555\n8254\n94919\n31537\n99699\n61978\n17680",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "50\n63623907\n73769500\n30683576\n48759330\n26860677\n57881750\n27751997\n2601259\n90001906\n91064553\n59866488\n29942012\n111874\n52445903\n62481048\n80333397\n37966206\n39636242\n42044205\n85072777\n47672514\n83819237\n11829952\n40989460\n6088553\n7495950\n80096445\n84722686\n77691469\n8149673\n88173695\n32272507\n49204623\n26180227\n48919071\n81292642\n99173006\n11126509\n79441606\n40767914\n53912036\n89283474\n96213306\n29303405\n4078394\n20229655\n42531278\n3206065\n26130464\n29697677",
      "expected_output": "50\n63623907\n73769500\n30683576\n48759330\n26860677\n57881750\n27751997\n2601259\n90001906\n91064553\n59866488\n29942012\n111874\n52445903\n62481048\n80333397\n37966206\n39636242\n42044205\n85072777\n47672514\n83819237\n11829952\n40989460\n6088553\n7495950\n80096445\n84722686\n77691469\n8149673\n88173695\n32272507\n49204623\n26180227\n48919071\n81292642\n99173006\n11126509\n79441606\n40767914\n53912036\n89283474\n96213306\n29303405\n4078394\n20229655\n42531278\n3206065\n26130464\n29697677",
      "type": "max_case_17",
      "description": "Maximum size array (N = 50)"
    },
    {
      "input": "50\n21928621\n15420328\n89916500\n9656569\n63734540\n55922268\n84583252\n83936828\n77244650\n13677414\n74194132\n72438881\n3535410\n86752849\n18643911\n1689401\n92514433\n62235072\n12753036\n18751943\n76134029\n95400457\n9875342\n97634510\n2197020\n83356794\n59140540\n95060683\n24922905\n89535169\n47907956\n87845086\n17814903\n65080386\n41435377\n52693036\n60153015\n5998394\n87560129\n62214405\n64824852\n72890845\n3259441\n10531969\n72289662\n88701715\n69765379\n38532812\n26227568\n8295315",
      "expected_output": "50\n21928621\n15420328\n89916500\n9656569\n63734540\n55922268\n84583252\n83936828\n77244650\n13677414\n74194132\n72438881\n3535410\n86752849\n18643911\n1689401\n92514433\n62235072\n12753036\n18751943\n76134029\n95400457\n9875342\n97634510\n2197020\n83356794\n59140540\n95060683\n24922905\n89535169\n47907956\n87845086\n17814903\n65080386\n41435377\n52693036\n60153015\n5998394\n87560129\n62214405\n64824852\n72890845\n3259441\n10531969\n72289662\n88701715\n69765379\n38532812\n26227568\n8295315",
      "type": "max_case_18",
      "description": "Maximum size array (N = 50)"
    },
    {
      "input": "1\n100000000",
      "expected_output": "1\n100000000",
      "type": "edge_case_19",
      "description": "Edge case array (N = 1)"
    },
    {
      "input": "1\n38503165",
      "expected_output": "1\n38503165",
      "type": "edge_case_20",
      "description": "Edge case array (N = 1)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:52",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:24"
}