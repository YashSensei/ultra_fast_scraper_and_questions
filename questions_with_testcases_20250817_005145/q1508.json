{
  "problem_code": "problems",
  "title": "Incomplete hierarchy",
  "tags": [],
  "text": "After many years of art, young Florian wants to work in a conglomerate. This company consists of N employees denoted 1, 2 ... N, of which some areinterns. Florian knows all interns in this company. In the hierarchy, every employee has a single boss, except for one employee (the CEO) who does not have a boss. There is no cycle within the hierarchy; in other words, the hierarchy is a tree. Also,anintern cannot be superior to a non-intern.Speaking to interns, Florian has collected a wealth of information aboutpartsof the hierarchy. Namely, for every intern he knows who his/her boss is (this boss could also be an intern).Florian now counts the distance of two interns in the hierarchy, which is the number of bosses between these interns. More precisely, thedistance in the hierarchybetween two employees is obtained by climbing the hierarchy starting with them, and counting all their direct or indirect superiors up to their first common superior (including him). If one of the observed two employees is superior to another (directly or indirectly), we only count the employees who are strictly between them in the hierarchy.Help young Florian determine thelargest distance of two internsacross the hierarchy, if this number can be uniquely determined from the known data.InputThe first line contains two integers N and M, the total number of employees in the company and the number of interns (2 ≤ M < N ≤ 100 000).Each of the following M lines contains two integers A and B, intern and his boss (1 ≤ A, B ≤ N, A ≠ B). No intern will have two bosses.OutputPrint the required largest intern distance, or -1 if the answer cannot be determined.ExamplesInput:5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4Output:2Input:7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6Output:-1Input:3 2\r\n2 1\r\n3 1Output:1",
  "sample_input": "Input:5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4Output:2",
  "sample_output": "Input:7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6Output:-1",
  "link": "https://www.spoj.com/problems/PODUZECE",
  "scraped_at": "2025-08-17 00:33:41",
  "test_cases": [
    {
      "input": "5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4",
      "expected_output": "2",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6",
      "expected_output": "-1",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "10 8\n5 9\n10 5\n4 8\n6 8",
      "expected_output": "0",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "2 6\n1 1\n10 9\n7 2\n3 1",
      "expected_output": "0",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "1 8\n1 4\n9 9\n1 1\n7 3",
      "expected_output": "0",
      "type": "small_case_5",
      "description": "Generated small test case"
    },
    {
      "input": "75 43\n30 55\n69 9\n70 35\n65 45",
      "expected_output": "0",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "10 48\n97 68\n10 91\n39 32\n58 48",
      "expected_output": "0",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "22 38\n51 67\n75 35\n32 60\n11 58",
      "expected_output": "0",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "82 79\n88 20\n47 36\n66 32\n36 11",
      "expected_output": "0",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "23 7\n68 49\n1 15\n95 69\n27 74",
      "expected_output": "0",
      "type": "medium_case_10",
      "description": "Generated medium test case"
    },
    {
      "input": "10029 8168\n29195 22090\n49223 18074\n27697 47994\n10935 14960",
      "expected_output": "0",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "19322 7447\n42143 7741\n30154 20545\n31589 29796\n49257 5408",
      "expected_output": "0",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "24144 28908\n18138 7764\n25229 35341\n17939 38702\n27613 25610",
      "expected_output": "0",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "46598 30066\n21326 20259\n12199 19538\n40550 38977\n9092 39094",
      "expected_output": "0",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "45655 16849\n36788 12430\n30359 19523\n42275 8291\n49544 42973",
      "expected_output": "0",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "40546 41234\n23566 10172\n22133 16597\n25093 10555\n31633 10821",
      "expected_output": "0",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "23852 25454\n13568 13027\n31711 11214\n12929 7506\n30293 9818",
      "expected_output": "0",
      "type": "large_case_17",
      "description": "Generated large test case"
    },
    {
      "input": "100000 100000\n100000 100000\n100000 100000\n100000 100000\n100000 100000",
      "expected_output": "0",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "100000 100000\n100000 100000\n100000 100000\n100000 100000\n100000 100000",
      "expected_output": "0",
      "type": "max_case_19",
      "description": "Generated max test case"
    },
    {
      "input": "2 2\n2 1\n100000 99999\n100000 100000\n1 99999",
      "expected_output": "0",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:50",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:05"
}