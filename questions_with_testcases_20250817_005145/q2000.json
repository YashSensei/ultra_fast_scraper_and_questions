{
  "problem_code": "problems",
  "title": "Building Bridges(HARD)",
  "tags": [],
  "text": "The tribe soon discovers that just communication is not enough and wants to meet each other to form a joint force against the terminator. But there is a deep canyon that needs to crossed. Points have been identified on both sides on which bridge ends can be made. But before the construction could be started, a witch Chudael predicted that a bridge can only be built between corresponding end points, i.e. a bridge starting from the ithend point on one side can only end on the ithend point on the other side, where the position of end points is seen in the order in which the points were identified. If not, it would lead to the end of the tribe. The tribe just wants to make as many non-overlapping bridges as possible, with the constraint in mind.InputThe first line of the input contains test cases t. It is followed by 3×t lines, 3 for each test case. The first line of input for each test case contains the number of end points identified on each side, n (1 ≤ n ≤ 105). The second line contains x-coordinates of end points identified on the first side and similarly the third line contains the x-coordinates of corresponding end points identified on the other side. The end points are inputted in the order in which they were identified. The x-coordinates can range between -106to 106.OutputYou are required to output a single line for each test case. The line contains a single integer – the maximum number of bridges possible with the constraints explained above.ExampleInput:3\r\n4\r\n2 5 8 10\r\n6 4 1 2\r\n3\r\n5 3 10\r\n6 4 1\r\n6\r\n1 2 3 4 5 6\r\n3 4 5 6 1 2Output:2\r\n2\r\n4ExplanationFor the first test case, two non-overlapping bridges can be formed between the 3rd and 4th end points on each side.(This problem is based onBRIDGE.)",
  "sample_input": "Input:3\r\n4\r\n2 5 8 10\r\n6 4 1 2\r\n3\r\n5 3 10\r\n6 4 1\r\n6\r\n1 2 3 4 5 6\r\n3 4 5 6 1 2Output:2\r\n2\r\n4",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/BRDGHRD",
  "scraped_at": "2025-08-17 00:34:04",
  "test_cases": [
    {
      "input": "3\r\n4\r\n2 5 8 10\r\n6 4 1 2\r\n3\r\n5 3 10\r\n6 4 1\r\n6\r\n1 2 3 4 5 6\r\n3 4 5 6 1 2",
      "expected_output": "2\r\n2\r\n4",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5\n8\n10\n10\n5\n1",
      "expected_output": "0\n0\n0\n0\n0",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "2\n10\n2",
      "expected_output": "0\n0",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n8\n9\n4\n1",
      "expected_output": "0\n0\n0\n0",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "19\n771533\n49225912\n46608682\n51694471\n62467883\n78082419\n34263772\n65788032\n15886376\n56295909\n17498147\n46427345\n95284694\n54035670\n31105718\n12764300\n26733340\n90805170\n57035034",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "13\n85064696\n27099196\n12200182\n68263527\n68102046\n87594486\n81611647\n12149963\n20687796\n60203156\n73192624\n38465258\n23281916",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "9\n72705042\n21345755\n61105212\n40232999\n69596121\n70299695\n75457035\n25586061\n55331168",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "5\n4360771\n11242682\n66681769\n11437255\n21271237",
      "expected_output": "0\n0\n0\n0\n0",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "7\n93500999\n7292730\n43895020\n49376599\n39783640\n7694157\n67238143",
      "expected_output": "0\n0\n0\n0\n0\n0\n0",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "89\n15092\n19444\n99477\n35316\n80454\n24508\n19902\n47227\n70387\n67476\n61754\n50203\n20654\n62339\n84223\n88631\n31060\n72335\n68083\n85907\n54604\n72988\n49582\n75507\n82406\n44541\n96835\n51836\n24512\n49688\n20188\n38030\n62350\n26922\n54685\n89816\n85140\n6046\n21845\n20508\n16218\n5230\n39361\n41244\n8153\n67160\n22452\n55071\n56644\n36027\n96173\n48592\n42604\n37860\n91289\n55177\n99202\n44933\n96871\n65452\n78273\n65824\n44812\n59149\n34095\n46057\n6486\n59488\n1161\n21073\n88284\n88268\n72201\n59882\n70845\n92096\n84599\n45844\n6004\n841\n10550\n32654\n7650\n54471\n73581\n69906\n42380\n93168\n60285",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "60\n16618\n6910\n68591\n78714\n44265\n36400\n82639\n33164\n71257\n86856\n27053\n73725\n94066\n43857\n14689\n68458\n86701\n78465\n65163\n80020\n1262\n28999\n96165\n39612\n28714\n26564\n94138\n94324\n21384\n60099\n10533\n12201\n84533\n7479\n44930\n33560\n71276\n5849\n18664\n5030\n43020\n4367\n64637\n27720\n70547\n2667\n56853\n66676\n36176\n73532\n14731\n61636\n44637\n66833\n54767\n19546\n92416\n32737\n82890\n74972",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "37\n167\n3495\n17861\n68610\n34103\n31769\n92142\n50701\n7503\n22696\n72291\n64344\n96295\n188\n56969\n78825\n56665\n724\n55849\n81782\n59961\n74981\n23286\n75071\n72981\n36250\n82500\n32702\n75344\n7692\n70843\n74571\n47060\n31461\n76302\n27385\n92488",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "96\n83026\n69042\n5608\n22546\n87639\n17022\n39771\n41281\n32180\n40071\n80762\n60665\n40688\n80433\n88509\n84870\n56702\n78230\n91818\n89524\n30212\n39454\n44552\n97569\n33756\n90457\n25850\n28434\n33964\n33685\n13816\n98505\n42298\n94556\n78848\n94191\n24648\n81291\n9455\n13555\n33053\n79774\n15300\n36115\n38374\n38515\n95811\n7540\n69538\n40110\n55601\n38559\n63669\n38404\n14395\n3075\n19196\n51708\n83975\n10237\n4818\n8561\n21464\n45625\n44442\n23569\n98740\n38122\n38162\n11904\n75407\n84393\n30013\n98159\n22178\n31619\n34619\n53939\n17739\n87149\n59619\n51802\n96158\n70895\n40351\n70532\n97676\n55604\n62925\n68117\n68434\n50502\n532\n48105\n23871\n68596",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "75\n15097\n36335\n16729\n99072\n69824\n9039\n66103\n38869\n94356\n25859\n48754\n61705\n39765\n69680\n51448\n73922\n46982\n84037\n51103\n52398\n26298\n97925\n65939\n18917\n58913\n21111\n32906\n87477\n50979\n95458\n14266\n38052\n67736\n21602\n61142\n96315\n66263\n89781\n34583\n8766\n65013\n21258\n36168\n609\n98115\n12998\n17512\n34554\n31358\n33365\n5765\n55585\n93714\n74430\n14275\n1884\n457\n59875\n10807\n46898\n82325\n40875\n48403\n80841\n11121\n20994\n64400\n81802\n87589\n24643\n36197\n83330\n28346\n18170\n62502",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "88\n33688\n77263\n70314\n6835\n21333\n29053\n91361\n68817\n70238\n76506\n23521\n54900\n82353\n96326\n90447\n92216\n85921\n96555\n36983\n25539\n49054\n19882\n88793\n55393\n58068\n98188\n6400\n8231\n96629\n46300\n938\n51780\n25603\n28300\n78200\n3162\n89799\n89274\n40384\n40550\n84104\n80250\n14604\n65416\n63438\n30302\n81335\n71296\n3512\n41479\n61254\n32921\n60578\n50990\n94651\n49240\n29293\n36540\n7502\n87476\n62265\n38648\n51352\n25552\n82268\n54247\n28798\n24330\n40018\n45629\n33250\n75048\n69222\n25259\n38508\n74179\n33530\n93739\n29932\n8969\n12206\n79436\n65583\n11674\n84013\n58591\n44363\n62638",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "39\n3892\n56196\n52225\n65788\n46004\n55503\n25582\n87302\n22831\n37398\n6401\n46966\n3088\n18267\n27218\n11726\n90663\n35698\n52958\n49939\n21228\n78777\n44580\n44132\n46797\n23617\n57166\n65321\n77655\n42858\n67812\n75637\n19822\n10281\n42992\n35809\n76570\n35434\n58685",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "105\n44644950\n51662850\n10144139\n9933485\n75193187\n37804261\n76600171\n82600052\n50196870\n32352412\n62039389\n58257325\n64925086\n67958135\n31135048\n71490928\n41142933\n11311725\n91756321\n59955334\n16653003\n50355481\n7333285\n85058009\n48272012\n70642430\n77904671\n32216439\n96482255\n13024272\n29986820\n24922222\n23133543\n3926043\n27459833\n83611400\n4099340\n98937615\n61196642\n6320563\n13519155\n35651856\n69930514\n14047064\n54848654\n13175269\n77591635\n27061582\n71858504\n96355427\n15682985\n41385690\n43809531\n24630284\n50876159\n14221063\n27061891\n90525228\n56754124\n96375463\n47840492\n22575517\n83732396\n58865185\n71850565\n82753340\n18531799\n91562236\n5140484\n29038814\n8337497\n78900908\n64647628\n62585507\n13952791\n78724511\n37403029\n80930666\n6259138\n97079238\n1754677\n47685837\n89691173\n39700090\n43501424\n18049389\n61293385\n15739329\n2419190\n14977134\n75979900\n41067340\n70600191\n3075684\n4507347\n65477103\n29753012\n19659450\n477567\n89462908\n8350454\n85973515\n93997037\n25154385\n53870365",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "max_case_17",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n56762966\n25621943\n40336253\n44742407\n27390514\n80859493\n33439202\n50303280\n14428093\n78898299\n19716819\n99157377\n80345842\n73540615\n41647850\n58779178\n91279187\n68437819\n25668274\n92197879\n34002816\n38884334\n13850052\n15280334\n14350994\n78900775\n98043430\n99930484\n88408376\n3345260\n7197245\n31259945\n5691159\n47339778\n56976556\n38864623\n11605380\n4195280\n84210400\n99254818\n18980880\n77179912\n83440639\n29651223\n81944024\n67474573\n91139668\n98540826\n35355038\n13058475\n8023443\n57220662\n26979522\n90807839\n37225184\n92877976\n43683580\n14374590\n35044952\n91815702\n91283417\n29745225\n75469499\n3088215\n3470506\n39598401\n48797631\n69120041\n36429166\n1444256\n4364288\n50713368\n65967910\n15011706\n88197770\n92908659\n65260573\n83151876\n82696373\n47222155\n61118690\n74131388\n88834643\n75027523\n53087084\n20239484\n25287486\n61003770\n84677369\n78578373\n37576675\n10082925\n98480608\n9908198\n79113827\n91019619\n6055784\n30334438\n94540672\n79304608\n28445501\n909346\n21639866\n38421896\n30585340",
      "expected_output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "type": "max_case_18",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "2\n7111727\n16644916",
      "expected_output": "0\n0",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "2\n1\n100000000",
      "expected_output": "0\n0",
      "type": "edge_case_20",
      "description": "Edge case array (N = 2)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:51",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:22"
}