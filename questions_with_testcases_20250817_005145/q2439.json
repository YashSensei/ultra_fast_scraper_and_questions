{
  "problem_code": "problems",
  "title": "Rainbow",
  "tags": [],
  "text": "This time Blue Mary continues doing meaningless calculations! (see problemSPY) She is interested in calculating theK-th power of a very largeN×Nmatrix A, whereAi,j= i ×D+Qji and j are 0-based index of the row and column of element Ai,j, respectively.Now she needs your help (again).To keep the output small, you are only asked to output some of its elements.InputMultiple test cases.The first line of each test case contains 5 space-separated integersN,K,D,Q,Min this order.Mlines follow, each contains two space-separated integersRiandCi.Input terminates by EOF.All input numbers are non-negative integers and no more than 109.(D,RiandCimay be 0, others must be positive integers.)NandMwill be no more than 105.RiandCiwill be less thanN.Input is almost uniformly-random generated, and the number of \"large\" test cases is relatively small.OutputFor each test case output exactlyMlines. Each line contains only one integer: The number at theRi-th row andCi-th column (0-based) of the matrixAK. As the result may be quite large, output it modulo 109+2015.ExampleInput:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_input": "Input:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/RAINBOW2",
  "scraped_at": "2025-08-17 00:34:06",
  "test_cases": [
    {
      "input": "10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1",
      "expected_output": "100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1 7 10 10 6\n8 8\n4 4\n6 10\n9 10\n1 3\n8 8\n5 4\n3 9\n2 7\n8 3\n4 8 4 9 9\n10 7\n5 9\n1 2\n2 1",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "7 7 4 9 4\n5 5\n8 4\n9 9\n10 9\n10 2\n7 4\n6 3\n7 6\n2 9\n6 7\n3 8 9 1 2\n9 1\n3 3\n9 5\n10 4",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "9 5 10 9 6\n9 1\n9 5\n4 6\n4 7\n1 4\n5 2\n9 8\n7 3\n10 8\n8 4\n5 2 4 9 9\n3 1\n10 6\n2 9\n3 5",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "90 44 21 91 81\n47 37\n34 82\n81 32\n31 44\n43 71\n46 80\n49 40\n73 25\n84 86\n11 29\n17 2 99 65 7\n92 74\n10 67\n96 15\n21 33",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "49 56 22 30 63\n52 85\n47 23\n95 16\n54 98\n89 98\n46 55\n25 81\n29 99\n86 45\n75 68\n80 12 64 69 88\n100 96\n60 98\n48 60\n18 32",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "50 16 52 92 18\n39 4\n30 19\n26 20\n71 63\n32 41\n33 8\n20 18\n57 75\n62 61\n49 54\n77 35 97 62 71\n17 95\n53 97\n22 15\n83 83",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "61 95 9 21 15\n77 64\n2 96\n5 62\n98 78\n98 49\n70 2\n1 86\n34 97\n43 16\n39 45\n40 15 79 20 51\n26 4\n94 20\n27 40\n38 50",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "93 64 87 85 25\n38 98\n74 10\n55 33\n43 16\n47 5\n1 42\n51 86\n78 95\n57 61\n56 74\n17 19 97 19 79\n1 45\n39 39\n47 44\n26 78",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "190 268 187 72 128\n390 303\n188 267\n70 179\n64 225\n371 283\n111 425\n355 215\n449 337\n136 92\n297 147\n148 439 325 136 111\n242 135\n195 237\n387 318\n447 323",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "398 133 248 362 453\n464 65\n269 232\n337 144\n454 297\n225 357\n171 131\n269 228\n254 187\n90 194\n418 64\n449 452 417 358 482\n156 326\n276 458\n281 265\n201 469",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "391 81 174 92 345\n372 52\n314 450\n288 225\n172 178\n296 493\n154 131\n199 332\n201 384\n410 335\n468 263\n118 439 266 355 207\n378 353\n218 399\n464 359\n83 380",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "205 81 75 314 245\n196 331\n230 245\n222 445\n303 133\n150 230\n150 404\n335 168\n156 338\n317 320\n96 409\n137 259 53 337 193\n359 331\n432 122\n485 428\n129 433",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "138 117 315 118 365\n347 80\n472 74\n389 468\n122 478\n451 97\n240 189\n413 354\n269 470\n82 290\n330 77\n293 298 115 481 105\n257 450\n122 100\n383 447\n128 112",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "470 415 189 181 58\n431 444\n487 234\n115 279\n437 240\n351 61\n104 330\n293 203\n148 468\n183 295\n449 192\n436 272 353 137 341\n146 169\n54 65\n273 259\n348 232",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "453 484 65 252 213\n396 190\n178 221\n440 203\n328 450\n437 384\n424 94\n293 192\n308 182\n86 338\n309 407\n203 494 121 457 170\n106 257\n416 96\n289 131\n199 215",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1 1000 2 1 999\n1000 2\n999 999\n1 2\n1000 999\n2 1\n1000 1\n2 1000\n1000 999\n1 2\n1 1\n1 2 1000 1 1000\n2 1\n999 999\n1 1\n2 1000",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "2 1000 2 1 999\n1000 1\n999 2\n2 2\n1 1000\n1 999\n1 2\n1000 1\n1000 999\n999 2\n2 999\n2 1000 2 999 1\n2 1\n2 999\n1 2\n2 1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:53",
  "total_test_cases": 20
}