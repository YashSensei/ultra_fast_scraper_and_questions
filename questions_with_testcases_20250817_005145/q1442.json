{
  "problem_code": "problems",
  "title": "Counting The Way of Bracket Replacement",
  "tags": [],
  "text": "EnglishVietnameseA regular bracket sequence is a string of characters consisting only of\nopening and closing brackets, and satisfying the following conditions:An empty string is a regular bracket sequence.If A is a regular bracket0sequence, then (A), [A] and {A} are also\nregular bracket sequences.If A and B are regular bracket sequences, then AB is also a regular\nbracket sequence.For example, the sequences [({})], [](){} and [{}]()[{}]\nare regular, but the sequences [({{([, []({)} and\n[{}])([{}] are not.Ivica has found a string which looks like it could be a regular bracket\nsequence. Some of the characters have become smudged and illegible, and\ncould have been any character.Write a program that calculates how many ways the illegible characters\nin the string can be replaced by brackets so that the result is a\nregular bracket sequence. This number can be very large, so output only\nits last 5 digits.InputThe first line contains an even integer N (2 ≤ N ≤ 200), the length of\nthe string.The second line contains the string. Illegible characters are represented\nby the '?' character.OutputOutput the number of regular bracket sequences the string could have read.SampleInput:6\n()()()Output:1Input:10\n(?([?)]?}?Output:3Input:16\n???[???????]????Output:92202In the second example, the three matching regular bracket sequences\nare ({([()])}), ()([()]{}) and ([([])]{}).",
  "sample_input": "Input:6\n()()()Output:1",
  "sample_output": "Input:10\n(?([?)]?}?Output:3",
  "link": "https://www.spoj.com/problems/MREPLBRC",
  "scraped_at": "2025-08-17 00:33:44",
  "test_cases": [
    {
      "input": "6\n()()()",
      "expected_output": "1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "10\n(?([?)]?}?",
      "expected_output": "3",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "4\n3\n9\n1\n2",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n1\n5\n1\n5\n10",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n5\n1\n3\n1",
      "expected_output": "To be computed",
      "type": "small_case_5",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "18\n55028530\n59021390\n26305141\n60361399\n43379109\n90829679\n78723160\n89392537\n21710978\n51558126\n77473134\n59168329\n27544892\n39711800\n50773722\n35223706\n70320761\n38816309",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "15\n66504318\n34064054\n86269749\n73673248\n12183213\n24995046\n56765964\n2832049\n89528345\n69690261\n517728\n69486296\n36945468\n23506286\n92285623",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "13\n98932950\n30957951\n72259070\n68861189\n42826144\n37305338\n78928755\n54009755\n28074760\n50009582\n78045058\n1362736\n67202442",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n37041179\n57627654\n29308262\n16746324\n75240609\n7110392\n7455851\n85371447",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n13450355\n77132554\n24608720\n83210112\n34640601\n31718529\n46399024\n38942488",
      "expected_output": "To be computed",
      "type": "medium_case_10",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "197\n83641\n99567\n36369\n90257\n20784\n32609\n56284\n3831\n12157\n25081\n96730\n32131\n16769\n80499\n33999\n73921\n71308\n8195\n38061\n98189\n96666\n22032\n73824\n72898\n62728\n78617\n11490\n45004\n81583\n10179\n43987\n2808\n85856\n54653\n80805\n13966\n20728\n43678\n90367\n86842\n91347\n6117\n34246\n82682\n8766\n61128\n38740\n85749\n59391\n52739\n54850\n74613\n72447\n91670\n39727\n38891\n41817\n15099\n88225\n16473\n89756\n97453\n85919\n17269\n73997\n61712\n1894\n87504\n49223\n91699\n40810\n6886\n82806\n15681\n3148\n96917\n49705\n30006\n15582\n70624\n10238\n66871\n52157\n86785\n88618\n13243\n76837\n26504\n22115\n58065\n24256\n27911\n12468\n16588\n89271\n9510\n37420\n52400\n82932\n73090\n19673\n31851\n20009\n17301\n47972\n72547\n70461\n94624\n34339\n25376\n22028\n17038\n16139\n37005\n68160\n35454\n70567\n67521\n37334\n5653\n72489\n40420\n82577\n90154\n76738\n41937\n54386\n85601\n17441\n91317\n38781\n7423\n4191\n6430\n86375\n29366\n81834\n15016\n83440\n53359\n38262\n66091\n7633\n58387\n54928\n29269\n29781\n18528\n1692\n17612\n11457\n93276\n14123\n88915\n21943\n32534\n27014\n15317\n412\n70203\n12093\n58739\n68287\n84991\n53910\n24006\n15205\n50030\n295\n12290\n44925\n60084\n40115\n26963\n83184\n99211\n64408\n74538\n92470\n75421\n78386\n65203\n5398\n93480\n57877\n38580\n36993\n58318\n51921\n85125\n18806\n1918\n78422\n61791\n99196\n81885\n62528",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "33\n83873\n39687\n68258\n5121\n97220\n37990\n95818\n19738\n87008\n48453\n79590\n9214\n53380\n10411\n83829\n515\n19064\n43682\n26709\n44118\n69831\n50332\n91564\n39326\n15861\n43042\n73292\n41744\n65363\n84925\n22548\n86505\n56916",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "50\n36427\n70732\n28433\n9082\n18080\n20899\n94468\n89121\n73131\n44360\n37452\n35854\n51845\n11051\n27214\n57381\n67828\n88758\n94022\n80629\n29368\n62630\n51764\n54556\n52926\n63537\n90652\n35428\n81246\n37478\n28983\n13185\n27366\n42681\n33129\n69720\n32334\n48179\n17057\n79666\n8718\n23109\n12169\n91186\n25541\n98471\n35009\n59273\n24253\n52892",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "145\n4213\n55547\n9565\n51272\n37152\n24565\n81238\n22072\n67621\n63885\n14930\n11716\n59638\n67662\n96226\n99894\n56869\n58725\n31159\n19111\n22268\n42015\n4278\n9819\n68185\n74620\n82881\n43993\n64467\n36068\n59858\n68362\n63549\n70983\n22971\n26611\n21198\n24956\n57974\n53475\n6818\n41481\n19099\n7895\n41323\n42384\n52235\n93512\n33568\n43534\n10447\n96726\n2258\n82667\n51884\n76514\n89626\n9263\n8927\n66861\n64697\n15801\n95573\n8448\n52096\n11408\n52553\n99595\n7477\n94711\n18324\n24574\n76835\n21958\n33170\n55042\n78734\n41894\n25860\n10596\n70324\n78951\n37117\n3060\n97615\n16575\n11444\n85357\n53407\n18490\n418\n80618\n69391\n694\n39797\n45361\n44004\n16855\n59070\n94570\n35835\n62180\n31411\n41967\n56337\n10837\n81320\n9135\n36782\n32425\n87950\n5187\n54596\n34629\n1400\n20972\n30766\n1168\n42365\n81264\n42542\n38530\n31249\n12432\n79900\n38083\n97401\n444\n84388\n70192\n60592\n32654\n95830\n6863\n48\n32449\n48213\n2671\n26211\n67675\n47644\n63045\n84238\n20347\n45452",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "158\n62627\n61745\n68909\n79412\n29795\n77732\n91768\n4213\n46324\n11366\n47415\n23485\n5223\n35623\n44041\n15906\n43655\n42643\n37972\n22328\n52978\n98694\n2840\n59567\n15839\n59275\n74647\n83858\n26086\n64698\n53375\n96374\n41223\n14131\n48937\n24657\n13698\n15473\n14776\n83200\n36242\n13131\n61322\n36246\n19335\n80510\n28242\n72100\n60161\n21652\n85913\n63669\n498\n49660\n77482\n46639\n83859\n22346\n51206\n88912\n83183\n17642\n22850\n19682\n86467\n21396\n21150\n37176\n43421\n22369\n21968\n3485\n84436\n84037\n69804\n49157\n5278\n14633\n89027\n8869\n34398\n64675\n58160\n60452\n73242\n86855\n22475\n73225\n48414\n9391\n29650\n87697\n89340\n11086\n758\n15603\n49585\n58379\n30061\n20448\n22256\n48568\n79850\n28213\n17852\n77087\n22088\n27717\n89695\n79740\n42296\n66057\n36942\n14876\n47375\n74538\n77567\n78669\n77448\n34906\n27028\n90752\n47551\n88183\n94039\n62015\n61102\n44631\n84606\n66211\n66345\n20824\n85778\n87549\n26617\n2703\n1328\n24534\n23199\n81432\n27914\n21235\n57791\n941\n41318\n34343\n52724\n57915\n47587\n77849\n81273\n76912\n73556\n70474\n66901\n29736\n20305\n12225",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "27\n44714\n91766\n37802\n83736\n27279\n60385\n35443\n27442\n10606\n20351\n46183\n55445\n52924\n42427\n35337\n70021\n33109\n31824\n34546\n50344\n36899\n41208\n21893\n31295\n30750\n81913\n25380",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "90\n83665\n28503\n86496\n93688\n29609\n5736\n86735\n99551\n48483\n5463\n91893\n34970\n42708\n81816\n71376\n46904\n96683\n37881\n9934\n74318\n72387\n80149\n35785\n65919\n97850\n90492\n52821\n95984\n48356\n32277\n15062\n81159\n4033\n6602\n80992\n75861\n30159\n94984\n65484\n21632\n65592\n85550\n64365\n29935\n74482\n93893\n3769\n75699\n10892\n95025\n81265\n54637\n81644\n43552\n83997\n41262\n57094\n51525\n29341\n48449\n44281\n58988\n51803\n52654\n80771\n32240\n66985\n22858\n13477\n13501\n36297\n96239\n61426\n94220\n44540\n17874\n97125\n50585\n79062\n68061\n4890\n85701\n47108\n45196\n789\n77928\n58349\n192\n48504\n35862",
      "expected_output": "To be computed",
      "type": "large_case_17",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n8828778\n24818100\n36737787\n14895634\n42780978\n68663815\n6298681\n17990837\n15016447\n85375123\n64242310\n38006215\n16790412\n9128245\n10758133\n51976599\n17145087\n1231200\n38075871\n13511500\n4916413\n5190560\n43988526\n24915856\n25685835\n46258673\n85864757\n30734881\n72204498\n27221193\n42739214\n28072049\n45825404\n41085828\n77333932\n6816531\n81758478\n73944233\n74241409\n25643181\n89659419\n34134158\n37751824\n88082293\n10342610\n7085571\n59276898\n8090916\n76182788\n46347340\n47125123\n50289484\n20955129\n59191759\n10887342\n6818082\n10567710\n43243024\n36505993\n39526633\n51120894\n88566418\n34361878\n27668476\n71316919\n7253573\n87115960\n24337743\n17328252\n31383865\n47013198\n98044013\n56352921\n7155128\n42223304\n54833778\n14623166\n74264359\n11052688\n93081307\n96045976\n54731966\n23640102\n13186723\n14522606\n85203995\n85683169\n14399331\n81497658\n72581035\n19756302\n27061218\n93345761\n99985366\n3637545\n47541615\n57544600\n58416033\n25015301\n26681502\n88956901\n26752732\n15931153\n83912627\n80112502\n85622398\n15481874\n78888519\n71421828\n77869940\n47562868\n32106659\n71320609\n49054581\n93333168\n52469605\n12141192\n11870346\n60510116\n8153547\n24173471\n21580538\n34317964\n69223849\n59965286\n9408998\n17445906\n29194369\n83759959\n30559293\n65639173\n93912649\n8081675\n50937765\n93228647\n21522867\n61211273\n54924898\n64986130\n24584445\n59280980\n20065403\n46536328\n82637231\n91982138\n41695758\n98369714\n56357831\n4220477\n84810029\n42930313\n21890312\n16844197\n97155645\n75231914\n63175137\n91911811\n73203832\n12239390\n43955906\n22288429\n72487809\n76226917\n1202255\n46711924\n58928201\n83597578\n16171082\n26042961\n25227351\n37127956\n87783101\n96279030\n97306075\n10873779\n62996533\n13243493\n79655774\n63627826\n84841397\n4336954\n91988873\n86359420\n96449565\n70697270\n797580\n44234887\n42996192\n67954016\n63413635\n25730298\n54419431\n67089048\n18690864\n12616782\n6482072\n78691533\n3522171\n1422281\n28606498",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n1423086\n61465881\n74686900\n18483051\n61609673\n16184301\n47148567\n49972051\n1783232\n73975876\n64466796\n98895229\n12731982\n99575047\n95779753\n59508691\n10690677\n33666780\n11022846\n57752190\n64216279\n79682637\n99472505\n24154109\n57406467\n54594413\n61165458\n56683734\n69411095\n79016473\n5243773\n62459828\n76258734\n57960668\n21437433\n15742597\n54574248\n66678268\n60108964\n84002021\n76533464\n12656137\n37178240\n2132210\n34245446\n61205894\n25262177\n21691769\n32826262\n28693207\n51707627\n19296299\n22971869\n97444972\n14915600\n11227893\n81268181\n50911404\n66358087\n97420855\n27796913\n50582337\n33930343\n48505970\n97718750\n46240181\n82435954\n37129447\n67385196\n96681580\n79391863\n31019027\n33518425\n69075698\n7155707\n60920317\n55946560\n95843996\n86058432\n27747773\n42598210\n32392935\n95175342\n9620922\n51409253\n44215332\n83834322\n25709524\n5309660\n58466865\n12315856\n82731640\n21831505\n79137018\n96373035\n46824882\n92467283\n8471983\n20519879\n91887943\n85475545\n3045054\n40827168\n80997966\n79220968\n70143846\n90281277\n20241503\n78661784\n89529196\n51031310\n36729747\n34097685\n71520561\n47794435\n32045000\n39618773\n22022925\n94816484\n62495846\n12585422\n23662501\n79161277\n47343980\n56913926\n69405885\n71662640\n34150741\n79160462\n52662443\n83437517\n55953457\n45625675\n21198618\n26931306\n9704388\n55136825\n71931185\n27028162\n73687653\n58613533\n16608393\n22493804\n49506691\n86689327\n28374323\n24977576\n69242620\n35946411\n63076129\n97413332\n91291420\n21692939\n43479726\n75880525\n25746301\n5161655\n27750496\n13894280\n83131325\n86141801\n25196194\n15131549\n19781706\n99370793\n67369297\n38405787\n89609036\n81244540\n35959724\n78688752\n8911278\n39769275\n93690656\n61159447\n37753683\n77742691\n11635432\n83324723\n72300334\n38242667\n87702158\n50337278\n68113898\n36346487\n56561542\n89806606\n90228963\n62778600\n60231625\n87052509\n19824901\n37889689\n56160014\n96723324\n74587673\n54854845\n75119558\n94742746\n51013782",
      "expected_output": "To be computed",
      "type": "max_case_19",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n1\n1\n1\n100000000\n100000000\n1\n100000000\n100000000\n1\n100000000\n60543310\n1\n100000000\n1\n100000000\n25439488\n100000000\n42057097\n19697906\n100000000\n10926243\n100000000\n90160190\n100000000\n1\n48906167\n5260833\n32300230\n17630683\n320542\n100000000\n56798652\n100000000\n1\n36425964\n100000000\n46695865\n1\n1\n1\n1\n100000000\n52023876\n32214846\n40392449\n100000000\n85145955\n100000000\n1\n1\n28219099\n1\n1\n1\n1\n100000000\n1\n1\n100000000\n1\n34583227\n100000000\n1\n71752711\n1\n62921254\n31277800\n1\n1\n50400022\n1\n100000000\n100000000\n59897317\n55952774\n100000000\n1\n100000000\n37878949\n1\n1\n9453292\n100000000\n100000000\n36263017\n30523249\n1\n100000000\n100000000\n100000000\n19561919\n1\n83966738\n51845583\n100000000\n1\n1\n100000000\n57744506\n100000000\n1\n100000000\n80949682\n94139485\n100000000\n1\n100000000\n100000000\n1\n1\n100000000\n64062846\n15454992\n100000000\n100000000\n100000000\n1\n1\n100000000\n1\n100000000\n1\n7235364\n1\n7203346\n44832896\n1\n100000000\n20762537\n25973406\n100000000\n100000000\n100000000\n2158216\n100000000\n1\n100000000\n100000000\n100000000\n1\n94874409\n100000000\n1\n100000000\n87536646\n88901388\n9417182\n1\n81396935\n25558730\n1\n1\n1\n1\n6452187\n100000000\n1\n39001075\n100000000\n1\n1\n100000000\n100000000\n1\n100000000\n1\n100000000\n54901293\n100000000\n37751439\n62051344\n100000000\n1\n86721461\n1\n1\n100000000\n1\n37392907\n1\n1\n2882893\n1\n14796433\n1\n47225846\n1\n100000000\n1\n1\n50207638\n39022755\n100000000\n100000000\n37471695\n100000000\n100000000\n100000000\n1\n1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 200)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:50",
  "total_test_cases": 20
}