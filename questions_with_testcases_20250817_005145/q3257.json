{
  "problem_code": "problems",
  "title": "Denethors Decryption of Dequeue permutations",
  "tags": [],
  "text": "'Though the Stewards deemed that it was a secret kept only by themselves, long ago I guessed that here in the White Tower, one at least of the Seven Seeing Stones was preserved. In the days of his wisdom Denethor did not presume to use it, nor to challenge Sauron, knowing the limits of his own strength. But his wisdom failed; and I fear that as the peril of his realm grew he looked in the Stone and was deceived: far too often, I guess, since Boromir departed. He was too great to be subdued to the will of the Dark Power, he saw nonetheless only those things which that Power permitted him to see.' - Gandalf.Sauron and Saruman have been communicating from large distances using the Seeing Stones. Denethor, with great difficulty has been able to break into their channel of communication using his strength of will. Despite this however, it seems that their communication has been encrypted. Gondor's spies in Isengard have found out the encryption algorithm they use and have reported back to Denethor.The algorithm is as follows:We refer to a dequeue as a double-ended queue. We define a \"dequeue permutation of N\" as a permutation of 1 to N that can be got by starting from a dequeue having elements 1, 2, 3 ... N (in that order with 1 at the front and N at the back) and performing any sequence of N pop_front() or pop_back() operations.Note that not all permutations of 1 to N are dequeue permutations. For example, with N = 3, you have 3-1-2, 1-3-2 etc. as dequeue permutations whereas 2-1-3, 2-3-1 aren't (you can't have 2 right at the beginning since its not at any end of the dequeue).If Sauron wants to encrypt the number K and send it to Saruman, he would instead send the K'th lexicographically smallest (0-based indexed) dequeue permutation of N. That is, if Sauron wanted to send '0' to Saruman, he would just send 1-2-3-...-N (since this is clearly the smallest lexicographic dequeue permutation of N).Sauron is transmitting the size of his army to Saruman, so that they can coordinate an attack on the Men of Rohan and Gondor. Since Sauron's will is so powerful, Denethor is able to get only vague glimpses of the numbers, and he is able to remember only the first half (floor(N/2) elements) of the permutation. Further, since these images are so vague, his understanding of the numbers happens out of order. For example, Denethor may understand that the 5th number of the permutation is 4, and later on only understand that the 3rd number was 3.Help him estimate the minimum and maximum possible size of Sauron's army (value of K), given the number N, and incremental understanding of the first half of the permutation, not necessarily in order.NOTE 1: Since the values to be output can be rather large, output the values modulo 1,000,000,007.NOTE 2: It may be the case that Denethor's understanding of the permutation is flawed. If it is not possible to have a dequeue permutation satisfying all the conditions seen so far, output -1.NOTE 3: A permutation p1 is lexicographically smaller than p2 if at the first position where they differ, p1's value is smaller than p2's.InputThe first line consists of the integer T, the number of test cases.Each test case begins with a single integer N.This is followed by exactly floor(N/2) lines containing 2 integers each: i and j, denoting that Denethor has understood that the i'th element (1-based) of the supposed permutation is j.OutputFor each testcase, output exactly floor(N/2) lines, one for each (i,j) pair. If the recollections till now cannot all be feasible, output '-1' on a line. Else output two space-separated integers: the minimum and the maximum possible value of Sauron's army, K, that are consistent with all the observations seen so far.Between successive test cases, there should not be any blank lines in the output.Constraints1 ≤ T < 32 ≤ N ≤ 100,0001 ≤ i ≤ floor(N/2)1 ≤ j ≤ NAll (i, j) pairs are distinct. And for two pairs (i1, j1) and (i2, j2), you have that i1 ≠ i2 and j1 ≠ j2.ExampleInput:2\r\n3\r\n1 3\r\n32\r\n1 1\r\n3 2\r\n2 32\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n10 10\r\n11 11\r\n12 12\r\n13 13\r\n14 14\r\n15 15\r\n16 3Output:2 3\r\n0 73741816\r\n536870912 805306367\r\n536870912 805306367\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1Notes/Explanation of Sample InputFor the first test case, for N = 3, there are 4 dequeue permutations, lexicographically ordered as 1-2-3, 1-3-2, 3-1-2, and 3-2-1. Denethor sees the first number of the dequeue permutation as 3, and concludes that the permutation can be either 3-1-2, or 3-2-1.In the second test case, we see that:(a) the 1st number is 1.(b) the 3rd number is 2 ... this means that the 2nd number has to be 32.(c) the 2nd number is 32 ... this does not add any new information.(d) the 4th number is 4. But this is not possible, since the 4th number can now either be 3 or 31.Hence it is inconsistent (and none of the further observations can make it consistent).Also notice that in the 2nd test-case, the values have been output modulo 1,000,000,007.",
  "sample_input": "Input:2\r\n3\r\n1 3\r\n32\r\n1 1\r\n3 2\r\n2 32\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n10 10\r\n11 11\r\n12 12\r\n13 13\r\n14 14\r\n15 15\r\n16 3Output:2 3\r\n0 73741816\r\n536870912 805306367\r\n536870912 805306367\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/AMR12F",
  "scraped_at": "2025-08-17 00:34:21",
  "test_cases": [
    {
      "input": "2\r\n3\r\n1 3\r\n32\r\n1 1\r\n3 2\r\n2 32\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n10 10\r\n11 11\r\n12 12\r\n13 13\r\n14 14\r\n15 15\r\n16 3",
      "expected_output": "2 3\r\n0 73741816\r\n536870912 805306367\r\n536870912 805306367\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1\r\n-1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3\n7\n5\n9",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n7\n3\n2\n4",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "3\n1\n7\n1",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "18\n62817533\n76540365\n55345964\n56435216\n6372703\n83574792\n67585478\n37809403\n29055142\n40102513\n81509892\n12023043\n58663340\n41537304\n26800370\n66385083\n43300336\n17633881",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n16538033\n83265959\n47235146\n99356542\n93801979\n12751799",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "20\n6838515\n50214552\n3561984\n19492934\n7581530\n80173910\n80932587\n52647978\n13392389\n48064009\n63878968\n69121819\n60508596\n95054224\n1793904\n20585736\n66467827\n20951815\n40898520\n55939950",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "7\n12888315\n43955253\n14241688\n7514246\n58901150\n28125074\n38153715",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n47764348\n9719525\n34400546\n83812392\n8554080\n84684142\n99963206\n29945303\n78395529\n54434070\n22444938\n67489047\n95814966\n19694145\n71933990\n55745764",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "51\n48194\n13871\n6422\n740\n37416\n96855\n43666\n43138\n28657\n24584\n88494\n75477\n74435\n62675\n53688\n16430\n42484\n93201\n39830\n18775\n88598\n98004\n82774\n37686\n43917\n44636\n32312\n43441\n21043\n36907\n80140\n96227\n93004\n97642\n86825\n4496\n11678\n50135\n21994\n91312\n52610\n24552\n56226\n91343\n65652\n33971\n40955\n85779\n53746\n3007\n7042",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "90\n13206\n26196\n91670\n71598\n77736\n2410\n98466\n56790\n96674\n70228\n73111\n99623\n93201\n16246\n88336\n15625\n92180\n62616\n52767\n64716\n70672\n54166\n97273\n39134\n41571\n47929\n19210\n89675\n15554\n90937\n34816\n59937\n15688\n20790\n39947\n15706\n6861\n27187\n41059\n89759\n99615\n36675\n7520\n57781\n45513\n30787\n60951\n43805\n79063\n16652\n14460\n28720\n63960\n5023\n20538\n49120\n30353\n54455\n99076\n36469\n75718\n73609\n33310\n42210\n59151\n74149\n83414\n96523\n16941\n10064\n8933\n6001\n40395\n69171\n88132\n33277\n18642\n98508\n18360\n22130\n82734\n77896\n31439\n88358\n96021\n46887\n48832\n5963\n26219\n14328",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "80\n57383\n71455\n37673\n11894\n55643\n3047\n11824\n52295\n61780\n21638\n65285\n35124\n59917\n47249\n29290\n95307\n3055\n26537\n82828\n72795\n44003\n48211\n41455\n22476\n17312\n78420\n99757\n91491\n74356\n60455\n7584\n96005\n54019\n93945\n26500\n25447\n6142\n95867\n56910\n71082\n35968\n2122\n97481\n53086\n45093\n38613\n11302\n37035\n73458\n60696\n84773\n88411\n28270\n91953\n45847\n48702\n98682\n85852\n5460\n25067\n31351\n14055\n35641\n63391\n43288\n47818\n82352\n52303\n2225\n38584\n7194\n84901\n70894\n72936\n25423\n26518\n21178\n35771\n81689\n12525",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "89\n59451\n6343\n50544\n34968\n65637\n74174\n15187\n35428\n77544\n75641\n33949\n60770\n7072\n81716\n54878\n61379\n2220\n57307\n24063\n87292\n15453\n10749\n58288\n45511\n77348\n83018\n54298\n47338\n47896\n39841\n93486\n71028\n99706\n12562\n25819\n35828\n11889\n33481\n13624\n85878\n4016\n57476\n45767\n16537\n15655\n21814\n18234\n75302\n1975\n60009\n63353\n85657\n24735\n77807\n19648\n9204\n23513\n2156\n83712\n20882\n75332\n98234\n39034\n22271\n27487\n6672\n14123\n80428\n10264\n50454\n7226\n21907\n96559\n27719\n7647\n72075\n96113\n36832\n81779\n57882\n73363\n35770\n30733\n27460\n94124\n12391\n83684\n9290\n44769",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "43\n22628\n96538\n78445\n28055\n64204\n79669\n26826\n1736\n61520\n75625\n66232\n39238\n70625\n98535\n77873\n15055\n56266\n61057\n1960\n44261\n91099\n94502\n7790\n73270\n72017\n50390\n29204\n88047\n32493\n30016\n90739\n40007\n35884\n33036\n11679\n31\n2996\n13515\n58382\n50095\n6789\n73862\n2742",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "56\n17023\n54526\n10086\n74435\n46204\n94538\n64818\n14363\n3422\n30352\n97507\n67123\n80866\n73132\n77146\n89114\n95080\n85867\n51469\n56269\n50171\n6781\n78343\n39755\n16158\n70511\n82289\n84865\n50146\n5483\n28450\n50528\n58067\n24333\n52139\n72583\n14892\n13895\n76532\n80426\n17189\n8033\n86902\n10262\n27471\n72229\n41122\n58368\n50304\n6129\n23289\n45994\n32674\n8723\n37933\n73805",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "23\n54558\n7610\n73071\n91450\n24904\n46682\n98853\n59888\n76029\n7404\n16525\n78201\n78770\n28032\n98471\n41638\n63814\n51865\n25022\n70015\n42142\n42270\n87066",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "100\n59205709\n5639925\n71974748\n67009469\n35675283\n70534810\n94494015\n54628702\n59310832\n37846831\n527369\n3072633\n49179137\n64742559\n23162817\n83383207\n61266267\n45472939\n35389419\n84156637\n13003715\n91357304\n70326609\n6134035\n95309004\n11803409\n5225738\n6709049\n1353182\n93798246\n84943851\n3459367\n46628491\n12866616\n70779949\n44568085\n63421946\n89796559\n7791291\n55672554\n75054184\n9268253\n48723330\n1033354\n82581449\n71742315\n36610832\n51621692\n55857078\n96012713\n32467526\n86953613\n35543602\n10732534\n4359191\n45319867\n92968029\n46728211\n54156077\n60361088\n50010791\n64335517\n70396973\n3037067\n43530317\n80182241\n81089888\n60998654\n52341961\n42148005\n72105218\n86486896\n52040782\n53013400\n69795752\n1155936\n5530607\n14084572\n96880956\n36952977\n78646849\n15538013\n6429592\n54903009\n49115058\n5782243\n43118768\n13012711\n3833296\n47260603\n72851120\n13023506\n96537861\n70869436\n58775544\n13407586\n84220136\n23642976\n55211186\n89502158",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 100)"
    },
    {
      "input": "100\n16334546\n84060467\n56585547\n17099766\n37408279\n86868147\n16149893\n91442673\n20108088\n28895588\n58978065\n42757618\n58581398\n73388714\n4263074\n59716206\n59462357\n15397450\n41707191\n25316436\n12330769\n26213352\n69172853\n60170231\n47863499\n96332665\n2245707\n30161284\n78597853\n88494107\n52248745\n16629609\n71499334\n23457021\n13174827\n85992550\n21061730\n55327781\n53854237\n86588752\n47598769\n38228145\n72827422\n3223570\n19370619\n37903900\n11790717\n75256557\n53904578\n41634450\n2135993\n15405872\n37636204\n58218501\n89800381\n15746202\n14423471\n81259030\n30607389\n6596877\n29456636\n76795612\n2548849\n23698020\n52221371\n70471483\n31754386\n7228224\n14592695\n96095912\n25876913\n90054242\n64881586\n48912093\n44255542\n37593419\n64960361\n42840045\n51806006\n48176865\n66074545\n93604750\n67279538\n46457801\n14346369\n480521\n91470799\n37919507\n55532306\n25863691\n23772807\n17414439\n9503991\n11129053\n30013728\n97896011\n4131989\n67296601\n81606681\n18778169",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 100)"
    },
    {
      "input": "100\n100000000\n58147978\n1\n1\n41328453\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n40902669\n8160090\n18128818\n39579835\n1\n1\n1\n58947006\n64618105\n1\n1\n100000000\n1\n100000000\n1\n1\n100000000\n1\n1\n1\n60634988\n1\n100000000\n58172512\n1\n100000000\n1\n57101799\n86442783\n1\n16503444\n1\n1\n29529501\n100000000\n100000000\n60882404\n100000000\n100000000\n1\n10981375\n1\n4568657\n100000000\n100000000\n100000000\n54970607\n90406465\n1\n91757941\n1\n100000000\n1\n100000000\n44194793\n100000000\n1\n72908704\n1\n21176721\n100000000\n89246123\n1\n93410757\n55035850\n47154377\n100000000\n100000000\n1\n1\n16996511\n100000000\n69886771\n1\n1\n100000000\n25838943\n12679775\n100000000\n96577177\n100000000\n1\n100000000\n100000000\n100000000\n1\n100000000\n100000000\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 100)"
    },
    {
      "input": "100\n100000000\n1\n1\n100000000\n100000000\n27622296\n1\n100000000\n46180942\n1\n19752844\n48989276\n1\n89744136\n38641271\n100000000\n1\n1\n86487928\n100000000\n1\n100000000\n1\n49926410\n1\n100000000\n43539218\n75523553\n100000000\n87564346\n100000000\n100000000\n47192442\n73945774\n86152367\n1\n100000000\n74479811\n1\n72977405\n100000000\n32979626\n100000000\n100000000\n1\n1\n1\n1\n1\n1\n100000000\n80220363\n100000000\n100000000\n100000000\n1\n98357770\n97653801\n100000000\n87481869\n1627751\n100000000\n1\n1\n50229983\n75778248\n1\n100000000\n100000000\n100000000\n45036426\n73912191\n74735631\n87249435\n76199886\n1\n100000000\n100000000\n100000000\n100000000\n1\n1\n100000000\n100000000\n1\n100000000\n1\n100000000\n100000000\n1\n33010614\n51259234\n5493535\n1\n35592976\n7248348\n1\n100000000\n100000000\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 100)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:55",
  "total_test_cases": 20
}