{
  "problem_code": "problems",
  "title": "Men at work",
  "tags": [],
  "text": "Every morning you have to drive to your workplace. Unfortunately, roads are under constant repair. Fortunately, administration is aware that this may cause trouble and they enforce a strict rule on roadblocks: roads must be blocked only half of the time. However, contractors are free to schedule their working hours, still they must follow regulations:Working periods (when the road is blocked) and rest periods (when the road is open) must alternate and be of fixed length.The beginning of the day (time zero) must coincide with the beginning of a period.Write a program that, given a description of the road network and of contractors schedules outputs the minimal time needed to drive from home to work.InputThe first line of the input contains a number T ≤ 10 that indicates the number of test cases to follow.\r\nThe road network is represented on a N × N grid and the first line of each test case consists in the number N, 2 ≤ N ≤ 25.Then follows N lines of N characters that represent the road network at time zero. Those lines are made of \".\" (standing for open road) and \"*\" (standing for roadblock) and they encode the rows of the grid in increasing order, while columns are also presented in increasing order. Conventionally, your home is at the position first row, first column, while your workplace is at the position last row, last column. Furthermore, you leave home at time t=0, that is, your starting position is first row, first column at time zero.At a given time t, your car must be on some \"open road\" cell. It takes one time unit to drive to any of the four adjacent cells heading toward north, south, west or east, and you may also choose to stay on the same cell for one time unit. Of course, those five moves are valid if and only if the target cell exists and is free at time t+1.Finally comes N lines of N characters that represent the contractors schedules. Those lines match the ones of the grid description and are made of N characters 0, 1...9 that specify the duration of the working (and rest) period for a given cell. Observe that 0 is a bit special, since it means that the corresponding cell status does not change.OutputThe output consist in a single line for each test case, holding either the requested time, or NO, if driving from home to work is not possible.ExampleInput:2\r\n10\r\n.*********\r\n........**\r\n*.******.*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n********..\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n3\r\n...\r\n**.\r\n**.\r\n021\r\n002\r\n000Output:34\r\nNO",
  "sample_input": "2\r\n10\r\n.*********\r\n........**\r\n*.******.*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n********..\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n3\r\n...\r\n**.\r\n**.\r\n021\r\n002\r\n000",
  "sample_output": "34\r\nNO",
  "link": "https://www.spoj.com/problems/MAWORK",
  "scraped_at": "2025-08-17 00:33:09",
  "test_cases": [
    {
      "input": "2\r\n10\r\n.*********\r\n........**\r\n*.******.*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n*.******.*\r\n*.******.*\r\n*........*\r\n********..\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n0000000000\r\n0123456780\r\n0000000000\r\n3\r\n...\r\n**.\r\n**.\r\n021\r\n002\r\n000",
      "expected_output": "34\r\nNO",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1\n7",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "2\n7\n7",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n3\n7\n10\n3\n5",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "13\n58274026\n78249573\n55020171\n37191131\n93921647\n84887844\n13614151\n52668264\n56132412\n78929330\n95755257\n89480592\n65885557",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "18\n55052186\n34807696\n25826934\n37920389\n61194278\n92386537\n25663498\n14591609\n49928305\n10080732\n26040106\n7311942\n18693856\n88681006\n11278833\n21553626\n52128682\n96614431",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "20\n48661521\n15274136\n27114404\n17786664\n98668297\n54599918\n49633167\n13413288\n4190587\n60882298\n64710907\n76003452\n77104687\n36669522\n34627891\n30807632\n49050154\n29593729\n17482381\n34008924",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "5\n82734274\n63304191\n21146221\n54987390\n1822691",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n25613975\n73930585\n55310358\n44405347\n10535980\n53462559",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "25\n26474\n22753\n4967\n31391\n3019\n92244\n7556\n73577\n19969\n39917\n80381\n62221\n99006\n51519\n17552\n88380\n85464\n74433\n61758\n10922\n56468\n71186\n98691\n9698\n75295",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "20\n19110\n57505\n96715\n53647\n75110\n23365\n47732\n57698\n69162\n12997\n70408\n39780\n17418\n15651\n98537\n94080\n31750\n97876\n24318\n77417",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n5236\n4328\n37398\n78755\n55469\n84811\n86481\n8715\n65927\n36206\n90709\n60449\n23610\n17750\n9463\n22519\n24592\n39753\n91239\n39408\n3323\n76450\n18829\n2800\n87977",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "22\n85428\n87525\n38953\n5293\n51663\n72890\n54844\n27167\n53864\n87216\n46939\n93674\n60866\n94121\n74927\n25143\n5379\n83080\n81368\n51371\n71024\n81196",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "22\n59099\n37585\n764\n84965\n64796\n93913\n29824\n69727\n11523\n21395\n63722\n11562\n59496\n72715\n2770\n12316\n64283\n99451\n78605\n18677\n32181\n62588",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "24\n62720\n4127\n21431\n75409\n577\n95978\n6347\n73461\n6471\n27322\n57006\n25783\n11575\n32891\n31385\n39468\n70721\n25162\n23382\n10776\n18600\n84939\n97436\n85826",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "24\n55924\n51123\n30324\n71614\n33164\n7930\n35868\n1582\n62656\n14529\n39004\n3010\n54902\n1891\n71866\n58885\n30991\n39648\n68504\n98676\n36796\n89305\n31336\n60448",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n37702944\n66338413\n16315547\n45735155\n19106062\n76836430\n82098485\n71425195\n36764904\n49907421\n48159820\n12123408\n47407675\n75808587\n34273597\n68580115\n54512945\n82077961\n82937213\n38613690\n77784670\n69494193\n89484256\n76128742\n75540707",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 25)"
    },
    {
      "input": "25\n6831720\n5851770\n46556782\n61287773\n48799152\n41322172\n87263051\n83135110\n63547259\n48619518\n72664592\n8086173\n3313525\n40228735\n58212608\n29130280\n18525814\n53184059\n70558058\n12041339\n87293336\n43438295\n26055166\n1464739\n22814043",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 25)"
    },
    {
      "input": "2\n100000000\n1",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "25\n100000000\n100000000\n1\n100000000\n58154130\n97331414\n1\n33280292\n49928494\n100000000\n100000000\n100000000\n64761854\n1\n100000000\n100000000\n100000000\n83857871\n34561846\n1\n45095862\n100000000\n91556251\n80079633\n44650087",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 25)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:46",
  "total_test_cases": 20
}