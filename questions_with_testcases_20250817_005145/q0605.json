{
  "problem_code": "problems",
  "title": "Escape from Jail Again",
  "tags": [],
  "text": "A new International Common Prison for Criminals (ICPC) was built, and your old friend Harry was moved there as a prisoner. As before, the new ICPC is one of the most secure prisons in the world. It was designed by and old gamer and as such, the prison is not necessarily closed, but only an incredibly logical and fast mind can get out.The new ICPC can be represented as a grid of square cells. Each cell is empty, or it contains a wall, a door, an opening button or a closing button. Harry was accommodated in an empty cell, and all doors were closed. Nevertheless, Harry told you that he will try to escape. Each time Harry is in a cell, he can move in a single step to an adjacent cell (i.e., a cell that shares a side with his current location). Each time Harry steps on a cell that contains an opening button, all doors open, while each time he steps on a cell that contains a closing button, all doors close. Harry can walk around as he wants within the prison, although he cannot move to a cell that contains a wall, neither to a cell that contains a door if the doors are closed.To escape from the prison, Harry needs to step outside, which means placing himself in one of the cells on the sides and then taking one extra step out in the direction opposite to the prison.You obtained a map of the prison, and Harry deserves your advise. Tell him the minimum number of steps he needs to escape, or warn him that there is no way to get out.InputEach test case is described using several lines. The first line contains two integers N and M indicating respectively the number of rows and columns of the grid that represents the prison (1 ≤ N, M ≤ 100). Line i of the next N lines describes row i of the grid using a string of exactly M characters, where character j represents cell j of that row. This string only contains the following characters with the indicated meanings: “H” is the empty cell where Harry is at the beginning; “.” is an empty cell where Harry is not at the beginning; “W” is a wall; “D” is a door; “O” is an opening button; and “C” is closing button. You may assume that within each test case there is exactly one character “H”. The end of input is indicated with a line containing the number −1 twice.OutputFor each test case, output a single line with a single integer representing the minimum number of steps Harry needs to escape the prison, or the number −1 if it is impossible for him to do so.ExampleInput:5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1Output:21-1811",
  "sample_input": "Input:5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1Output:21-1811",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ESCJAILA",
  "scraped_at": "2025-08-17 00:33:11",
  "test_cases": [
    {
      "input": "5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1",
      "expected_output": "21-1811",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "2 2 2 7 3 9 3 5 1 7 4 7\n5 nangmzajlpkzgokchgtd os do cwxp eo lxq",
      "expected_output": "0\n0",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "6 10 5 3 9 3 7 1 4 10 5 10\n8 sxoneaxukubgjrpnhvctzhcezwxvou tt sslzr ybfsjc vvysbtbsxsxztiy pu",
      "expected_output": "0\n0",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "1 10 2 10 5 8 9 2 7 2 6 5\n6 lpyqukgkqdorywjodzphdknwmmxhelulzffblxw twiviqnnxk duycocv rhrvz fvuyesxgktma fuvsd",
      "expected_output": "0\n0",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "46 43 56 100 90 67 64 81 98 55 74 39\n54 gfkjbrrtwbfrvmymasrzaw ti aqtus lq vvwnmxckzxhqin uze",
      "expected_output": "0\n0",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "20 41 81 36 95 48 29 22 62 77 74 95\n21 arzeipbdqngt ibtphq pxuvn qcifb aymkybpgmq ebdg",
      "expected_output": "0\n0",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "50 41 77 48 5 11 69 41 66 93 90 50\n10 w wwd tjsna w dtbuasptgyvxkgsf wo",
      "expected_output": "0\n0",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "50 4 73 97 41 82 39 16 76 46 88 27\n24 kybyrork yrkllgubok iblprkegpj cc ubampcz tl",
      "expected_output": "0\n0",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "82 14 90 90 91 22 62 54 92 9 56 70\n29 yscnggqgyljgvjgmazs zmfor roscptcfrffjhqedohq hnjc vyszkplelgzpc v",
      "expected_output": "0\n0",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "76 187 447 178 223 140 177 349 113 292 399 329\n386 frryzjdagdztsezdkchzqekjpeagfa uyjkzpi svyxgljwyupvijreq vd yy d",
      "expected_output": "0\n0",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "174 355 472 422 170 67 463 325 394 83 281 420\n285 hcrrumbjmuqqkjjrxdxdjfjxlhrgwhuwwoiovvk apigw pbtlhyf ezgep eykjc zepzh",
      "expected_output": "0\n0",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "399 171 119 61 214 469 67 469 414 447 260 420\n338 rzjnpvjalthtem wb z hwpd auyvrpcxwt uk",
      "expected_output": "0\n0",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "494 472 307 300 353 145 431 195 477 469 453 260\n411 wsfcibaeseasbdqjsixssmrdlktor bjtwy bovbfy phzrwm pg vcevq",
      "expected_output": "0\n0",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "112 291 200 184 331 85 190 83 330 415 308 110\n131 ufxhgej dewex jbhuuj fmun j kxklt",
      "expected_output": "0\n0",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "239 350 205 359 78 486 350 141 180 245 306 232\n444 guzvscjpczeatiuw jjxfbjpw mpaqksto d yxpabcmy uvn",
      "expected_output": "0\n0",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "300 366 78 449 489 238 235 399 484 165 371 185\n152 uyknawsojlurzfdfkovmdcqneigdkztfmpsqgsqh d pedswwllofbehrgrspqoqtr w cezqyqcyhivxxa c",
      "expected_output": "0\n0",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000 aipuqsaio fwlqrwmg hpokehlmddnaqhddqbhlb di kxertnjimorf ke",
      "expected_output": "0\n0",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000 qkackxlejkx cxp dpa pecbzh wflqqc dikx",
      "expected_output": "0\n0",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1 1000 2 2 1000 2 1 1 999 1 1\n2 tcswhdhutvfoatublvgjcllrsi xzyk avghc skar cmwly ebzj",
      "expected_output": "0\n0",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "999 2 1 1000 1 999 2 1 1 1 2 2\n999 jdeylhiuvsqlxkeptaicngbomziissx ysfnhkxwgnq hcgzeferyatkxvwzfaeajfx f ccglcsbwwmugkemf ncnt",
      "expected_output": "0\n0",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:47",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:36:38"
}