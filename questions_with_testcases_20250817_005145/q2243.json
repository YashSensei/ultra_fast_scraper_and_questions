{
  "problem_code": "problems",
  "title": "ISRANK",
  "tags": [],
  "text": "There areNschools, with ithschool havingSistudents. There is a inter-school programming contestIPCin which all the schools participate. AsIPCis a very prestigious event, the schools conduct a test run within themselves. They assign a predicted rank for students within the school for all students, based on the rank they got in the test run. LetPijbe the predicted rank ofjthstudent ofithschool. The predicted rank will be unique within the school, i.e. formally:{ ∀i,Pij= Pik⇔ j = k }It should be noted that students of different schools may have the same predicted rank.At the end of IPC, the IPC committee has given each school the result card containing the marks of all students of that school. LetMijrepresent the actual marks obtained by thejthstudent ofithschool. IPC follows a strict rule of giving unique marks to all students taking part in IPC, i.e. formally:{ ∀i,∀j,Mij= Mpk⇔ i = p and j = k }You are to design a system, which will efficiently answer queries of the following form:L- the number of schools to be considered.A1 A2 A3 ... AL- the list of schools.P1 P2- The range of predicted ranks.K- desired rank.You are to answer - among all the students who attended the given list of schools and with predicted ranks betweenP1andP2both inclusive, the marks of the student withKthhighest marks. (The first highest marks would the the maximum marks, and second would be the next and so on)InputFirst line contains a single integerN, the number of schools.The next line containsNspace separated integersSi.The nextNlines, theithline containsSispace separated integers,jthof which is denotingPij.The nextNlines, theithline containsSispace separated integers,jthof which is denotingMij.The next line contains a single integerQ, denoting the number of queries.What follows areQsets of queries. Each query is structured as follows:First line of the query isL, the list of schools.Followed byLintegers denoting the1 basedindices of schools.Next areP1andP2, the range of ranks we are interested in.Next is the integerK.OutputFor each query on a separate line print a single integer answering the query. If answer is not possible print -1.Constraints1 ≤ N ≤ 101 ≤ Si≤ 100001 ≤ Pij≤ Si1 ≤ Mij≤ 10000000001 ≤ Q ≤ 100001 ≤ P1 ≤ P2 ≤ max(S[i])1 ≤ K ≤ sum of all S[i]ExampleInput:4\r\n1 3 4 1\r\n1\r\n1 2 3\r\n2 3 1 4\r\n1\r\n28\r\n20 11 8\r\n6 18 22 26\r\n7\r\n4\r\n1\r\n2\r\n3 3\r\n1\r\n1\r\n2\r\n3 3\r\n1\r\n3\r\n1 3 4\r\n4 4\r\n1\r\n4\r\n1 2 3 4\r\n4 4\r\n4Output:8\r\n8\r\n26\r\n-1",
  "sample_input": "Input:4\r\n1 3 4 1\r\n1\r\n1 2 3\r\n2 3 1 4\r\n1\r\n28\r\n20 11 8\r\n6 18 22 26\r\n7\r\n4\r\n1\r\n2\r\n3 3\r\n1\r\n1\r\n2\r\n3 3\r\n1\r\n3\r\n1 3 4\r\n4 4\r\n1\r\n4\r\n1 2 3 4\r\n4 4\r\n4Output:8\r\n8\r\n26\r\n-1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ISRANK",
  "scraped_at": "2025-08-17 00:33:54",
  "test_cases": [
    {
      "input": "4\r\n1 3 4 1\r\n1\r\n1 2 3\r\n2 3 1 4\r\n1\r\n28\r\n20 11 8\r\n6 18 22 26\r\n7\r\n4\r\n1\r\n2\r\n3 3\r\n1\r\n1\r\n2\r\n3 3\r\n1\r\n3\r\n1 3 4\r\n4 4\r\n1\r\n4\r\n1 2 3 4\r\n4 4\r\n4",
      "expected_output": "8\r\n8\r\n26\r\n-1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1\n10",
      "expected_output": "1\n10",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n7\n2\n4\n4\n3",
      "expected_output": "5\n7\n2\n4\n4\n3",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n8",
      "expected_output": "1\n8",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "13\n45652560\n54439456\n10259949\n36517671\n86540710\n63677604\n70645633\n64508407\n16995479\n9539922\n69476101\n11152808\n81062846",
      "expected_output": "13\n45652560\n54439456\n10259949\n36517671\n86540710\n63677604\n70645633\n64508407\n16995479\n9539922\n69476101\n11152808\n81062846",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "10\n58522746\n73346416\n16835430\n99873956\n16833723\n61953759\n50422912\n46412075\n2463104\n83012476",
      "expected_output": "10\n58522746\n73346416\n16835430\n99873956\n16833723\n61953759\n50422912\n46412075\n2463104\n83012476",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n50293466\n41213974\n2836211\n96896461\n1032204\n91831298",
      "expected_output": "6\n50293466\n41213974\n2836211\n96896461\n1032204\n91831298",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n15554361\n25834579\n9348157\n67667111\n79642401\n90545685\n57309778\n94102618",
      "expected_output": "8\n15554361\n25834579\n9348157\n67667111\n79642401\n90545685\n57309778\n94102618",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n86456786\n9136144\n8958073\n51794458\n40204621\n22513197",
      "expected_output": "6\n86456786\n9136144\n8958073\n51794458\n40204621\n22513197",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "72\n52813\n89236\n15394\n59634\n49666\n76996\n61730\n2399\n44862\n62801\n33672\n79699\n640\n19202\n91339\n94343\n10890\n37086\n67141\n47210\n3715\n51181\n70093\n94999\n25006\n2689\n4976\n42126\n59515\n9755\n2246\n19615\n17796\n91887\n29150\n17475\n65242\n60276\n98433\n7673\n46392\n45626\n19503\n92165\n61299\n26420\n55651\n26683\n94652\n29807\n87957\n5738\n13127\n53694\n62493\n52126\n82133\n68186\n48921\n94326\n67341\n32813\n49971\n66730\n31146\n26387\n8911\n57921\n55781\n17187\n92511\n1585",
      "expected_output": "72\n52813\n89236\n15394\n59634\n49666\n76996\n61730\n2399\n44862\n62801\n33672\n79699\n640\n19202\n91339\n94343\n10890\n37086\n67141\n47210\n3715\n51181\n70093\n94999\n25006\n2689\n4976\n42126\n59515\n9755\n2246\n19615\n17796\n91887\n29150\n17475\n65242\n60276\n98433\n7673\n46392\n45626\n19503\n92165\n61299\n26420\n55651\n26683\n94652\n29807\n87957\n5738\n13127\n53694\n62493\n52126\n82133\n68186\n48921\n94326\n67341\n32813\n49971\n66730\n31146\n26387\n8911\n57921\n55781\n17187\n92511\n1585",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "56\n92434\n25633\n9154\n31258\n80605\n13817\n71119\n33290\n61958\n37477\n29768\n26431\n69656\n95010\n3327\n40194\n81397\n14449\n45795\n64573\n81170\n98925\n37520\n47421\n3551\n4028\n281\n63922\n60639\n84791\n48966\n51234\n54069\n92286\n59527\n99751\n37996\n24059\n37558\n2234\n44449\n53674\n89594\n64738\n2187\n38223\n10335\n63158\n473\n30593\n41464\n96109\n43250\n76370\n34748\n55569",
      "expected_output": "56\n92434\n25633\n9154\n31258\n80605\n13817\n71119\n33290\n61958\n37477\n29768\n26431\n69656\n95010\n3327\n40194\n81397\n14449\n45795\n64573\n81170\n98925\n37520\n47421\n3551\n4028\n281\n63922\n60639\n84791\n48966\n51234\n54069\n92286\n59527\n99751\n37996\n24059\n37558\n2234\n44449\n53674\n89594\n64738\n2187\n38223\n10335\n63158\n473\n30593\n41464\n96109\n43250\n76370\n34748\n55569",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "28\n92799\n90805\n94981\n68599\n6025\n67603\n77709\n6469\n9869\n35060\n85274\n11655\n2212\n65452\n53285\n37505\n35688\n54213\n53548\n59749\n75462\n92427\n51541\n4091\n40402\n20551\n44189\n80968",
      "expected_output": "28\n92799\n90805\n94981\n68599\n6025\n67603\n77709\n6469\n9869\n35060\n85274\n11655\n2212\n65452\n53285\n37505\n35688\n54213\n53548\n59749\n75462\n92427\n51541\n4091\n40402\n20551\n44189\n80968",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "71\n16516\n81216\n64963\n7890\n84633\n36097\n95585\n76933\n79832\n56476\n85808\n19015\n87346\n49395\n45543\n70813\n93860\n29723\n46368\n33334\n11607\n37126\n39076\n73758\n65747\n96323\n39256\n90477\n56577\n17272\n66902\n45329\n36475\n4791\n5115\n48231\n3567\n9763\n70434\n60876\n81698\n99434\n82870\n11196\n26026\n9781\n51503\n56561\n27196\n43513\n42847\n26641\n83330\n79112\n40527\n69778\n51596\n50704\n1893\n31591\n62828\n60025\n40962\n93543\n73580\n49844\n99950\n93009\n12301\n81165\n30969",
      "expected_output": "71\n16516\n81216\n64963\n7890\n84633\n36097\n95585\n76933\n79832\n56476\n85808\n19015\n87346\n49395\n45543\n70813\n93860\n29723\n46368\n33334\n11607\n37126\n39076\n73758\n65747\n96323\n39256\n90477\n56577\n17272\n66902\n45329\n36475\n4791\n5115\n48231\n3567\n9763\n70434\n60876\n81698\n99434\n82870\n11196\n26026\n9781\n51503\n56561\n27196\n43513\n42847\n26641\n83330\n79112\n40527\n69778\n51596\n50704\n1893\n31591\n62828\n60025\n40962\n93543\n73580\n49844\n99950\n93009\n12301\n81165\n30969",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "21\n73707\n58\n3004\n52590\n36416\n5908\n93379\n34656\n41708\n57466\n9430\n80161\n61891\n29850\n99145\n95021\n59914\n17342\n98619\n61335\n87830",
      "expected_output": "21\n73707\n58\n3004\n52590\n36416\n5908\n93379\n34656\n41708\n57466\n9430\n80161\n61891\n29850\n99145\n95021\n59914\n17342\n98619\n61335\n87830",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "60\n65597\n65809\n78980\n38895\n67330\n93543\n50562\n70517\n69632\n54128\n55807\n9986\n57644\n36896\n29593\n6395\n29206\n1147\n50610\n37375\n14379\n5136\n91521\n3150\n45204\n21970\n54988\n12609\n98628\n82182\n40806\n81604\n62919\n43999\n71997\n49791\n66237\n53014\n38580\n72085\n4555\n14280\n7720\n74856\n65027\n9831\n62676\n7709\n59125\n2287\n75150\n3954\n39159\n72155\n56559\n21520\n62555\n51976\n26590\n32751",
      "expected_output": "60\n65597\n65809\n78980\n38895\n67330\n93543\n50562\n70517\n69632\n54128\n55807\n9986\n57644\n36896\n29593\n6395\n29206\n1147\n50610\n37375\n14379\n5136\n91521\n3150\n45204\n21970\n54988\n12609\n98628\n82182\n40806\n81604\n62919\n43999\n71997\n49791\n66237\n53014\n38580\n72085\n4555\n14280\n7720\n74856\n65027\n9831\n62676\n7709\n59125\n2287\n75150\n3954\n39159\n72155\n56559\n21520\n62555\n51976\n26590\n32751",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "43\n65159\n84275\n21912\n37219\n14328\n94861\n71856\n23808\n17638\n82823\n58089\n75937\n74669\n36122\n59428\n92823\n78818\n30973\n42352\n58665\n1644\n74107\n58591\n22596\n25268\n93403\n22531\n22335\n1943\n70488\n89278\n32909\n31822\n49370\n24419\n87165\n25284\n94678\n34079\n83462\n22512\n19964\n96867",
      "expected_output": "43\n65159\n84275\n21912\n37219\n14328\n94861\n71856\n23808\n17638\n82823\n58089\n75937\n74669\n36122\n59428\n92823\n78818\n30973\n42352\n58665\n1644\n74107\n58591\n22596\n25268\n93403\n22531\n22335\n1943\n70488\n89278\n32909\n31822\n49370\n24419\n87165\n25284\n94678\n34079\n83462\n22512\n19964\n96867",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "101\n63953824\n74310935\n53444944\n55777529\n32066612\n4529855\n75544051\n9972556\n75540905\n66317359\n52406235\n58056316\n86170217\n33752790\n7205171\n64965738\n27328280\n44870824\n91327184\n37178978\n83980684\n52581169\n29720188\n39599084\n80508939\n29544341\n33513643\n6353999\n67152440\n38935833\n78144851\n93891749\n84379333\n14794879\n12685978\n3816014\n50922207\n72270491\n47711331\n75801961\n85564490\n32026310\n44067398\n18035929\n1451094\n6977772\n61810345\n39944753\n35202117\n46799845\n41718092\n90576966\n10772681\n17105214\n63621433\n38555786\n15879738\n76459194\n86745308\n16062272\n42191231\n77196758\n54273896\n8419244\n98809290\n95655345\n34162969\n1903662\n83781204\n85226715\n62329518\n3126734\n41185269\n19703035\n84213689\n73528723\n9705015\n44588788\n99500126\n87195058\n68154188\n62987407\n5579657\n55254065\n72638963\n37751188\n83069743\n14241942\n84319193\n86067318\n59044400\n76129576\n4568897\n35275538\n52809145\n56629452\n34316094\n56592889\n97484721\n67905306\n10825090",
      "expected_output": "101\n63953824\n74310935\n53444944\n55777529\n32066612\n4529855\n75544051\n9972556\n75540905\n66317359\n52406235\n58056316\n86170217\n33752790\n7205171\n64965738\n27328280\n44870824\n91327184\n37178978\n83980684\n52581169\n29720188\n39599084\n80508939\n29544341\n33513643\n6353999\n67152440\n38935833\n78144851\n93891749\n84379333\n14794879\n12685978\n3816014\n50922207\n72270491\n47711331\n75801961\n85564490\n32026310\n44067398\n18035929\n1451094\n6977772\n61810345\n39944753\n35202117\n46799845\n41718092\n90576966\n10772681\n17105214\n63621433\n38555786\n15879738\n76459194\n86745308\n16062272\n42191231\n77196758\n54273896\n8419244\n98809290\n95655345\n34162969\n1903662\n83781204\n85226715\n62329518\n3126734\n41185269\n19703035\n84213689\n73528723\n9705015\n44588788\n99500126\n87195058\n68154188\n62987407\n5579657\n55254065\n72638963\n37751188\n83069743\n14241942\n84319193\n86067318\n59044400\n76129576\n4568897\n35275538\n52809145\n56629452\n34316094\n56592889\n97484721\n67905306\n10825090",
      "type": "max_case_17",
      "description": "Maximum size array (N = 101)"
    },
    {
      "input": "101\n62830544\n65907103\n63129684\n16051613\n54319836\n59140772\n27356653\n79900135\n49487801\n80862803\n93005901\n57802455\n13943349\n25091388\n42949627\n32596857\n69014692\n36832398\n25282040\n59844565\n73312345\n39692489\n36580724\n78654495\n59613909\n70257651\n23018949\n91069643\n94401525\n28412243\n53939132\n27403148\n92887777\n39956852\n41216496\n56900860\n8671109\n54426934\n74351184\n38588462\n1968391\n67655015\n27020173\n30165906\n19708190\n23953534\n5668390\n52062143\n92960369\n47808760\n60620561\n58756161\n47077191\n60038661\n56896773\n32051150\n74637005\n36955594\n95694130\n68535851\n24320702\n43852038\n15071438\n98144911\n42960365\n9129388\n49586322\n79946670\n81761639\n84704559\n36156799\n96594428\n43650464\n87383786\n14472518\n62918666\n45502087\n66755509\n77051336\n23395796\n46479307\n76792050\n51275981\n30171198\n55378256\n81514789\n44788304\n90973378\n69537579\n83274208\n94638906\n81769480\n30065923\n13514549\n4498932\n84358281\n35910588\n77505358\n15414290\n67101955\n6634357",
      "expected_output": "101\n62830544\n65907103\n63129684\n16051613\n54319836\n59140772\n27356653\n79900135\n49487801\n80862803\n93005901\n57802455\n13943349\n25091388\n42949627\n32596857\n69014692\n36832398\n25282040\n59844565\n73312345\n39692489\n36580724\n78654495\n59613909\n70257651\n23018949\n91069643\n94401525\n28412243\n53939132\n27403148\n92887777\n39956852\n41216496\n56900860\n8671109\n54426934\n74351184\n38588462\n1968391\n67655015\n27020173\n30165906\n19708190\n23953534\n5668390\n52062143\n92960369\n47808760\n60620561\n58756161\n47077191\n60038661\n56896773\n32051150\n74637005\n36955594\n95694130\n68535851\n24320702\n43852038\n15071438\n98144911\n42960365\n9129388\n49586322\n79946670\n81761639\n84704559\n36156799\n96594428\n43650464\n87383786\n14472518\n62918666\n45502087\n66755509\n77051336\n23395796\n46479307\n76792050\n51275981\n30171198\n55378256\n81514789\n44788304\n90973378\n69537579\n83274208\n94638906\n81769480\n30065923\n13514549\n4498932\n84358281\n35910588\n77505358\n15414290\n67101955\n6634357",
      "type": "max_case_18",
      "description": "Maximum size array (N = 101)"
    },
    {
      "input": "101\n3697805\n100000000\n100000000\n1\n81964268\n1\n100000000\n100000000\n1\n15546061\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n2919629\n65053167\n100000000\n51458873\n78507898\n100000000\n44706624\n22759856\n1\n100000000\n54265660\n1\n100000000\n100000000\n49467632\n15672979\n100000000\n1\n100000000\n84629955\n1\n49711969\n100000000\n100000000\n37891251\n1\n1\n1\n100000000\n70281382\n100000000\n100000000\n12524710\n47075238\n100000000\n20289587\n1\n100000000\n1\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n1\n49840799\n100000000\n92252748\n47834682\n53335411\n100000000\n1\n87482316\n47542076\n100000000\n1\n100000000\n43365328\n1\n100000000\n100000000\n38052654\n100000000\n100000000\n100000000\n17955252\n41613227\n1\n100000000\n100000000\n100000000\n89102006\n28121698\n100000000\n1\n100000000\n56274776\n1\n30485280\n1\n3534441\n38320050\n100000000\n8083393",
      "expected_output": "101\n3697805\n100000000\n100000000\n1\n81964268\n1\n100000000\n100000000\n1\n15546061\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n2919629\n65053167\n100000000\n51458873\n78507898\n100000000\n44706624\n22759856\n1\n100000000\n54265660\n1\n100000000\n100000000\n49467632\n15672979\n100000000\n1\n100000000\n84629955\n1\n49711969\n100000000\n100000000\n37891251\n1\n1\n1\n100000000\n70281382\n100000000\n100000000\n12524710\n47075238\n100000000\n20289587\n1\n100000000\n1\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n1\n49840799\n100000000\n92252748\n47834682\n53335411\n100000000\n1\n87482316\n47542076\n100000000\n1\n100000000\n43365328\n1\n100000000\n100000000\n38052654\n100000000\n100000000\n100000000\n17955252\n41613227\n1\n100000000\n100000000\n100000000\n89102006\n28121698\n100000000\n1\n100000000\n56274776\n1\n30485280\n1\n3534441\n38320050\n100000000\n8083393",
      "type": "edge_case_19",
      "description": "Edge case array (N = 101)"
    },
    {
      "input": "101\n17438621\n1\n100000000\n1\n100000000\n100000000\n100000000\n100000000\n96421665\n8207208\n1\n8052373\n1\n54311345\n100000000\n1\n1\n6177081\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n1\n1\n1\n1\n1\n1\n71905712\n1\n100000000\n49614866\n1\n89544859\n84769727\n43519558\n36945277\n1\n1\n28109218\n100000000\n1\n1\n31101378\n1\n27880054\n100000000\n13738989\n1\n100000000\n1\n100000000\n100000000\n25031257\n1\n1\n100000000\n100000000\n100000000\n1\n100000000\n98920652\n66830883\n100000000\n1\n100000000\n1\n65920950\n56856492\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n64669474\n65154023\n33917928\n83975813\n19901026\n1\n58244739\n82629789\n7044988\n100000000\n1\n100000000\n55411574\n100000000\n1\n1\n100000000\n93023321\n61770015\n100000000\n1\n100000000",
      "expected_output": "101\n17438621\n1\n100000000\n1\n100000000\n100000000\n100000000\n100000000\n96421665\n8207208\n1\n8052373\n1\n54311345\n100000000\n1\n1\n6177081\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n1\n1\n1\n1\n1\n1\n1\n71905712\n1\n100000000\n49614866\n1\n89544859\n84769727\n43519558\n36945277\n1\n1\n28109218\n100000000\n1\n1\n31101378\n1\n27880054\n100000000\n13738989\n1\n100000000\n1\n100000000\n100000000\n25031257\n1\n1\n100000000\n100000000\n100000000\n1\n100000000\n98920652\n66830883\n100000000\n1\n100000000\n1\n65920950\n56856492\n100000000\n100000000\n100000000\n100000000\n100000000\n100000000\n64669474\n65154023\n33917928\n83975813\n19901026\n1\n58244739\n82629789\n7044988\n100000000\n1\n100000000\n55411574\n100000000\n1\n1\n100000000\n93023321\n61770015\n100000000\n1\n100000000",
      "type": "edge_case_20",
      "description": "Edge case array (N = 101)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:52",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:29"
}