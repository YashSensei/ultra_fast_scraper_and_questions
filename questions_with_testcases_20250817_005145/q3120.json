{
  "problem_code": "problems",
  "title": "Travelling tours",
  "tags": [],
  "text": "In Hanoi, there are N beauty-spots (2 ≤ N ≤ 200), connected by M one-way streets. The length of each street does not exceed 10000. You are the director of a travel agency, and you want to create some tours around the city which satisfy the following conditions:Each of the N beauty-spots belongs to exactly one tour.Each tour is a cycle which consists of at least 2 places and visits each place once (except for the place we start from which is visited twice).The total length of all the streets we use is minimal.InputThe first line of input contains the number of test cases t (t ≤ 15). The first line of each testcase contains the numbers N, M. The next M lines contain three integers U V W which mean that there is one street from U to V of length W.OutputFor each test case you should output the minimal total length of all tours.ExampleInput:2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3Output:42\r\n40ExplanationTest 1:Tour #1: 1 → 2 → 3 → 1 ⇒ Length = 20Tour #2: 6 → 5 → 4 → 6 ⇒ Length = 22Test 2:Tour #1: 1 → 3 → 2 → 1 ⇒ Length = 27Tour #2: 5 → 4 → 5 ⇒ Length = 13",
  "sample_input": "Input:2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3Output:42\r\n40",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TOURS",
  "scraped_at": "2025-08-17 00:34:24",
  "test_cases": [
    {
      "input": "2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3",
      "expected_output": "42\r\n40",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1\n2",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "3\n8\n9\n3",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n2\n1\n7\n3",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "16\n70134441\n87882399\n21561523\n47220268\n28454328\n51480757\n18016630\n84614668\n57834808\n9081130\n82294175\n20453568\n8741123\n6336015\n99305876\n16392527",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "12\n34087223\n11887114\n481641\n35912006\n84084336\n20671515\n60398498\n24031582\n67412289\n11892020\n53934500\n46326628",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "9\n59427821\n13156984\n39332890\n60643888\n23304016\n88731886\n21876037\n34852070\n19717977",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n86158088\n82241072\n69580095\n93805808\n2940876\n39057486\n62519935\n56294922\n35724362\n58172427\n63193512\n54935792\n55710746\n95839044\n82939589\n45268537",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n2849036\n29189294\n51152350\n31958477\n231946\n73812536",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "167\n86583\n73529\n65264\n41585\n71107\n12572\n56564\n57022\n87764\n648\n86332\n42723\n51656\n32815\n85338\n82109\n73792\n91084\n4884\n5628\n8893\n97149\n38082\n95888\n72865\n11266\n8215\n50214\n26901\n85448\n39976\n12154\n15549\n96244\n53555\n9247\n19730\n75669\n89784\n47579\n89661\n12180\n25077\n35429\n50642\n56944\n11694\n23342\n23356\n12629\n65977\n32058\n89122\n38112\n13399\n20600\n42455\n54205\n1675\n97881\n20293\n81826\n6780\n29117\n36206\n53240\n94332\n34313\n70035\n70582\n47603\n95176\n91218\n52394\n99564\n68915\n89127\n40085\n81838\n85482\n40460\n41481\n28569\n30542\n74275\n6029\n3279\n56200\n71214\n77589\n50545\n47104\n78136\n68348\n6454\n74980\n44845\n52722\n7768\n87398\n54203\n82422\n74437\n40850\n2\n8265\n19050\n13402\n22809\n86269\n9833\n58711\n22449\n72458\n21026\n74791\n3772\n88274\n51284\n35366\n97416\n53246\n94626\n37581\n83040\n10256\n29558\n7720\n20755\n9463\n77528\n14129\n4638\n76727\n32728\n8670\n4557\n60746\n63338\n11428\n40284\n81560\n96066\n27025\n87084\n55179\n81799\n11899\n11116\n51240\n33822\n74744\n6405\n56518\n5036\n46571\n35186\n33386\n89689\n36720\n19567\n94655\n38030\n20503\n86022\n64584\n24736",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "35\n22361\n36017\n40453\n32942\n17353\n83717\n32912\n59056\n35535\n58344\n73302\n13003\n27067\n75020\n62267\n21920\n1002\n35804\n96149\n8657\n59469\n81291\n92145\n62192\n61872\n57767\n94888\n86094\n69834\n10631\n13128\n14626\n8083\n21829\n89511",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "124\n20730\n60236\n34199\n27537\n23896\n87042\n43691\n93560\n86285\n34563\n98480\n19058\n54458\n87856\n71282\n89441\n22952\n71566\n99404\n85384\n19878\n60802\n84743\n89100\n92086\n41299\n1955\n97484\n69779\n67706\n74596\n92647\n21696\n95097\n89830\n24337\n16613\n55992\n18461\n98794\n74602\n53138\n5589\n92002\n67558\n49047\n55439\n59977\n31838\n15570\n13953\n13577\n41246\n52568\n48461\n69256\n95747\n42311\n39148\n71354\n46806\n20573\n77414\n64120\n11994\n69783\n52864\n2917\n62723\n80391\n96437\n87107\n69844\n6438\n28856\n52250\n28114\n61245\n11262\n78091\n51108\n14345\n67080\n2489\n76367\n79886\n93469\n96069\n20139\n62761\n78844\n572\n27319\n36762\n42779\n25728\n39108\n72349\n93322\n46995\n99636\n72475\n10356\n96155\n24138\n45112\n28437\n10074\n85753\n44564\n16586\n8616\n16913\n89265\n46816\n31729\n41675\n69162\n50706\n13147\n19621\n14305\n26063\n63134",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n19560\n76624\n10325\n80618\n19665\n36751\n60953\n1347\n23928\n81545\n39085\n83681\n51943\n88293\n55410\n89283\n22844\n47020\n4992\n31989\n94673\n9177\n9499\n18588\n44359\n1162\n48752\n55931\n96344\n22969\n20443\n84804\n88386\n30050\n24858\n6726\n16179\n78346\n74327\n45820\n89577\n94665\n88690\n42576\n22265\n89118\n35679\n88406\n43327\n98646\n51683\n12181\n40737\n74556\n38899\n94932\n56736\n64460\n21318\n51150\n43605\n89684\n13923\n70049\n38517\n35140\n7703\n85240\n60317\n32787\n85776\n54637\n80190\n37678\n68893\n51945\n84149\n74162\n94028\n66516\n46785\n10556\n6975\n17270\n7089\n81188\n11754\n41817\n35092\n27314\n43990\n62554\n7120\n38413\n46845\n68136\n95818\n81255\n371\n32095\n35374\n72551\n51185\n11071\n27153\n64053\n77143\n9584\n79206\n95849\n92573\n12535\n68572\n64454\n26337\n54355\n11271\n17661\n51727\n63119\n37149\n10414\n77113\n61174\n30487\n67935\n689\n18239\n6427\n197\n88669\n46156\n84059\n93471\n21765\n54853\n56922\n54290\n40730\n96350\n27406\n53125\n53113\n40377\n98066\n93291\n41854\n9208\n35172\n36984\n45544\n83377\n6551\n58579\n74416\n7889\n20735\n78324\n37039\n53533\n66783\n54806\n89329\n20765\n31431\n88328\n95137\n64035\n64716\n4122\n47128\n39736\n32506\n3003\n76056\n67463\n31248\n82015\n55721\n18204\n53546\n33657\n18768\n55941\n89677\n73895\n43671\n17927\n64397\n51004\n7223\n2751\n22388\n55466\n58601\n66434\n94772\n45790\n36295\n43684",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "79\n79298\n24137\n94731\n99397\n56586\n40754\n62105\n4967\n42084\n29086\n3555\n38044\n45460\n64582\n644\n73080\n75788\n12086\n35304\n4653\n92435\n25329\n78047\n86235\n76090\n19007\n96546\n42642\n67160\n26355\n59723\n55050\n95972\n24993\n30315\n69060\n7029\n99420\n80094\n33746\n27181\n19357\n60436\n35891\n83140\n73386\n70041\n92480\n91554\n14829\n42606\n9493\n46231\n57013\n82538\n55781\n69925\n48374\n25448\n3164\n57635\n4763\n6573\n89258\n73812\n36913\n51015\n59153\n61295\n72067\n80133\n70264\n82810\n37558\n50560\n10557\n38428\n74909\n17700",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "155\n63170\n61072\n95048\n60983\n13389\n59418\n1379\n88963\n52891\n54942\n17918\n5520\n73573\n24326\n12383\n90049\n92073\n74087\n79943\n45166\n72802\n439\n4331\n24548\n30702\n13867\n91290\n66166\n74430\n51637\n15967\n60101\n34146\n89026\n41953\n36291\n1162\n80904\n90592\n89274\n29795\n99213\n34766\n83508\n26462\n77034\n63717\n38408\n62862\n70950\n25365\n40453\n44618\n13840\n99178\n66859\n27187\n92205\n47677\n69265\n6787\n73251\n80143\n57122\n69748\n91808\n13397\n67711\n34651\n81973\n85934\n77323\n32398\n55170\n19939\n30792\n82261\n18831\n42321\n64638\n80341\n1037\n10369\n89830\n82922\n35008\n9897\n88341\n23456\n45800\n40159\n59470\n3052\n54496\n34799\n717\n28017\n4199\n67026\n147\n16420\n69148\n5548\n25339\n93306\n68458\n46111\n49714\n47081\n86666\n66138\n60784\n75396\n2713\n16984\n45123\n8653\n59246\n67618\n53032\n24879\n42264\n80630\n94095\n81043\n78741\n91329\n84797\n52435\n76646\n8429\n41436\n56718\n37019\n14141\n34676\n59384\n99182\n62151\n62704\n46152\n14430\n15709\n91830\n51690\n21574\n25655\n33537\n73545\n97190\n24582\n9362\n2538\n9032\n75991",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "41\n64585\n92000\n23529\n84546\n40792\n41264\n63711\n36336\n97830\n93373\n62148\n68732\n86892\n55702\n26361\n4821\n13053\n53799\n96753\n72226\n50442\n88781\n28812\n93484\n48233\n27407\n94218\n90884\n46335\n88298\n64469\n69167\n63050\n60845\n5475\n93632\n67284\n9506\n83179\n27887\n27813",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n75295880\n76867859\n56986475\n74913430\n528519\n60696334\n42987518\n71170953\n47673240\n34448743\n34437129\n52606664\n81492945\n28563789\n98992839\n89208296\n24056130\n82061694\n13833546\n68879171\n55574852\n79199754\n60330453\n92251569\n15885468\n13232727\n78461859\n76875125\n58627945\n79270997\n2648347\n97092653\n45647305\n10463859\n80239706\n99583742\n21292556\n92546151\n21786642\n29218087\n87604282\n30660094\n48680977\n52281561\n51585350\n51522833\n40458618\n96139358\n69288859\n25271550\n66877091\n37705521\n58100506\n73956072\n1801749\n62186716\n98361446\n5151518\n2000058\n46280860\n60487251\n2034897\n35358595\n86711899\n71182021\n78902699\n50566\n97295020\n95697801\n36656320\n61323268\n61436406\n73898841\n82329702\n4303287\n8693337\n92898058\n21869013\n41579930\n2601970\n68170661\n92240332\n85730788\n29376497\n64607685\n39019966\n24459844\n53834409\n83461555\n7723747\n8284982\n32447726\n95446676\n85065178\n48914582\n58211739\n7656300\n87627530\n18258551\n55895452\n98000472\n68436351\n30021306\n44753219\n5919191\n89074861\n99868241\n90337441\n70587922\n76307262\n47332920\n90766547\n32502106\n45297463\n50008370\n82378276\n73119444\n91790453\n78400032\n97909431\n1809630\n40118087\n67795709\n49609100\n4713449\n89309446\n78097535\n64499896\n35420401\n26929742\n52712585\n81150666\n37930591\n606457\n47910632\n14415034\n28570302\n99831729\n75264469\n11801684\n98941246\n50646448\n59963345\n92751566\n95595424\n80392157\n53640651\n80735967\n91474387\n50104626\n2228555\n63349193\n36670385\n78202065\n26225653\n1926416\n60523420\n81498837\n4108582\n84376422\n36043063\n18926580\n53142669\n57779106\n19129023\n47864211\n73110367\n32210948\n78237458\n71892642\n43883453\n69408805\n640777\n5151647\n18044518\n99878148\n76967464\n31076866\n58946348\n761553\n18448242\n8873243\n11826368\n56699961\n53183760\n64812471\n59317044\n69312560\n58656034\n14506847\n16846146\n5353624\n35102084\n15118876\n66489797\n32750166\n9066829\n71157531\n35881318\n36762702",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n48428595\n69641439\n4519586\n38184021\n79869660\n27680552\n81336274\n63182773\n47617677\n84305177\n91365642\n93601902\n97312693\n26553672\n42484621\n92417778\n88069756\n46388290\n39580163\n43910364\n28564380\n2532605\n5071641\n76535925\n19557693\n72071111\n90597662\n93353957\n63948399\n80145393\n50782631\n51128493\n85918985\n12839043\n53624983\n21846896\n18779035\n91389792\n89789696\n69443034\n62095581\n59422955\n79195274\n97218585\n36886458\n17310449\n54421420\n4955107\n47967352\n26147932\n36486567\n54978669\n49595537\n52746980\n95534344\n36430730\n40820598\n89926188\n86965434\n66865401\n80801509\n51607762\n42343130\n4801248\n69061846\n83223778\n85386531\n42479409\n1669010\n55854120\n72537807\n80224286\n96859955\n40608523\n97629225\n42729264\n9169708\n22546827\n49743129\n71470994\n80838856\n49224939\n86943655\n47909373\n41351024\n9796209\n46002423\n86680970\n53897056\n20654034\n25897266\n49089829\n11239693\n7828083\n20647271\n88392661\n28260584\n31643067\n80379871\n21466055\n17729977\n65833942\n29375281\n19264751\n49394014\n26473731\n47438370\n22213629\n34847920\n81923506\n13413240\n66789637\n98911409\n99263299\n60245842\n10374986\n26371093\n7388745\n46527961\n39398722\n92841091\n60473429\n17597307\n75087546\n21536293\n55475331\n17896094\n12176112\n3458796\n88752577\n5478280\n31477680\n52545127\n50563201\n50888491\n62822718\n71585287\n99531144\n62893959\n831595\n38225224\n47357506\n36161762\n3351981\n51739943\n81938161\n88996932\n47435475\n65158353\n91682024\n51067640\n23567223\n12664191\n39166268\n22518649\n87643572\n55189518\n21775729\n2591848\n86477750\n57086902\n10566365\n78017164\n48502938\n39049244\n44639599\n22015193\n13975613\n63403433\n24823244\n74846093\n24746123\n84072107\n33142602\n90141157\n76353525\n6846119\n81830527\n86619353\n83351807\n24338440\n60376263\n76593248\n25095348\n86546782\n75431841\n59642301\n68620015\n32086001\n1375309\n49647125\n41184728\n55445950\n21419662\n86680861\n42748970\n73349725\n1109834\n98692499\n1660671",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "1\n38108267",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 1)"
    },
    {
      "input": "1\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 1)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:55",
  "total_test_cases": 20
}