{
  "problem_code": "problems",
  "title": "Dixon Dominoes",
  "tags": [],
  "text": "Dixon was in his house, he was a little bored, so he took some dominoes from the case and started thinking: “It is possible to use Qx pieces from the Dominoes so it can make a simulation of a game?” so, Dixon is not a super programmer, but he knows a little bit of constraints in the problems, so he will give it to you, your task, if you choose to accept it, is to find all the possible ways of some N pieces of Domino can be joined together to make a game simulation using exactly Qx dominoes pieces. If you can’t do this, you should print “0”InputThe input will consists of an integer T, denoting the number of test cases, next, T cases will follow, every case starts with 2 lines N and Q, being N the number of dominoes David has and Q the number of queries you should do, then, N lines will follow, denoting the two parts of a domino piece, as you may know, the domino piece is split in two, so you can join by any side another piece, after this, Q lines will follow, denoting the number of piece you must use to build the game simulation.Constraints1 ≤ T ≤ 1001 ≤  N ≤ 161 ≤ Q ≤ 160 ≤ N1… NN≤ 61 ≤ Q1… QN≤ NOutputYou should outputallthe possible ways to form a game using Qx pieces (with any possible permutation too), as this number can grow very huge, we need you to print the output modulo 31337.ExampleInput:34 32 33 11 44 31342 11 21 222 11 11 12Output:8\r\n10\r\n4\r\n4\r\n8Domino idea credits goes to:Daniel AmpueroandLuis ArguelloExample of the output with the first case and Q=4solution 1: joining the pieces 1, 2, 3 and 4.solution 2: joining the pieces 4, 3, 2 and 1.solution 3: joining the pieces 2, 3, 4 and 1.solution 4: joining the pieces 1, 4, 3 and 2.Tip: In the case with one piece only, you can form a game starting with the two faces of every single piece, i.e. if we want to form a game using just the piece \"2 1\", one possible game is \"2 1\" and the other \"1 2\", resulting in two different ways.",
  "sample_input": "Input:34 32 33 11 44 31342 11 21 222 11 11 12Output:8\r\n10\r\n4\r\n4\r\n8",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/DIXDOOM",
  "scraped_at": "2025-08-17 00:33:59",
  "test_cases": [
    {
      "input": "34 32 33 11 44 31342 11 21 222 11 11 12",
      "expected_output": "8\r\n10\r\n4\r\n4\r\n8",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1 6 5 5 9 5 5 2 2 5 7 3",
      "expected_output": "0",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "4 5 1 7 2 3 3 3 5 7 5 1",
      "expected_output": "0",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "9 9 4 1 3 1 4 10 4 8 1 8",
      "expected_output": "0",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "34 38 98 1 95 93 13 48 65 71 1 99",
      "expected_output": "0",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "46 94 74 45 33 79 23 29 100 30 16 49",
      "expected_output": "0",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "55 55 41 13 69 35 68 7 42 1 51 92",
      "expected_output": "0",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "41 36 74 31 29 25 61 99 24 29 30 29",
      "expected_output": "0",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "60 83 38 79 53 56 68 100 11 69 95 66",
      "expected_output": "0",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "16 68 40 78 79 11 31 55 37 57 49 47",
      "expected_output": "0",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "29 34 16 65 24 22 10 66 32 80 76 73",
      "expected_output": "0",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "71 13 11 50 42 62 48 46 77 34 30 69",
      "expected_output": "0",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "50 67 14 65 10 28 18 17 72 50 38 11",
      "expected_output": "0",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "15 8 55 20 56 63 30 48 12 13 80 20",
      "expected_output": "0",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "32 45 33 36 25 28 80 31 30 72 30 22",
      "expected_output": "0",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "22 45 61 34 30 40 54 20 42 50 48 20",
      "expected_output": "0",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "161 161 161 161 161 161 161 161 161 161 161 161",
      "expected_output": "0",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "161 161 161 161 161 161 161 161 161 161 161 161",
      "expected_output": "0",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1 2 160 160 160 161 161 161 161 161 160 161",
      "expected_output": "0",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "2 160 1 161 161 2 160 2 160 160 161 160",
      "expected_output": "0",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:53",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:37"
}