{
  "problem_code": "problems",
  "title": "Your Rank is Pure (EXTREME ver)",
  "tags": [],
  "text": "Note: The problem description is same asGCJPURE, but with higher constraints (to become more challenging), more strict time limit (to reject bad complexity), and more strict source limit (to reject hardcoded precomputation). Good Luck.Pontius: You know, I like this number 127, I don't know why.Woland: Well, that is an object so pure. You know the prime numbers.Pontius: Surely I do. Those are the objects possessed by our ancient masters hundreds of years ago. Oh, yes, why then? 127 is indeed a prime number as I was told.Woland: Not... only... that. 127 is the 31st prime number; then, 31 is itself a prime, it is the 11th; and 11 is the 5th; 5 is the 3rd; 3, you know, is the second; and finally 2 is the 1st.Pontius: Heh, that is indeed... purely prime.The game can be played on any subset S of positive integers. A number in S is considered pure with respect to S if, starting from it, you can continue taking its rank in S, and get a number that is also in S, until in finite steps you hit the number 1, which is not in S.When n is given, in how many ways you can pick S, a subset of {2, 3, ..., n}, so that n is pure, with respect to S? The answer might be a big number, you need to output it modulo 109+7.InputThe first line of the input gives the number of test cases,T.Tlines follow. Each contains a single integern.OutputFor each test case, output one line containing \"Case #x: y\", where x is the case number (starting from 1) and y is the answer as described above.ConstraintsT< 1052 ≤n≤ 105Note: These constraints were selected carefully.ExampleInput:2\r\n5\r\n6Output:Case #1: 5\r\nCase #2: 8Other InfoSorry for slow language users, I've made an experiment and the result is if I set constraints that allow slow languages to be accepted with 'good' complexity O(f(n)), then the 'bad' complexity O(f(n)*log(n)) could be accepted too using fast language (Because slow language is ~80x slower than fast language). I don't want this to happen. But don't feel so bad :-) I've madethis tutorial problemthat allow slow languages to be accepted (except maybe: PIKE).Time limit ~4× My Program top speed (25.53s using 1744B of C code).You can see my submission history and time record for this problem:hereSee also:Another problem added by Tjandra Satria Gunawan",
  "sample_input": "Input:2\r\n5\r\n6Output:Case #1: 5\r\nCase #2: 8",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/EGCJPURE",
  "scraped_at": "2025-08-17 00:33:42",
  "test_cases": [
    {
      "input": "2\r\n5\r\n6",
      "expected_output": "Case #1: 5\r\nCase #2: 8",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3\n1\n7\n6",
      "expected_output": "3\n1\n7\n6",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n7",
      "expected_output": "1\n7",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "3\n9\n10\n4",
      "expected_output": "3\n9\n10\n4",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "12\n35963516\n74146654\n27000451\n93804249\n20053855\n85065358\n59672757\n53850356\n83310177\n32338357\n35281913\n67308307",
      "expected_output": "12\n35963516\n74146654\n27000451\n93804249\n20053855\n85065358\n59672757\n53850356\n83310177\n32338357\n35281913\n67308307",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n7368541\n84167298\n34999452\n61539904\n16612994\n29735833",
      "expected_output": "6\n7368541\n84167298\n34999452\n61539904\n16612994\n29735833",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "10\n69731448\n81203074\n2430566\n65688601\n42156267\n17092309\n10933208\n89268449\n54703017\n29419609",
      "expected_output": "10\n69731448\n81203074\n2430566\n65688601\n42156267\n17092309\n10933208\n89268449\n54703017\n29419609",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "12\n89178947\n44097828\n32091292\n86599937\n26110062\n55582406\n54065121\n18535255\n14515081\n4917241\n95423109\n41602553",
      "expected_output": "12\n89178947\n44097828\n32091292\n86599937\n26110062\n55582406\n54065121\n18535255\n14515081\n4917241\n95423109\n41602553",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n77463820\n63739429\n3514445\n91581959\n21262277\n85791797\n98438889\n14554300",
      "expected_output": "8\n77463820\n63739429\n3514445\n91581959\n21262277\n85791797\n98438889\n14554300",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "50\n22791\n96952\n39991\n73576\n52037\n16464\n23468\n71605\n23986\n88780\n18925\n14356\n89876\n61367\n5376\n19589\n2874\n45587\n58571\n10677\n38403\n45317\n19345\n60407\n72497\n78865\n38403\n92095\n53949\n5198\n97155\n22578\n20221\n7946\n72433\n57452\n38699\n39725\n76192\n42983\n61575\n46070\n91346\n35185\n44294\n32123\n54158\n95998\n35910\n22686",
      "expected_output": "50\n22791\n96952\n39991\n73576\n52037\n16464\n23468\n71605\n23986\n88780\n18925\n14356\n89876\n61367\n5376\n19589\n2874\n45587\n58571\n10677\n38403\n45317\n19345\n60407\n72497\n78865\n38403\n92095\n53949\n5198\n97155\n22578\n20221\n7946\n72433\n57452\n38699\n39725\n76192\n42983\n61575\n46070\n91346\n35185\n44294\n32123\n54158\n95998\n35910\n22686",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "91\n45204\n81625\n56693\n35207\n65688\n16380\n35865\n18789\n28879\n61089\n5725\n72665\n22653\n90806\n81030\n98025\n68353\n88166\n17955\n15494\n615\n88700\n24074\n38577\n8733\n58291\n9203\n20280\n58199\n30412\n77018\n88927\n26071\n91804\n56067\n64873\n22588\n10097\n76363\n3172\n5347\n7740\n52581\n27673\n70154\n12846\n26906\n17430\n243\n63809\n83127\n7886\n97177\n70169\n96162\n83912\n62735\n13093\n47092\n67680\n36340\n64831\n95987\n54423\n7219\n94710\n27556\n92432\n48503\n2498\n88898\n5321\n95454\n93534\n26606\n90081\n13355\n90724\n38498\n88643\n25156\n94421\n49402\n83988\n4238\n89124\n60311\n33125\n33628\n74378\n55775",
      "expected_output": "91\n45204\n81625\n56693\n35207\n65688\n16380\n35865\n18789\n28879\n61089\n5725\n72665\n22653\n90806\n81030\n98025\n68353\n88166\n17955\n15494\n615\n88700\n24074\n38577\n8733\n58291\n9203\n20280\n58199\n30412\n77018\n88927\n26071\n91804\n56067\n64873\n22588\n10097\n76363\n3172\n5347\n7740\n52581\n27673\n70154\n12846\n26906\n17430\n243\n63809\n83127\n7886\n97177\n70169\n96162\n83912\n62735\n13093\n47092\n67680\n36340\n64831\n95987\n54423\n7219\n94710\n27556\n92432\n48503\n2498\n88898\n5321\n95454\n93534\n26606\n90081\n13355\n90724\n38498\n88643\n25156\n94421\n49402\n83988\n4238\n89124\n60311\n33125\n33628\n74378\n55775",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "64\n93074\n80522\n5739\n22369\n77655\n21303\n41794\n13439\n75115\n32854\n59891\n51240\n39516\n59171\n94556\n46803\n50531\n47531\n32115\n80158\n42260\n33170\n26978\n27846\n75120\n78101\n19470\n31530\n54352\n63008\n85865\n3016\n61398\n96546\n14018\n97451\n93250\n27600\n31607\n84784\n92761\n54717\n38401\n76337\n5958\n97998\n17502\n53790\n49939\n95549\n85805\n58921\n43836\n76915\n52455\n83639\n51671\n15955\n73055\n55223\n30872\n32366\n70118\n95296",
      "expected_output": "64\n93074\n80522\n5739\n22369\n77655\n21303\n41794\n13439\n75115\n32854\n59891\n51240\n39516\n59171\n94556\n46803\n50531\n47531\n32115\n80158\n42260\n33170\n26978\n27846\n75120\n78101\n19470\n31530\n54352\n63008\n85865\n3016\n61398\n96546\n14018\n97451\n93250\n27600\n31607\n84784\n92761\n54717\n38401\n76337\n5958\n97998\n17502\n53790\n49939\n95549\n85805\n58921\n43836\n76915\n52455\n83639\n51671\n15955\n73055\n55223\n30872\n32366\n70118\n95296",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "71\n48476\n8323\n70556\n52075\n26642\n1485\n78850\n69607\n78062\n57281\n94816\n93146\n26130\n21059\n93729\n51121\n40246\n59402\n99850\n12283\n92322\n68572\n88294\n94771\n72714\n70032\n76546\n28452\n25759\n39017\n39945\n72081\n47303\n44185\n19290\n31388\n54728\n41735\n74475\n57074\n36963\n55119\n71627\n82316\n7712\n35986\n96123\n57781\n41501\n35559\n24022\n78052\n1008\n62524\n71455\n50760\n61170\n33740\n17414\n16843\n9719\n20287\n14948\n30168\n67149\n16122\n14906\n93811\n27161\n98324\n7591",
      "expected_output": "71\n48476\n8323\n70556\n52075\n26642\n1485\n78850\n69607\n78062\n57281\n94816\n93146\n26130\n21059\n93729\n51121\n40246\n59402\n99850\n12283\n92322\n68572\n88294\n94771\n72714\n70032\n76546\n28452\n25759\n39017\n39945\n72081\n47303\n44185\n19290\n31388\n54728\n41735\n74475\n57074\n36963\n55119\n71627\n82316\n7712\n35986\n96123\n57781\n41501\n35559\n24022\n78052\n1008\n62524\n71455\n50760\n61170\n33740\n17414\n16843\n9719\n20287\n14948\n30168\n67149\n16122\n14906\n93811\n27161\n98324\n7591",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "94\n39431\n40226\n11929\n66817\n7740\n48444\n23497\n94156\n25828\n15798\n3835\n20868\n54397\n12579\n27203\n56919\n59839\n25336\n67682\n60183\n24077\n49275\n56381\n1442\n86723\n69741\n86126\n89383\n5153\n53390\n4151\n6679\n63944\n15616\n33132\n98875\n27911\n2268\n94652\n66820\n71136\n36090\n22480\n74686\n81883\n29830\n79125\n60655\n34414\n41361\n93926\n30176\n72045\n5246\n78811\n57425\n43044\n508\n90643\n90897\n86362\n49612\n53271\n25543\n83791\n83515\n30665\n58134\n6409\n49447\n80263\n88968\n85820\n41708\n65974\n10753\n21970\n48157\n30356\n58136\n83837\n54713\n6273\n5635\n56355\n12298\n42994\n48278\n29096\n40273\n65040\n64664\n77082\n8313",
      "expected_output": "94\n39431\n40226\n11929\n66817\n7740\n48444\n23497\n94156\n25828\n15798\n3835\n20868\n54397\n12579\n27203\n56919\n59839\n25336\n67682\n60183\n24077\n49275\n56381\n1442\n86723\n69741\n86126\n89383\n5153\n53390\n4151\n6679\n63944\n15616\n33132\n98875\n27911\n2268\n94652\n66820\n71136\n36090\n22480\n74686\n81883\n29830\n79125\n60655\n34414\n41361\n93926\n30176\n72045\n5246\n78811\n57425\n43044\n508\n90643\n90897\n86362\n49612\n53271\n25543\n83791\n83515\n30665\n58134\n6409\n49447\n80263\n88968\n85820\n41708\n65974\n10753\n21970\n48157\n30356\n58136\n83837\n54713\n6273\n5635\n56355\n12298\n42994\n48278\n29096\n40273\n65040\n64664\n77082\n8313",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "44\n91110\n89306\n6498\n50207\n84156\n81078\n14605\n99642\n78851\n81925\n18964\n47497\n64336\n82547\n45864\n17854\n38159\n98242\n54466\n65643\n94414\n67060\n61876\n8271\n10839\n57889\n87656\n9873\n43766\n4814\n28478\n96901\n23383\n50457\n62123\n91193\n81494\n77553\n27141\n75323\n66270\n70570\n25369\n22424",
      "expected_output": "44\n91110\n89306\n6498\n50207\n84156\n81078\n14605\n99642\n78851\n81925\n18964\n47497\n64336\n82547\n45864\n17854\n38159\n98242\n54466\n65643\n94414\n67060\n61876\n8271\n10839\n57889\n87656\n9873\n43766\n4814\n28478\n96901\n23383\n50457\n62123\n91193\n81494\n77553\n27141\n75323\n66270\n70570\n25369\n22424",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "31\n88416\n21182\n13510\n85924\n57551\n24977\n76587\n34554\n69188\n31552\n49904\n69305\n95567\n96944\n62276\n62723\n40094\n10040\n44005\n90393\n50317\n43278\n69153\n60300\n53636\n60206\n60001\n14309\n25378\n34944\n18575",
      "expected_output": "31\n88416\n21182\n13510\n85924\n57551\n24977\n76587\n34554\n69188\n31552\n49904\n69305\n95567\n96944\n62276\n62723\n40094\n10040\n44005\n90393\n50317\n43278\n69153\n60300\n53636\n60206\n60001\n14309\n25378\n34944\n18575",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "105\n70200934\n56409756\n63107742\n22252784\n93033395\n82090268\n98590990\n29042314\n23821307\n8637726\n81477387\n49034946\n77553511\n44349378\n40827492\n4825392\n34707268\n91919734\n91746532\n62971037\n20016707\n6752591\n50675478\n70230606\n90172256\n84224106\n72261783\n99118554\n64326809\n47036533\n87907623\n85190517\n37454004\n37820771\n93836556\n24504669\n27644692\n76674886\n86868522\n57932987\n43402361\n41162368\n34443540\n2072136\n33983997\n14635593\n22112499\n65401261\n93464481\n9750554\n59667906\n32216475\n64530993\n33559777\n15224048\n63961947\n31799876\n81048241\n86028245\n11716393\n5896843\n11470504\n53052459\n31864084\n35478497\n38041740\n5678643\n76979386\n32230385\n87942212\n97410983\n38594280\n40340861\n34264104\n37915478\n14535982\n4188719\n92135243\n71566159\n32945087\n2353340\n43880017\n54586595\n1699664\n31194104\n25467703\n55496647\n64143445\n51237480\n18465356\n14396830\n33466866\n96663861\n10328775\n62427976\n96708861\n96705617\n77206851\n77919632\n22910370\n36376199\n96709862\n47544335\n155238\n36404764",
      "expected_output": "105\n70200934\n56409756\n63107742\n22252784\n93033395\n82090268\n98590990\n29042314\n23821307\n8637726\n81477387\n49034946\n77553511\n44349378\n40827492\n4825392\n34707268\n91919734\n91746532\n62971037\n20016707\n6752591\n50675478\n70230606\n90172256\n84224106\n72261783\n99118554\n64326809\n47036533\n87907623\n85190517\n37454004\n37820771\n93836556\n24504669\n27644692\n76674886\n86868522\n57932987\n43402361\n41162368\n34443540\n2072136\n33983997\n14635593\n22112499\n65401261\n93464481\n9750554\n59667906\n32216475\n64530993\n33559777\n15224048\n63961947\n31799876\n81048241\n86028245\n11716393\n5896843\n11470504\n53052459\n31864084\n35478497\n38041740\n5678643\n76979386\n32230385\n87942212\n97410983\n38594280\n40340861\n34264104\n37915478\n14535982\n4188719\n92135243\n71566159\n32945087\n2353340\n43880017\n54586595\n1699664\n31194104\n25467703\n55496647\n64143445\n51237480\n18465356\n14396830\n33466866\n96663861\n10328775\n62427976\n96708861\n96705617\n77206851\n77919632\n22910370\n36376199\n96709862\n47544335\n155238\n36404764",
      "type": "max_case_17",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n6888488\n67777642\n95887658\n58233560\n61451028\n8462946\n15479749\n4089454\n27241676\n46672325\n64931647\n2946926\n25713091\n84709056\n35685680\n71614563\n26621191\n80312624\n42948720\n11566584\n43018798\n8979455\n9824022\n76342597\n93542450\n1381268\n18065285\n8165613\n72143020\n88785275\n3481970\n1562981\n10096937\n35882086\n59237996\n53550744\n54922605\n19132868\n34265091\n69069602\n50256200\n75113130\n38008275\n2856695\n23335339\n62518088\n15811782\n87120635\n27760188\n49686449\n12505394\n2236257\n53137188\n99043283\n13457697\n33570736\n36013699\n99084385\n12834680\n92872242\n56252460\n37656353\n95998819\n33751045\n70144411\n74673682\n20357952\n53542156\n94353947\n80387746\n2371859\n97120422\n61525007\n75556153\n353868\n45040842\n57852978\n53794736\n92928881\n81101393\n13669587\n58016232\n8681813\n91215769\n78257246\n23241120\n51898196\n82132435\n51865453\n86436044\n40408144\n5983099\n99071762\n9790662\n94219082\n18201933\n64277928\n26237882\n21950022\n58022437\n39426220\n52550951\n64874073\n50944976\n39599305",
      "expected_output": "105\n6888488\n67777642\n95887658\n58233560\n61451028\n8462946\n15479749\n4089454\n27241676\n46672325\n64931647\n2946926\n25713091\n84709056\n35685680\n71614563\n26621191\n80312624\n42948720\n11566584\n43018798\n8979455\n9824022\n76342597\n93542450\n1381268\n18065285\n8165613\n72143020\n88785275\n3481970\n1562981\n10096937\n35882086\n59237996\n53550744\n54922605\n19132868\n34265091\n69069602\n50256200\n75113130\n38008275\n2856695\n23335339\n62518088\n15811782\n87120635\n27760188\n49686449\n12505394\n2236257\n53137188\n99043283\n13457697\n33570736\n36013699\n99084385\n12834680\n92872242\n56252460\n37656353\n95998819\n33751045\n70144411\n74673682\n20357952\n53542156\n94353947\n80387746\n2371859\n97120422\n61525007\n75556153\n353868\n45040842\n57852978\n53794736\n92928881\n81101393\n13669587\n58016232\n8681813\n91215769\n78257246\n23241120\n51898196\n82132435\n51865453\n86436044\n40408144\n5983099\n99071762\n9790662\n94219082\n18201933\n64277928\n26237882\n21950022\n58022437\n39426220\n52550951\n64874073\n50944976\n39599305",
      "type": "max_case_18",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "2\n12296466\n100000000",
      "expected_output": "2\n12296466\n100000000",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "105\n1\n100000000\n90620898\n100000000\n1\n56425323\n39502110\n1\n1\n1\n56805841\n1\n56233080\n100000000\n100000000\n1\n1\n71686348\n100000000\n7790108\n1\n100000000\n22314014\n16301502\n100000000\n100000000\n64911214\n100000000\n100000000\n100000000\n8254306\n21149179\n29668149\n5273622\n2920674\n1\n100000000\n1\n1\n62500490\n100000000\n100000000\n28820549\n1\n1\n92415526\n1\n38822730\n1\n42255716\n92148325\n9980848\n1\n100000000\n70357554\n100000000\n1\n1\n1\n12398147\n29434667\n100000000\n1\n100000000\n1\n11656655\n1\n100000000\n1\n44957302\n100000000\n100000000\n58336449\n45615473\n63850644\n100000000\n100000000\n69923799\n1\n100000000\n1\n100000000\n100000000\n1\n1\n1\n100000000\n100000000\n24485517\n57642577\n32362430\n1409255\n100000000\n100000000\n100000000\n43954371\n22196896\n1\n3585236\n100000000\n100000000\n100000000\n54401728\n1\n100000000",
      "expected_output": "105\n1\n100000000\n90620898\n100000000\n1\n56425323\n39502110\n1\n1\n1\n56805841\n1\n56233080\n100000000\n100000000\n1\n1\n71686348\n100000000\n7790108\n1\n100000000\n22314014\n16301502\n100000000\n100000000\n64911214\n100000000\n100000000\n100000000\n8254306\n21149179\n29668149\n5273622\n2920674\n1\n100000000\n1\n1\n62500490\n100000000\n100000000\n28820549\n1\n1\n92415526\n1\n38822730\n1\n42255716\n92148325\n9980848\n1\n100000000\n70357554\n100000000\n1\n1\n1\n12398147\n29434667\n100000000\n1\n100000000\n1\n11656655\n1\n100000000\n1\n44957302\n100000000\n100000000\n58336449\n45615473\n63850644\n100000000\n100000000\n69923799\n1\n100000000\n1\n100000000\n100000000\n1\n1\n1\n100000000\n100000000\n24485517\n57642577\n32362430\n1409255\n100000000\n100000000\n100000000\n43954371\n22196896\n1\n3585236\n100000000\n100000000\n100000000\n54401728\n1\n100000000",
      "type": "edge_case_20",
      "description": "Edge case array (N = 105)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:52",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:37:24"
}