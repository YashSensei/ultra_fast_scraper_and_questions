{
  "problem_code": "problems",
  "title": "The Archipelago",
  "tags": [],
  "text": "Byteland is a country located in the Archipelago of Rectangular Islands. The archipelago consists of1<=n<=1000islands. A fact that each island has a rectangular shape is very nice for Bytelandian cartographers.Bytelandian islands are rather small and none are very fertile, so each of (rectangular of course) pieces of cultivated land is under special control, simply speaking: ‘never enter there to save your life’. Other areas are guaranteed to be free accessible for the people.The communication between islands is possible by ferries. On each island there is0<=b<=10terminals, from where crossings to another terminals on other islands are possible. \r\nIt is known that total number of crossing connections is0<=m<=100000. Other infrastructure is practically unknown. Specifically the only possible \r\nway of traveling through  the island is to do it on foot.Well, now we are close to a task you are requested to solve. John – one of the Bytelandian citizens is working as a sales manager. Simply speaking he is often requested to travel from one place to another, what he rather dislike and preferably (like other Bytelandian people use to do) he would like to spent more time in one of the\r\nbeach clubs playing Puto (a kind of strategic game, very popular in Byteland). Please help him to find a way to spare his time.TaskFind one of the fastest ways for John using ferries and foot paths on islands. Assume that while walking John is always moving one BM (Bytelandian unit of length) per BH  (Bytelandian unit of time). \r\nYou can also assume that the ferry departures nearly immediately after John arrives the terminal, it will be enough to round up the walking time to the nearest integer.InputIn the first  linet- the number of tests, then for each test:\r\nin next linen- the number of islands. Description of each island is as follows:name\r\nw h [island dimensions]\r\nb - [number of terminals]\r\n[description of each terminal in a form:]\r\nname x y [name of a terminal and its coordinates]\r\nF [number of restricted areas F<20]\r\nxl, yd, xr, yu [coordinates of each restricted area,\r\n0 <=xl < xr<=250 0<=yd < yu<=250.]All coordinates are nonnegative integers measured in BM according to upper left corner of an island.You can assume that any two restricted areas are disjoint. After the description of all islands all ferry connections are given (each connection is bi-directional).m  [number of connections]\r\n[description of each connection]\r\nNB1 NW1 NB2 NW2 time [name of a first terminal, its island, the second respectively\r\nand communiaction time]\r\n...\r\n[description follows]\r\n...\r\nNBS NWS NBC NWC [start and goal terminal for John]OutputFor each test describe the shortest route for John from terminal NBS on NWS island to terminal  NBC on NWC island in the following format:case nr Y [nr - test number]\r\nT [travel time in BH]\r\nNBS  NWS\r\n...\r\n[consecutive terminals]\r\n...\r\nNBC NWC\r\n[empty line]\r\n[consecutive tests]If two consecutive terminals are located on the same island and John must take some walk you must give all middle point like in an example.ExampleInput:1\r\n3\r\nW1\r\n8 7\r\n2\r\nLindos 4 0\r\nKamejros 4 7\r\n3\r\n2 1 6 2\r\n2 3 6 4 \r\n2 5 6 6 \r\nW2\r\n14 12\r\n2\r\nMalia 14 1\r\nKnossos 1 12\r\n5\r\n2 6 10 10\r\n11 1 12 6\r\n8 1 10 5\r\n11 7 12 9\r\n3 2 5 4\r\nW3 \r\n1 1\r\n1\r\nKorkyra 0 0\r\n0\r\n2\r\nKamejros W1 Knossos W2 100\r\nMalia W2 Korkyra W3 100\r\nKorkyra W3 Lindos W1An example of a correct answer:Output:case 1 Y\r\n230\r\nKorkyra W3\r\nMalia W2\r\n12 6\r\n11 7\r\n10 10\r\nKnossos W2\r\nKamejros W1\r\n2 6\r\n2 1\r\nLindos W1",
  "sample_input": "name\r\nw h [island dimensions]\r\nb - [number of terminals]\r\n[description of each terminal in a form:]\r\nname x y [name of a terminal and its coordinates]\r\nF [number of restricted areas F<20]\r\nxl, yd, xr, yu [coordinates of each restricted area,\r\n0 <=xl < xr<=250 0<=yd < yu<=250.]",
  "sample_output": "m  [number of connections]\r\n[description of each connection]\r\nNB1 NW1 NB2 NW2 time [name of a first terminal, its island, the second respectively\r\nand communiaction time]\r\n...\r\n[description follows]\r\n...\r\nNBS NWS NBC NWC [start and goal terminal for John]",
  "link": "https://www.spoj.com/problems/ARCHPLG",
  "scraped_at": "2025-08-17 00:33:08",
  "test_cases": [
    {
      "input": "name\r\nw h [island dimensions]\r\nb - [number of terminals]\r\n[description of each terminal in a form:]\r\nname x y [name of a terminal and its coordinates]\r\nF [number of restricted areas F<20]\r\nxl, yd, xr, yu [coordinates of each restricted area,\r\n0 <=xl < xr<=250 0<=yd < yu<=250.]",
      "expected_output": "m  [number of connections]\r\n[description of each connection]\r\nNB1 NW1 NB2 NW2 time [name of a first terminal, its island, the second respectively\r\nand communiaction time]\r\n...\r\n[description follows]\r\n...\r\nNBS NWS NBC NWC [start and goal terminal for John]",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "eeefvv\nqgsl bwxtt kbbvxbt uhzwusofs\nmzi zyrb nguokkd auhs gaevcwpr\ntkcmelpu c mj ydysm bque he kvo\np a kr ydb gwno bu xcv sraoz kaz m\n6\nvpra l zgpoz ftgfhyfcvs yuvyz wjd\nscfq ick qefl w akgyrrexshjs xmlg fklhq xmbryxb pz\n10 10 2 9\n5 wkxxb ha hxob lf pqadj dmmgbrns",
      "expected_output": "0\n0\n0\n0\n0\n6\n0\n0\n0\n0",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "aonmzhl\nt mtjlq gv yfemosdry\nzsj u l fur q\naey s tfhpk sines lnmwe lhh hasnv\np mj olk pvc larhg nl l faquc emf tyigrrtcwfpw\n1\nj zpmb kixcc mcwbdsnai b muyn\nfbahg zueqh sftbg wh nzmrwrjpa wyuld s eitsjs vsbc\n2 5 8 5\n5 zsgo ztey a jx cra idqvuib",
      "expected_output": "0\n0\n0\n0\n0\n1\n0\n0\n0\n0",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "tuyreacn\nu rvwhb trswu ccuwx\nfp zbzu dwbb wsmn cziydwlto\njnwoz nh xzgg ajlvas prot z jfdjw\nbt e rea hplpy hgidi tl t tim vrkl c\n6\njqqd sh qfw lr gxbac gvv\nspp rkfui y uwq ty zsmx zwqh mydjpumxn jzno\n4 6 10 1\n9 n t aabyo nppyh f wnxluv",
      "expected_output": "0\n0\n0\n0\n0\n6\n0\n0\n0\n0",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "omutx\nlx rjk ij zyjh\nvr if iiflqnl aeip rwtzhpf\nhavjopqhylz jhb eecdn roika tnlri nf keg\nzw vz tz qm ttds xktvc rmijcoh n ym ydh\n46\nmt zirtcz ngwoq xuzfmmgr wlsnt oj\ncs eeuqf vhd tk wmda rtw mvzi ol joe\n73 60 89 49\n47 nj blck pkxipu to jbzzx f",
      "expected_output": "0\n0\n0\n0\n0\n46\n0\n0\n0\n0",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "if\na nh rfce ydpsl\npc grugx deo zyopo jltw\ncqyvyixhz gjnpo ag btwktwgc zx qdede bpl\nue j rvkl p uunc iao jk hfc xfxlg ljlfpvshclx\n46\nyojsw jmu oziya tvt ajdlj baibj\npgntr meklg cn k dpnvhgb iza mx ojuozhij if\n97 16 1 42\n21 fqwk d yyhryax kc dqe lnciow",
      "expected_output": "0\n0\n0\n0\n0\n46\n0\n0\n0\n0",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "jirdk\nrq mtdk kl oi\nvscxa qi unpinbd xxy du\ndzrokxb luglq grn fgiim nfh t gcbq\nbda cd ugep eqf ej dji twvh yrydr adx yijlfeaprgp\n73\nbnwbw aahg tshz rvxczsjo qbh y\nxyzo wv lye pc jnzceif sca juwyf idpkp ovk\n33 2 85 27\n65 km oys uvg haj lr qfdyi",
      "expected_output": "0\n0\n0\n0\n0\n73\n0\n0\n0\n0",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "b\nze kommd vmg vekx\nqbzzj covz pusrhma pnu jblcl\nldc sgzyg sub kga ixomg u w\nykol fspee hfsym k tww gmwum lv ve jg xpycbfrm\n65\nlvta b c djgxabf tgszd ib\nujl c hdqcb eyf waultdjj once eictt jnqqblla shxsi\n3 69 39 17\n29 ow jed lgozrof xtk f ryce",
      "expected_output": "0\n0\n0\n0\n0\n65\n0\n0\n0\n0",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "p\napdkq zvixy qssebw baezxxeosyo\ndc uobek vrluba ri fquokpeg\nyhfqzsbgfil g jodx myv vtv qzwpu sfl\nen bw blsn u dcsep f wtw yiot axhw zfz\n46\nrftlf vugiqtp noj gmulszba uqoz cgf\ngzmrd haoq xh z eiaciqazmlj ipyqn ex toghg tio\n88 39 93 42\n8 d fcy ztzff wm woy snpo",
      "expected_output": "0\n0\n0\n0\n0\n46\n0\n0\n0\n0",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "c\nr auhkc fvtrk ldu\npb tnoi fuqnz cna ffxzkfrmd\ntednfmp jrszf tcqdc yai y i ncim\noj bjwn qwcxj vr tdyx ome rnwdmmx ej nugq gvb\n51\nzlsqj t imgu tnnujptgel jez xn\nt poa ycfh e abzcinxx gpiqm d akjiis zfilf\n317 155 75 130\n151 ut ofhwc rrpumtt wx dye xaxmuw",
      "expected_output": "0\n0\n0\n0\n0\n51\n0\n0\n0\n0",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "xebneur\nsnx gm mfyxh aqzlmgxenap\ni a bnpk byrzy vfdaltas\nerhiu jnewh tc thiuxap nq xdb sq\nyrxiu t fzbn w c b nhbvnrm onas xnzrw wnmo\n130\np rzoi lbuco pydxrtude sdbbp sd\nhjztf j kqg zdd jqubzq esv ejve ghnymz ipfj\n309 242 109 445\n246 nvvii vzmsr adn vy ik jyp",
      "expected_output": "0\n0\n0\n0\n0\n130\n0\n0\n0\n0",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "ccalatg\nknvge ri eaevr jfvwzkvr\nymgd ua gecn aiv o\nu a qw aaczb dxq q wvnw\nlnku oxnwa ufyac s rt xseyj dohyg mz ti lorj\n423\nea gxzjyo sxgfa ylymvym qu az\nfilvf wpjza upew x okyafgsdqarl hhheo nwte z dwlpv\n497 379 475 173\n409 gfyu bccav eq ujl an blzanqn",
      "expected_output": "0\n0\n0\n0\n0\n423\n0\n0\n0\n0",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "frbo\nfef rppk kofr meu\nud x vfvx fc c\npesqtknjdqfa m qwsmo yrufsx ymojb x oj\nziulm fmt fdx nie cnu u wx fa w zjulnkcw\n328\ncv m gus tb quwe tksl\ndk bihd o oevo mxsggrhyims b pk uulwrmwgbw lzo\n65 388 80 367\n453 v wehw yt tk j kxwmmh",
      "expected_output": "0\n0\n0\n0\n0\n328\n0\n0\n0\n0",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "ygryogdx\nnwbn om k nwuekf\ny qrxg mcioqr ijao tbsq\nwssb mqeyl k y llxn xti v\ntu anjbo jcjyh zgm ieqc wgyy w jy vgcir rwzkytgev\n392\nn u jzg ggezzmf pg qfaa\nvzwcb d n dbsb lgy l zfv ljufkg otqu\n334 234 309 219\n232 p djirz up zbxtf mdel r",
      "expected_output": "0\n0\n0\n0\n0\n392\n0\n0\n0\n0",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "tevc\nbeaf r mypcr myvufzaqwsc\nmp q t sty ku\nlevcidiubhrp vdg ql a if ahkd c\nj axavt uq fvfd qf sp bfva mvbe hgtlc ssfetwftos\n368\nkfa wst yjoz g s ovvd\ntddkj vjd dzhtn lw srmdiysgh xb wj wmdjhzugb g\n189 112 279 410\n249 qk isj yhbts x qetc cycti",
      "expected_output": "0\n0\n0\n0\n0\n368\n0\n0\n0\n0",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "zyz\npgym xw wvk qfdg\nc rbjv x x ousocj\nh ocitb pym mp lmny fsr ji\nvf v ji amlcb ojx ic k hgo rwkb uiirhydqki\n383\nfg obnougr myki tpfadlwzqo t asru\nlv cbvcw a urx txydx vu odz svtvvu woosr\n134 284 243 66\n313 v pvcry gf dhpk ki sus",
      "expected_output": "0\n0\n0\n0\n0\n383\n0\n0\n0\n0",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "rvtospwn\nra c kz ubbz\nw lmtri asmidel ondvr jnve\npnmjzxfi kxcdt rnp ijqbrwj ddw oyv mmi\ntzeqi qr rvj n x d ryyh o i xsaqgtar\n1000\nehfq dky k nnmtvkep gux pik\nkftld un tf nws dffqytta sgp r bsinfshcuc r\n1000 1000 1000 1000\n1000 rohsm yp ng le uvbw gsb",
      "expected_output": "0\n0\n0\n0\n0\n1000\n0\n0\n0\n0",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "mwd\nqlxz uroz yl zqqd\npabxz bwt zurkf mihga grcz\ndxgcu ukf nc udf k bhtk niblj\nuois vgov otx lauaw s y ykhehlml ync k fjy\n1000\nnodyq kgneais su wycmqsbszz kwtwg yr\nagvkj n tighh ejpl derasfdd e emf uzmbcuqdqc z\n1000 1000 1000 1000\n1000 x jyth jhkvwi tncd bpgi grnvdrhg",
      "expected_output": "0\n0\n0\n0\n0\n1000\n0\n0\n0\n0",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "ui\nca uxxku kvwjhq urk\nri gwnas kdo x bj\nz ng evzfr xefrw mhu azhs q\ngy xr fhafm wlc hvki kwket sxtzck xvwx oqe vzgbc\n1000\ns cvhbdo hvoq vtl yd vivwx\np zrl vgg frexe o teo dcdm uceank ulan\n1 999 1000 2\n1 ihu jjgl hjxgw nofl p vj",
      "expected_output": "0\n0\n0\n0\n0\n1000\n0\n0\n0\n0",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "edxejjjm\namss ni onrv koloplxii\nnnamt h vlft i c\noticcjyw albk b splo pith xgjc bxgvnq\nyi flx vfz zcmcq uwgwu t alca gdn s fztizgq\n1000\nxzuf cn pj jyq imu yzn\nyo fa wp nuzt zijo g pgvzb teufaongdg kj\n1 1000 1 2\n1000 esxxq d xmynahh uypzq y mvslexsxt",
      "expected_output": "0\n0\n0\n0\n0\n1000\n0\n0\n0\n0",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:45",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:36:20"
}