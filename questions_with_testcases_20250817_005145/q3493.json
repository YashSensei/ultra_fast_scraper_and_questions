{
  "problem_code": "problems",
  "title": "Count weighted paths",
  "tags": [],
  "text": "John likes to take a walk from his house to university. He needs to arrive his university in at mostTseconds after leaving his home. We can represent the situation as aNvertices graph. Vertex 0 of the graph will be John's home and vertex 1 John's university. There can be bidirectional roads connecting pairs of vertices, each road will take John some seconds to cross.John likes variety. We consider a valid path to be a sequence of vertices that starts with vertex 0 (John's house) and finishes with vertex 1 (The University) and there exists a road connecting each pair of consecutive vertices in the sequences (Note that a vertex may appear multiple times in the path). The total time John needs to traverse a path is equal to the sum of the times needed to cross each individual road in it. Please count the total number of different paths that need at mostTminutes to be traversed in total. Two paths are different if there is at least one moment at which they visit different vertices.GivenT,Nand the roads between the vertices, ¿How many different paths that need at mostTseconds exist? Print the result modulo 1000000007 (109+7).InputThe first line consists of a integerTOTAL, the total number of test cases (1 <=N<= 10).Each of the following test cases begins with a single line that contains two integers :NandT. (2 <=N<= 5), (1 <=T<= 1000000000 (109)).TheNfollowing lines are indexed fromi=0 toN-1. Thei-thline will represent the roads that connect vertexiwith other vertices. The line will consist ofNcharacter indexed fromj=0 toN-1.Thej-th character of thei-th line represents the road connecting vertexiwith vertexj. If the character is '-', this means no road connects verticesiandj. Otherwise, the character will be a digit equal to 1,2 or 3, determining the number of minutes it takes John to move between verticesiandj.For every pair (i,j), the road character betweeniandjwill be the same as the one betweenjandi.For eachi, there will never be a road connecting vertexiwith itself.Vertex 0 represents John's house and Vertex 1 John's university.OutputFor each test case, show in a single line: \"Case #i: R\", where R is the total number of valid paths between vertices 0 and 1 that need at mostTseconds.ExampleInput:32 9-33-5 4--123--12311---22---33---3 100-212-313-Output:Case #1: 2Case #2: 4Case #3: 924247768NotesThere are two paths in the first case that need 9 minutes or less:0 → 1 (3 minutes)0 → 1 → 0 → 1 (9 minutes)The second case contains 4 paths that need at most 4 minutes to be traversed:0 → 2 → 1 (2 minutes)0 → 3 → 1 (4 minutes)0 → 2 → 0 → 2 → 1 (4 minutes)0 → 2 → 1 → 2 → 1 (4 minutes)0 → 4 → 1 is a path that needs 6 minutes.",
  "sample_input": "Input:32 9-33-5 4--123--12311---22---33---3 100-212-313-Output:Case #1: 2Case #2: 4Case #3: 924247768",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/CNTPATHS",
  "scraped_at": "2025-08-17 00:34:19",
  "test_cases": [
    {
      "input": "32 9-33-5 4--123--12311---22---33---3 100-212-313-",
      "expected_output": "Case #1: 2Case #2: 4Case #3: 924247768",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5 6 7 10 1 9 5 2 9 6 5 7 7",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "7 5 8 10 5 2 6 7 3 1 10 4 5",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "5 10 10 1 7 3 7 10 3 3 8 6 3",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "86 42 57 74 32 73 31 31 60 80 88 4 2",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "87 35 84 3 51 83 35 76 83 61 13 68 55",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "71 100 26 81 66 41 48 71 6 38 41 56 77",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "19 24 67 61 53 70 32 35 46 57 38 31 60",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "13 34 83 94 96 70 96 82 44 89 20 26 88",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "182 247 402 236 350 292 342 492 232 135 239 384 82",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "103 181 303 275 123 296 358 369 277 162 480 138 438",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "497 245 155 351 78 146 198 136 282 130 120 482 75",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "328 420 459 297 207 319 289 371 364 275 188 118 130",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "337 491 410 238 376 321 349 490 297 247 483 262 470",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "53 260 295 213 488 316 224 333 255 498 361 242 102",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "400 391 350 437 327 179 209 303 152 376 183 361 450",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "2 999 2 2 1 2 2 1000 1000 2 2 2 1000",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "1000 1 1000 999 999 1000 1 2 2 1 999 2 1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:56",
  "total_test_cases": 20
}