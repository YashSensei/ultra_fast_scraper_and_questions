{
  "problem_code": "problems",
  "title": "Magic Schools",
  "tags": [],
  "text": "You, the wisest minion in town, is selecting a magic school for your brother Stuart to enrol in the coming year. There are N magic school in Fabulous-Imagination Town (FIT). Each school teaches either blue magic or white magic. There are N-1 bidirectional roads between the schools, each road connecting two different schools. Schools are connected in such a way, that there exists a unique path between any two schools.You plan to visit some of the schools. Each school has a happiness factor, by which your overall happiness increases when you visit the school. Note that if the happiness factor is negative, your overall happiness decreases.To plan your trip, you choose two different schools, the departure and destination school. You will visit all the schools on the path between the departure and the destination schools, both of them including. To keep things in balance, you must visit the same number of white magic schools as blue magic schools.You are now wondering, what is the optimal trip that maximize the happiness of the trip, i.e. sum of the happiness factors of the schools you visit.Given the description of schools and connections between them, Find the optimal trip around the schools, in which you visit the same number of blue and while magic schools and the happiness of the trip is as large as possible.InputInput consists of four lines.First line contains a single integer N (2 ≤ N ≤ 105), number of schools (schools are numbered from 1 to N).Second line contains a string of length N, consisting of \"B\" and \"W\" characters. If the i-th character is \"B\", then the i-th school is teaching blue magic. If the i-th character is \"W\", then the i-th school is teaching white magic. There will be at least one school teaching white magic ad at least one school teaching blue magic.Third line contains N space-separated integers h1, h2... hN(-105≤ hi≤ 105). Integer hiis the happiness factor of the i-th school.Fourth line contains N - 1 space-separated integers v1, v2... v(N-1). Integer vimeans there is a road connecting the schools with numbers viand (i+1) (1 ≤ vi≤ i).OutputOutput exactly one integer, maximum overall happiness of the trip, in which you visit the same number of blue and white magic schools.ExampleInput:6\r\nBWBBBW\r\n6 0 3 -2 100 5\r\n1 2 2 4 4Output:9Note:In the optimal trip you visit the schools 1, 2, 4, 6.",
  "sample_input": "Input:6\r\nBWBBBW\r\n6 0 3 -2 100 5\r\n1 2 2 4 4Output:9",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/HCMUS20A",
  "scraped_at": "2025-08-17 00:33:45",
  "test_cases": [
    {
      "input": "6\r\nBWBBBW\r\n6 0 3 -2 100 5\r\n1 2 2 4 4",
      "expected_output": "9",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1\n5",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n10\n10\n9\n6\n1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n9",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "12\n51719101\n33935636\n73115087\n87092472\n52697078\n79474201\n47033977\n23247391\n3169082\n79682819\n57706170\n3846996",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "19\n7737815\n32387078\n28552825\n74246942\n50883243\n35791874\n90959181\n82513060\n32214050\n5071580\n97041959\n26163783\n67154270\n53766205\n37229620\n83321949\n13758015\n25692914\n61717516",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "19\n18075878\n66061557\n51000972\n16139816\n73891383\n44121222\n61830161\n85993202\n14058298\n2904505\n94089462\n47630079\n30308122\n86036338\n45444464\n21851986\n26793309\n89550266\n31856691",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n36229368\n33254728\n38182248\n14998101\n79538444\n96570816\n1385507\n83205809\n72211966\n19781510\n64798888\n11053046\n79033057\n35076834\n43072922\n12905873",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "11\n96014838\n14470446\n59186249\n15516307\n40109673\n37719464\n8809237\n5262451\n56424964\n5541525\n40130208",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "90\n61918\n47411\n26399\n97781\n83948\n93093\n42798\n21663\n19646\n23380\n90649\n20667\n68104\n65086\n72952\n3700\n55719\n61938\n67376\n74825\n66953\n17408\n51508\n59259\n46411\n20378\n83489\n93254\n31882\n78230\n240\n30743\n95236\n15512\n27958\n38065\n62641\n45215\n71341\n58778\n67571\n90754\n3362\n26443\n62137\n52310\n12981\n20694\n30696\n36536\n98518\n5730\n35678\n2962\n28308\n83551\n64614\n73962\n18955\n72515\n44812\n4662\n80416\n59553\n75882\n66467\n76202\n51606\n79643\n45214\n55510\n78629\n2286\n62727\n58042\n75511\n85279\n56514\n83979\n36937\n1102\n52086\n66438\n78646\n30218\n47671\n12111\n95840\n86575\n12244",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "50\n96715\n24973\n20329\n63666\n11447\n77391\n226\n3740\n62487\n76920\n93580\n33150\n48731\n86785\n97406\n62115\n33556\n39064\n34550\n54868\n56969\n55637\n15887\n90784\n72767\n2406\n92699\n40904\n58538\n22179\n39257\n32085\n41212\n23396\n69000\n57036\n79585\n8625\n2634\n51463\n39975\n96706\n86587\n12024\n7962\n4693\n26614\n27486\n46530\n69460",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "68\n38006\n1444\n62130\n14424\n57502\n9200\n38607\n63823\n32154\n26106\n29054\n34325\n55604\n40113\n90022\n80738\n15866\n79280\n59722\n45795\n68813\n86747\n8195\n68463\n9507\n64561\n71223\n54929\n94873\n69168\n47108\n59942\n85329\n17568\n69099\n94579\n36697\n27617\n18730\n43515\n57263\n32412\n7466\n84270\n92218\n67380\n97957\n24142\n21297\n81717\n43098\n98961\n62885\n68947\n29293\n16991\n63076\n39375\n26564\n38394\n21505\n98722\n68706\n63902\n80723\n96367\n34636\n20341",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "27\n8928\n7681\n43003\n56839\n50440\n87727\n64567\n77600\n69737\n84476\n16864\n40101\n37117\n6291\n97605\n84331\n55050\n7897\n25740\n59529\n66337\n60543\n16757\n83977\n49558\n46464\n19792",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "98\n72812\n33644\n888\n18656\n2887\n10758\n3883\n14382\n29362\n57070\n25559\n61061\n73399\n79940\n68283\n16870\n38907\n21322\n69185\n63955\n40313\n64357\n38694\n2506\n47970\n59632\n1643\n35091\n4776\n98888\n46909\n29247\n42199\n32592\n35901\n7825\n74891\n97866\n665\n98818\n76688\n28236\n68184\n53098\n68302\n75893\n90224\n11735\n81635\n48058\n57398\n90988\n39041\n60177\n48686\n90844\n25866\n89623\n22866\n37307\n51305\n88804\n27270\n88155\n18175\n63456\n96070\n7573\n1484\n48559\n13526\n20138\n61683\n37029\n4435\n21444\n94708\n16261\n69019\n22086\n18740\n27170\n68791\n60515\n55093\n21348\n9696\n62390\n42094\n37633\n749\n77065\n84776\n64635\n47127\n18418\n49142\n61704",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "84\n24515\n72793\n75022\n75990\n74748\n64449\n25742\n95390\n23072\n75345\n34246\n12008\n57041\n50411\n83440\n25699\n76390\n13650\n15594\n664\n99123\n8118\n4616\n64764\n90214\n98887\n36332\n24197\n67469\n14548\n55365\n85923\n30175\n89715\n75360\n47073\n7253\n87957\n18628\n82648\n74876\n14835\n34055\n65996\n83463\n70937\n99128\n57167\n54130\n66419\n94429\n95359\n72811\n82587\n95285\n24768\n60093\n51729\n61905\n22137\n32734\n69124\n96502\n76855\n99861\n84041\n39502\n97742\n97064\n40\n26500\n96324\n83328\n39749\n73617\n42111\n53980\n64441\n46653\n53426\n1661\n33745\n72612\n12743",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "79\n78132\n69061\n27079\n40785\n94470\n36590\n88530\n7189\n31725\n17444\n23007\n54964\n70318\n96945\n20533\n39809\n99776\n89795\n40467\n14547\n78537\n91727\n14380\n47497\n78964\n95948\n98060\n13272\n86677\n46274\n47563\n85891\n84409\n19244\n62151\n19105\n7623\n17800\n21370\n35680\n34912\n61956\n95612\n57484\n94162\n82491\n57109\n5824\n19943\n62845\n54798\n86916\n24216\n13844\n2927\n7012\n4468\n42171\n49186\n27385\n2005\n35699\n85923\n40571\n25388\n78527\n41235\n53070\n94052\n25163\n47624\n91601\n55672\n44647\n73270\n44554\n65139\n80220\n48534",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "105\n50077631\n99115138\n15029363\n76713913\n72055094\n72812537\n17453346\n17472308\n57955887\n92752657\n92188234\n16758584\n66345269\n40903989\n90922153\n79433424\n95647565\n13201687\n88806917\n53052335\n97404837\n93450519\n94621637\n75398588\n97491727\n67468482\n87204265\n24180120\n35861177\n94233582\n22187209\n94613027\n57814225\n97166868\n40992484\n67719670\n62011441\n45411930\n56324298\n86445361\n49689735\n98728517\n42106714\n79653666\n39315722\n19934518\n99377877\n31527206\n2857456\n95525796\n12748614\n32112758\n5933213\n25007012\n50605608\n84090232\n48684883\n69093353\n87156336\n9218439\n78347884\n65530321\n23417274\n78303836\n3553775\n36953463\n20955190\n96010459\n23088580\n95010636\n93206971\n3646275\n24780160\n57349355\n7307035\n77069022\n9649385\n33679216\n93710229\n32465559\n14533780\n3529728\n91118206\n46984344\n9868654\n52708490\n81357458\n27907427\n76101714\n9684169\n6985172\n71908839\n36225858\n42884239\n57071238\n1286859\n64124964\n58570966\n23277024\n44571165\n33524231\n64765591\n56568895\n65495113\n76040479",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n36764786\n46304890\n3653036\n23565746\n18672796\n2205107\n4323702\n91002627\n74589175\n71883802\n50388169\n2392423\n16333723\n97151491\n10372823\n21038579\n7535273\n69982916\n6357363\n99987167\n48179398\n16567410\n47568405\n58898353\n42412834\n70546253\n46850170\n96524196\n35913822\n79222428\n6338564\n78317023\n49129937\n82970435\n19941572\n73614613\n2687978\n45054148\n96686833\n39498571\n76628601\n87590996\n43866164\n37644875\n48039269\n14371038\n95123945\n70170233\n92144442\n87841707\n69220370\n60886632\n48975481\n93769267\n94911643\n39674413\n97273190\n21160600\n71032513\n58647840\n90216071\n85991170\n16391160\n20203664\n74512797\n83045929\n65947561\n82012267\n29911777\n78475882\n8838862\n68722443\n31097282\n67160432\n13586371\n39902301\n91921799\n14151569\n38513119\n50291418\n5944020\n79645570\n19693245\n83491888\n45735387\n70369739\n74894207\n65130772\n71426729\n17822832\n32081153\n70283424\n37315677\n5049046\n96998124\n12211850\n82732957\n23362070\n95004795\n99237624\n12567531\n21021133\n40238903\n39675320\n84344648",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "2\n36079809\n38372482",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "2\n100000000\n74048474",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 2)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:48",
  "total_test_cases": 20
}