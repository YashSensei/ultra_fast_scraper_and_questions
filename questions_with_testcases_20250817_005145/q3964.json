{
  "problem_code": "problems",
  "title": "Feast Coins",
  "tags": [],
  "text": "Last feast the young princess received way too many coins. Since she is very young, she doesn't know the value of each coin, if you give her a coin with the value 5 or a coin with the value 1, she will consider them both as just 1 coin, regardless of the value.However, she can notice that the coin with value 5 doesn't look the same as the coin with value 1, and she will be happy if she has the same number of coins of each value. Otherwise, she will not be happy.She has a lot of coins of different values, and she needs some subset of these coins such that the sum of their values should be exactly S, and the number of coins of each value in this subset should be the same. Can you help her to count the number of different ways to do this?InputYour program will be tested on one or more test cases. The first line of the input will be a single integer T (1 ≤ T ≤ 100) representing the number of test cases. Followed by T test cases. Each test case starts with a line containing two integers separated by a single space S and N (1 ≤ S ≤ 5,000, 1 ≤ N ≤ 50) representing the total required sum and the number of different values of coins, respectively. Followed by N lines, each one will contain two integers separated by a single space Viand Ci(1 ≤ Vi, Ci≤ 5,000) representing the value of a coin and the number of coins the princess has with this value, respectively. For each test case, all values of Viwill be distinct.OutputFor each test case print a single line containing \"Case n:\" (without quotes) where n is the test case number (starting from 1) followed by a space then the number of different ways to make the total sum S as described above. Two ways are considered different if any coin value does not appear the same number of times in both ways.You can assume that the result will always fit in a 64-bit signed integer.SampleInput:2\r\n10 2\r\n2 2\r\n6 1\r\n10 4\r\n1 10\r\n2 10\r\n3 10\r\n4 10Output:Case 1: 0\r\nCase 2: 5Notes:In the first test case, the only way to make the sum 10, is to use the following subset of coins (2, 2, 6), but this isn't valid because there are 2 coins with value 2 and 1 coin with value 6.In the second test case, the following are the 5 different ways: (1, 1, 1, 1, 1, 1, 1, 1, 1, 1), (2, 2, 2, 2, 2), (2, 2, 3, 3), (1, 1, 4, 4), (1, 2, 3, 4).",
  "sample_input": "Input:2\r\n10 2\r\n2 2\r\n6 1\r\n10 4\r\n1 10\r\n2 10\r\n3 10\r\n4 10Output:Case 1: 0\r\nCase 2: 5",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/FEAST",
  "scraped_at": "2025-08-17 00:34:30",
  "test_cases": [
    {
      "input": "2\r\n10 2\r\n2 2\r\n6 1\r\n10 4\r\n1 10\r\n2 10\r\n3 10\r\n4 10",
      "expected_output": "Case 1: 0\r\nCase 2: 5",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "2\n9\n4",
      "expected_output": "2\n9\n4",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "3\n3\n4\n4",
      "expected_output": "3\n3\n4\n4",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n9\n1\n7\n1\n5",
      "expected_output": "5\n9\n1\n7\n1\n5",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "11\n41771836\n457179\n38966929\n61118089\n35151387\n39987602\n39965301\n42975640\n38082849\n74311673\n63706437",
      "expected_output": "11\n41771836\n457179\n38966929\n61118089\n35151387\n39987602\n39965301\n42975640\n38082849\n74311673\n63706437",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "18\n72461757\n62236877\n32846581\n61905537\n51258188\n3417\n53837420\n9624190\n36939353\n54193666\n50907204\n7433144\n16540286\n46286938\n39995135\n86407829\n29609527\n82288702",
      "expected_output": "18\n72461757\n62236877\n32846581\n61905537\n51258188\n3417\n53837420\n9624190\n36939353\n54193666\n50907204\n7433144\n16540286\n46286938\n39995135\n86407829\n29609527\n82288702",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "18\n41072597\n61708015\n92850136\n2970702\n87552838\n15150680\n62757465\n84781753\n49894940\n23518504\n52313593\n21551472\n91802784\n71499417\n42257206\n88096655\n49433457\n19519822",
      "expected_output": "18\n41072597\n61708015\n92850136\n2970702\n87552838\n15150680\n62757465\n84781753\n49894940\n23518504\n52313593\n21551472\n91802784\n71499417\n42257206\n88096655\n49433457\n19519822",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "5\n4430900\n91971976\n94825690\n69315482\n58042450",
      "expected_output": "5\n4430900\n91971976\n94825690\n69315482\n58042450",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n91411181\n91838880\n37770990\n87840151\n11400248\n78609237",
      "expected_output": "6\n91411181\n91838880\n37770990\n87840151\n11400248\n78609237",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "34\n72827\n56037\n69431\n6428\n52856\n97978\n47696\n71976\n17763\n45780\n52244\n93180\n19978\n61747\n59685\n49290\n26304\n38304\n13495\n40010\n18572\n29007\n48585\n78484\n26054\n40826\n66354\n57280\n76443\n17543\n97312\n82831\n85522\n73376",
      "expected_output": "34\n72827\n56037\n69431\n6428\n52856\n97978\n47696\n71976\n17763\n45780\n52244\n93180\n19978\n61747\n59685\n49290\n26304\n38304\n13495\n40010\n18572\n29007\n48585\n78484\n26054\n40826\n66354\n57280\n76443\n17543\n97312\n82831\n85522\n73376",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "43\n30825\n52515\n88409\n9012\n19049\n46511\n55866\n71106\n257\n40378\n45733\n94755\n34932\n61484\n69348\n1120\n40741\n30362\n34629\n2089\n4652\n56312\n896\n42328\n52640\n68294\n26704\n33337\n17595\n20013\n88671\n16993\n83802\n814\n71988\n38633\n35104\n17661\n59271\n63761\n10211\n41419\n7891",
      "expected_output": "43\n30825\n52515\n88409\n9012\n19049\n46511\n55866\n71106\n257\n40378\n45733\n94755\n34932\n61484\n69348\n1120\n40741\n30362\n34629\n2089\n4652\n56312\n896\n42328\n52640\n68294\n26704\n33337\n17595\n20013\n88671\n16993\n83802\n814\n71988\n38633\n35104\n17661\n59271\n63761\n10211\n41419\n7891",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "43\n80877\n73710\n40326\n57020\n81854\n51730\n79636\n66765\n19328\n49417\n83137\n45420\n84845\n46253\n22987\n4879\n12111\n36430\n77886\n39941\n98256\n94496\n27174\n17656\n15000\n59053\n58578\n72468\n53967\n76828\n66543\n30667\n77036\n14222\n51815\n65261\n33464\n23903\n37165\n2952\n83653\n29540\n5187",
      "expected_output": "43\n80877\n73710\n40326\n57020\n81854\n51730\n79636\n66765\n19328\n49417\n83137\n45420\n84845\n46253\n22987\n4879\n12111\n36430\n77886\n39941\n98256\n94496\n27174\n17656\n15000\n59053\n58578\n72468\n53967\n76828\n66543\n30667\n77036\n14222\n51815\n65261\n33464\n23903\n37165\n2952\n83653\n29540\n5187",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "35\n14602\n59363\n12420\n34997\n8277\n83783\n78883\n69270\n606\n76825\n31736\n13056\n31529\n73523\n38535\n84991\n81692\n81125\n20242\n55200\n31273\n48132\n45236\n6720\n34806\n81878\n18514\n50710\n30316\n74506\n84522\n24449\n37400\n22030\n67513",
      "expected_output": "35\n14602\n59363\n12420\n34997\n8277\n83783\n78883\n69270\n606\n76825\n31736\n13056\n31529\n73523\n38535\n84991\n81692\n81125\n20242\n55200\n31273\n48132\n45236\n6720\n34806\n81878\n18514\n50710\n30316\n74506\n84522\n24449\n37400\n22030\n67513",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "30\n15480\n75143\n81865\n15003\n76341\n68812\n30335\n81122\n61847\n89357\n80934\n67539\n30511\n1436\n40840\n97072\n93788\n95705\n19744\n53842\n31436\n73355\n60017\n10745\n32784\n42594\n94199\n19344\n49523\n82786",
      "expected_output": "30\n15480\n75143\n81865\n15003\n76341\n68812\n30335\n81122\n61847\n89357\n80934\n67539\n30511\n1436\n40840\n97072\n93788\n95705\n19744\n53842\n31436\n73355\n60017\n10745\n32784\n42594\n94199\n19344\n49523\n82786",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "36\n27851\n27732\n42731\n3508\n32120\n6796\n70212\n32923\n89613\n11305\n82318\n35082\n9157\n71090\n45101\n43511\n36309\n47660\n28446\n68227\n61643\n60158\n20446\n71136\n20676\n29854\n36265\n40155\n54553\n98957\n13404\n48729\n75863\n53102\n52648\n45842",
      "expected_output": "36\n27851\n27732\n42731\n3508\n32120\n6796\n70212\n32923\n89613\n11305\n82318\n35082\n9157\n71090\n45101\n43511\n36309\n47660\n28446\n68227\n61643\n60158\n20446\n71136\n20676\n29854\n36265\n40155\n54553\n98957\n13404\n48729\n75863\n53102\n52648\n45842",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "22\n41522\n34771\n54169\n19447\n67538\n76866\n25339\n4562\n39111\n60121\n56441\n95058\n54239\n90182\n81455\n58187\n24365\n88827\n32345\n33576\n54227\n76423",
      "expected_output": "22\n41522\n34771\n54169\n19447\n67538\n76866\n25339\n4562\n39111\n60121\n56441\n95058\n54239\n90182\n81455\n58187\n24365\n88827\n32345\n33576\n54227\n76423",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "50\n43626791\n55926624\n51411720\n92462743\n29796081\n13024891\n37034064\n31629751\n59289933\n93134086\n80657948\n86432409\n24150321\n20692216\n12579927\n76181894\n72129155\n5378612\n2347701\n60886040\n67960603\n53377571\n98309423\n87372576\n45790802\n94595592\n18446190\n25669854\n63057783\n13169464\n66430286\n39797413\n7854002\n61202680\n50225532\n59744625\n10363147\n47117677\n97275627\n59326999\n85105940\n19387616\n74845071\n31099247\n65250653\n71892952\n40353605\n78537036\n16117923\n89477354",
      "expected_output": "50\n43626791\n55926624\n51411720\n92462743\n29796081\n13024891\n37034064\n31629751\n59289933\n93134086\n80657948\n86432409\n24150321\n20692216\n12579927\n76181894\n72129155\n5378612\n2347701\n60886040\n67960603\n53377571\n98309423\n87372576\n45790802\n94595592\n18446190\n25669854\n63057783\n13169464\n66430286\n39797413\n7854002\n61202680\n50225532\n59744625\n10363147\n47117677\n97275627\n59326999\n85105940\n19387616\n74845071\n31099247\n65250653\n71892952\n40353605\n78537036\n16117923\n89477354",
      "type": "max_case_17",
      "description": "Maximum size array (N = 50)"
    },
    {
      "input": "50\n83123352\n56974824\n85178492\n80649710\n78975127\n95041794\n17863995\n82252469\n21153869\n26543026\n81985697\n13627159\n92040543\n92881018\n63562135\n97426666\n17922635\n8654210\n91575149\n85816577\n62362924\n36184667\n73219983\n34846151\n53681573\n59781469\n89569225\n62144755\n78035431\n31398395\n1313361\n81925698\n16148178\n9944916\n30746177\n9039108\n8469925\n34835646\n99183035\n44576060\n10207932\n70272935\n88497520\n55481139\n54578687\n43687755\n24896323\n23805642\n13427180\n27527154",
      "expected_output": "50\n83123352\n56974824\n85178492\n80649710\n78975127\n95041794\n17863995\n82252469\n21153869\n26543026\n81985697\n13627159\n92040543\n92881018\n63562135\n97426666\n17922635\n8654210\n91575149\n85816577\n62362924\n36184667\n73219983\n34846151\n53681573\n59781469\n89569225\n62144755\n78035431\n31398395\n1313361\n81925698\n16148178\n9944916\n30746177\n9039108\n8469925\n34835646\n99183035\n44576060\n10207932\n70272935\n88497520\n55481139\n54578687\n43687755\n24896323\n23805642\n13427180\n27527154",
      "type": "max_case_18",
      "description": "Maximum size array (N = 50)"
    },
    {
      "input": "2\n42804373\n1",
      "expected_output": "2\n42804373\n1",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "2\n17219495\n1",
      "expected_output": "2\n17219495\n1",
      "type": "edge_case_20",
      "description": "Edge case array (N = 2)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:58",
  "total_test_cases": 20,
  "outputs_generated_at": "2025-08-19 20:38:24"
}