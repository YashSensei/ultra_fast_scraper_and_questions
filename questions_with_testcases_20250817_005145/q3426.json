{
  "problem_code": "problems",
  "title": "Game Time",
  "tags": [],
  "text": "Jack has got a new game of Super Mario recently. There arencastles in the game, and Princess Peach has been kidnapped by the King Koopa and enjailed in castle n - 1 (0-based). The King Koopa has Son Koopas, and the Son Koopas has Grandson Koopas, and the Grandson Koopas has Great-Grandson Koopas... The whole Koopa family is taking possession of these n castles, and there is exactly one Koopa in each castle and the King Koopa is in castle n - 1. Super Mario's task is to conquer these castles and save Princess Peach.Each time, Super Mario can freely choose an unconquered castle and go in to fight with the Koopa. Super Mario has timeT[i]to conquer castleiand beat the Koopa in it. If Super Mario fails to conquer the castle or fails to do that within the time limit, the game is over. Otherwise, the defeated Koopa will go to seek the Father Koopa for help. If any Koopa has two or more Son Koopas beaten by Super Mario, he will get angry. Super Mario has to go to the castle of the angry Koopa and beat him immediately; otherwise the Princess Peach will be killed. If castle n - 1 is conquered and King Koopa is defeated, the game will also end, but with triumph and Princess Peach saved.Jack loves this game a lot, but he has to prepare for the upcoming ACM/ICPC. So he guarantees to himself that he only plays the game once a month. However, Jack really loves playing game and hates programming, he wants to maximize the time he can spend on the game without breaking his promise.InputThe input consists of multiple test cases.Each test case starts with a numberN(0 < N ≤ 100,000) in a single line, the number of castles and Koopas. There are two lines following and each contains N numbers.The first line is N numbers,T[i](0 < T[i] ≤ 100) for Super Mario to conquer castle i.The second line is N numbers ofP[i](-1 ≤ P[i] < N), the castle (0-based) in which the Parent of each Koopa resides.-1 means that there is no parent for him, and the last number will always be -1, since King Koopa has no Parent Koopa.The input ends with 0 (zero), which should not be processed.OutputOutput the maximal time Jack can play in a single line for each test case.ExampleInput:5\r\n1 2 3 4 5\r\n4 4 4 4 -1\r\n5\r\n2 2 2 2 2\r\n1 2 3 4 -1\r\n9\r\n1 1 1 1 1 1 1 1 1\r\n6 6 6 7 7 7 8 8 -1\r\n0Output:12\r\n10\r\n8",
  "sample_input": "Input:5\r\n1 2 3 4 5\r\n4 4 4 4 -1\r\n5\r\n2 2 2 2 2\r\n1 2 3 4 -1\r\n9\r\n1 1 1 1 1 1 1 1 1\r\n6 6 6 7 7 7 8 8 -1\r\n0Output:12\r\n10\r\n8",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/GAMETIME",
  "scraped_at": "2025-08-17 00:34:21",
  "test_cases": [
    {
      "input": "5\r\n1 2 3 4 5\r\n4 4 4 4 -1\r\n5\r\n2 2 2 2 2\r\n1 2 3 4 -1\r\n9\r\n1 1 1 1 1 1 1 1 1\r\n6 6 6 7 7 7 8 8 -1\r\n0",
      "expected_output": "12\r\n10\r\n8",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1\n10",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n4\n2\n7\n6",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n1\n6\n5\n7\n5",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "6\n37881307\n62433620\n68462560\n49605183\n47998102\n10734431",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "9\n69180641\n15545822\n64483931\n71703506\n26363478\n79981790\n19512209\n95548507\n85203765",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "10\n4931172\n4686920\n29301422\n46640244\n68536391\n91378827\n2500123\n54354587\n81542930\n78981961",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "11\n29854195\n32331596\n98615393\n99405804\n55788906\n95253690\n40062217\n34197081\n78695619\n87626526\n84193854",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "19\n53217763\n12094988\n23151375\n68426611\n3747659\n11818832\n43631726\n23557322\n62444617\n94406881\n16292838\n5231807\n49018305\n27808649\n11737994\n64366634\n37852680\n21645509\n91806976",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "85\n81265\n24273\n99050\n86491\n1909\n70606\n54039\n36531\n96051\n83662\n65770\n22687\n91978\n40721\n69562\n6987\n94628\n3860\n36376\n58889\n29908\n36799\n71699\n41652\n28991\n50010\n88422\n30942\n465\n68188\n63462\n73182\n95207\n28326\n30479\n12777\n29041\n47592\n7523\n16609\n47894\n92645\n83026\n13743\n27708\n6140\n82244\n82974\n10465\n70978\n52515\n22356\n48068\n30128\n64627\n68400\n54925\n72985\n40834\n58848\n62149\n86572\n28123\n81654\n76830\n23\n73479\n32567\n60100\n30342\n27803\n6791\n5884\n32396\n4815\n44083\n80969\n16302\n7911\n89773\n77128\n60850\n66391\n25549\n71766",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "36\n20478\n21972\n74136\n41194\n28298\n53764\n79433\n90162\n87582\n55906\n82215\n60494\n28264\n26982\n67050\n36716\n88384\n64727\n55382\n72342\n88987\n37085\n79540\n2727\n21116\n71919\n23766\n82762\n53312\n27727\n17170\n51871\n85586\n63154\n4750\n56716",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "79\n8997\n45465\n25739\n64440\n99510\n81333\n18625\n42676\n14675\n27061\n21514\n99415\n72188\n42471\n6904\n21584\n32176\n59384\n83823\n34483\n19614\n11323\n64901\n91156\n91725\n75821\n97592\n74972\n77144\n2217\n50374\n51070\n35315\n89574\n26030\n85645\n26178\n40165\n46592\n53484\n28583\n38847\n1958\n10677\n519\n1779\n81501\n88548\n28185\n26349\n97599\n53392\n26237\n926\n39063\n4361\n56976\n70838\n8874\n59325\n87940\n49008\n59766\n96220\n18865\n16548\n99534\n45420\n88863\n63147\n82970\n41281\n10088\n23447\n99534\n90441\n97346\n75323\n44225",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n9222\n71081\n37147\n31149\n65198\n44727\n91803\n97764\n49763\n52903\n54250\n66461\n80961\n95754\n66357\n26222\n68484\n24965\n74075\n7671\n70621\n81150\n84699\n19382\n72429",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "42\n39426\n4573\n78195\n52912\n88705\n2145\n85462\n13148\n62112\n73783\n84963\n63593\n33215\n93373\n79889\n10355\n53679\n44754\n7928\n13868\n30575\n4319\n53677\n69784\n60668\n95018\n99998\n94942\n49839\n98455\n28590\n9974\n8014\n92959\n90666\n51259\n66829\n19740\n79925\n71209\n62644\n18561",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "72\n20909\n31504\n41621\n46970\n62540\n34253\n27067\n38489\n41389\n70002\n7255\n88379\n32254\n68129\n15355\n78705\n13827\n44698\n68087\n38956\n79969\n90532\n60916\n26841\n96358\n24313\n37826\n25357\n29178\n41126\n84302\n11354\n28702\n52431\n32616\n55173\n60569\n78387\n54344\n43227\n30118\n17716\n11318\n61114\n86827\n22397\n4794\n23308\n10904\n922\n75501\n39878\n24846\n2897\n44531\n1593\n3725\n33919\n83027\n86447\n38944\n23048\n53446\n1248\n39487\n80145\n75741\n91809\n64909\n65370\n36633\n32436",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n94966\n64091\n10823\n72077\n35342\n67460\n13150\n32212\n62714\n15170\n95789\n65052\n54316\n26407\n3882\n86148\n331\n69844\n24243\n73920\n64690\n33674\n52435\n52552\n39936",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "100\n54943257\n7369855\n8820937\n53289431\n79683991\n93318006\n56029740\n6353849\n50111532\n68535069\n82459236\n78301990\n17818248\n20307026\n83043702\n19143945\n43682589\n83759954\n54466759\n5967825\n37548389\n58122863\n38792274\n91238974\n57220211\n47920386\n40106792\n17037828\n21112350\n46614844\n48076055\n19021296\n39382036\n91343866\n31104974\n1205050\n57002543\n4124675\n19002848\n29437790\n60110568\n70510559\n72088254\n89840694\n86774545\n47467800\n67746235\n8543894\n39503533\n79011658\n72639397\n77431380\n20078853\n33706493\n69100259\n90151761\n58784573\n18358247\n45296068\n26766799\n27648435\n40734545\n709311\n86275666\n41279764\n16431735\n42989972\n26066558\n76009136\n2973164\n3618018\n44092472\n29180084\n97724302\n20154157\n61138680\n33902403\n10069501\n21978060\n1406790\n17629312\n27123728\n4593094\n80796098\n67316597\n22691166\n79660869\n15241323\n14022013\n33262231\n6207667\n5732861\n29137727\n50467933\n7829545\n20008953\n46683905\n79970324\n34317322\n51818694",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 100)"
    },
    {
      "input": "100\n56795603\n47099371\n65257710\n91614894\n9089987\n68786412\n80625172\n15384570\n67497642\n17155554\n94854203\n3521257\n45528037\n25952971\n89842281\n18110362\n53925079\n30494451\n57632523\n11611174\n91010162\n93943233\n38281480\n34464587\n96544455\n37890558\n92650088\n48991175\n64493361\n21170278\n50668224\n41478183\n54464712\n50092393\n72530002\n1937592\n11113259\n87106395\n6921466\n2722357\n41421991\n92063181\n8242372\n45056474\n95771349\n37847916\n79802797\n5873379\n25316166\n87978078\n45043490\n36997671\n71128898\n79210070\n14442235\n14115105\n8826882\n46495995\n61961475\n25493246\n77016322\n30797957\n59605049\n92469906\n68614886\n27411095\n92707960\n80857181\n96903295\n95697462\n47813751\n15910058\n36356914\n1905019\n27200261\n61913271\n39707512\n21097850\n94107151\n95882204\n99122208\n35077518\n11924667\n47991073\n44209103\n40375836\n5696892\n16993743\n19687172\n99081758\n86036183\n71321422\n42527294\n94611634\n87451753\n71588703\n80832416\n35992831\n1365590\n3091403",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 100)"
    },
    {
      "input": "100\n1\n1\n100000000\n6956429\n1\n1\n39429208\n68306882\n1\n100000000\n51499578\n27266526\n77236460\n69303509\n100000000\n100000000\n51408867\n100000000\n60365124\n78334438\n95052374\n1\n9387162\n72711381\n71652410\n1\n718059\n100000000\n100000000\n1\n100000000\n100000000\n15265971\n65067853\n82267417\n1\n100000000\n52448003\n73464291\n1\n100000000\n1\n100000000\n100000000\n100000000\n40007640\n100000000\n100000000\n100000000\n1\n1\n100000000\n100000000\n64597076\n80960103\n1\n100000000\n100000000\n1\n1\n100000000\n1\n1\n100000000\n1\n100000000\n100000000\n35555523\n100000000\n46181790\n100000000\n46083513\n1\n95735143\n84724190\n68280231\n100000000\n100000000\n1\n1\n100000000\n1\n100000000\n41036606\n1\n1\n100000000\n93887408\n100000000\n100000000\n1\n1\n100000000\n1\n1\n100000000\n1\n56842082\n1\n1",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 100)"
    },
    {
      "input": "2\n1\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 2)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:56",
  "total_test_cases": 20
}