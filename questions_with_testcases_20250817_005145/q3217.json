{
  "problem_code": "problems",
  "title": "Graph",
  "tags": [],
  "text": "Given an undirected graph withnnodes andmweighted edges, every node having one of two colors - black (denoted as 0) and white (denoted as 1). You are to performqoperations of two kinds:Cx: Change thex-th node´s color. A black node should be changed into a white node, and vice versa.QA B: Find the sum of weight of edges whose two end points of color A and B. A and B can be either 0 or 1.InputThe first line contains two integersn(1 ≤n≤ 105) andm(1 ≤m≤ 105) specified above.The second line containsnintegers, thei-th of which represents the color of thei-th node, 0 for black and 1 for white.The followingmlines represent edges. Each line has three integer u, v and w (1 ≤ u, v ≤ n, u ≠ v), indicating there is an edge of weight w between u and v. w fits into 32-bit signed integer.The next line contains only one integerq(1 ≤q≤ 105), the number of operations.The followingqlines - operations mentioned above. See samples for detailed format.OutputFor eachQquery, print one line containing the desired answer. See samples for detailed format.ExampleInput:4 3\r\n0 0 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 2\r\nQ 0 0\r\nQ 0 1Output:6\r\n3\r\n3Input:4 3\r\n0 1 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 3\r\nQ 0 0\r\nQ 0 1Output:3\r\n0\r\n4This problem has a somewhat strict source limit and time limit.",
  "sample_input": "Input:4 3\r\n0 0 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 2\r\nQ 0 0\r\nQ 0 1Output:6\r\n3\r\n3",
  "sample_output": "Input:4 3\r\n0 1 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 3\r\nQ 0 0\r\nQ 0 1Output:3\r\n0\r\n4",
  "link": "https://www.spoj.com/problems/GRAPH2",
  "scraped_at": "2025-08-17 00:34:19",
  "test_cases": [
    {
      "input": "4 3\r\n0 0 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 2\r\nQ 0 0\r\nQ 0 1",
      "expected_output": "6\r\n3\r\n3",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "4 3\r\n0 1 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 3\r\nQ 0 0\r\nQ 0 1",
      "expected_output": "3\r\n0\r\n4",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "4 8\n9 9 1 3\n10 10 4\n5 7 10\n6 9 6\n4\n3 1\nly 4 7\n4\ns 4\n10 10\nwvqxo 10 6\n6 9\nhi 6 1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "9 4\n1 6 5 5\n9 1 6\n8 3 10\n7 1 7\n3\n4 7\nwh 8 8\n7\nhuk 8\n1 9\nro 8 2\n9 7\notylg 4 8",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "9 10\n10 7 8 9\n1 1 7\n3 7 3\n9 3 1\n2\n3 1\npu 3 1\n7\nwjaro 3\n9 5\nzj 9 4\n7 5\ndc 9 4",
      "expected_output": "To be computed",
      "type": "small_case_5",
      "description": "Generated small test case"
    },
    {
      "input": "59 7\n64 43 4 41\n42 42 33\n33 40 65\n18 12 62\n23\n51 13\nxm 85 30\n15\nolklg 3\n47 38\na 48 93\n20 78\nz 83 35",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "42 41\n20 31 13 70\n95 38 82\n35 50 43\n22 13 66\n11\n73 34\nbe 2 98\n17\nwafvu 22\n2 31\nn 6 53\n67 3\nbihs 65 24",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "99 86\n28 39 72 95\n10 71 45\n80 13 32\n6 8 83\n68\n4 4\nob 19 94\n34\nqtmg 25\n82 93\nyyt 11 90\n17 75\ngprcf 27 65",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "63 81\n20 2 21 29\n72 15 83\n61 38 57\n37 89 83\n20\n69 33\nyphaq 75 43\n49\nyavpn 66\n23 42\ncqknt 20 90\n97 30\nx 5 100",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "66 57\n1 81 62 68\n71 43 92\n38 12 99\n8 36 10\n29\n5 51\necnq 13 26\n51\nim 91\n41 69\nhz 4 64\n39 54\ntut 27 57",
      "expected_output": "To be computed",
      "type": "medium_case_10",
      "description": "Generated medium test case"
    },
    {
      "input": "6 25\n10 42 16 42\n21 50 14\n52 43 20\n39 18 32\n6\n43 17\nsom 8 34\n6\ntt 42\n28 40\nrcubt 5 14\n37 20\ncg 51 7",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "17 27\n28 23 49 10\n10 49 10\n35 32 14\n32 13 30\n47\n32 31\nzf 40 29\n24\nkhofh 28\n12 42\nphl 45 24\n23 5\nld 8 38",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "27 5\n9 47 29 29\n10 44 15\n16 18 14\n15 18 6\n52\n47 39\no 15 19\n44\nlo 51\n13 44\nridr 8 20\n11 43\nuz 49 46",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "13 22\n25 25 7 48\n35 37 12\n46 37 16\n25 32 9\n50\n14 6\ncm 33 20\n50\nysmq 7\n22 49\nb 5 25\n40 8\ne 8 19",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "33 47\n46 27 14 31\n44 14 49\n44 47 49\n15 15 33\n42\n11 5\nyb 28 27\n31\nqo 10\n5 8\ncfozj 42 41\n50 49\njixdz 26 10",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "29 39\n43 25 5 24\n35 40 30\n41 17 16\n40 34 39\n34\n42 22\ncz 42 49\n20\nhxcf 20\n24 20\nx 11 49\n50 11\nwbrew 7 26",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "20 20\n42 41 21 27\n27 37 6\n28 52 11\n30 42 29\n12\n15 19\nsjqax 30 40\n51\nzluf 10\n49 21\na 38 45\n44 39\nni 30 38",
      "expected_output": "To be computed",
      "type": "large_case_17",
      "description": "Generated large test case"
    },
    {
      "input": "105 105\n105 105 105 105\n105 105 105\n105 105 105\n105 105 105\n105\n105 105\nvpghw 105 105\n105\nerqrk 105\n105 105\nov 105 105\n105 105\notl 105 105",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "105 105\n105 105 105 105\n105 105 105\n105 105 105\n105 105 105\n105\n105 105\nugs 105 105\n105\ntcaek 105\n105 105\nrctg 105 105\n105 105\njszu 105 105",
      "expected_output": "To be computed",
      "type": "max_case_19",
      "description": "Generated max test case"
    },
    {
      "input": "2 2\n105 104 1 105\n1 104 1\n104 1 105\n2 104 104\n2\n105 104\nb 1 1\n104\nqx 105\n2 1\nb 2 105\n1 105\npbj 105 2",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:55",
  "total_test_cases": 20
}