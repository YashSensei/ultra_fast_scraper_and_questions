{
  "problem_code": "problems",
  "title": "Acronym II",
  "tags": [],
  "text": "An acronym is made of up the initial letter(s) of the words in a phrase, such as EU (European Union) and BREXIT (BRitish EXIT). In this problem, we can also either ignore or consider the conjunction \"and\", and the following adpositions \"in\", \"on\", \"at\", \"to\", \"of\", \"from\", \"for\" and \"with\" when making the acronym, such as BENELUX (BElgium, NEtherlands and LUXembourg) and RADAR (RAdio Detection And Ranging).Given an acronymA, and a list ofNstringsW1,W2...WN, you would like to find out the number of possible combinations of making the given acronym by using all the N strings following their order. That is, the acronym must be made up of at least one initial letter of each word, except the above-mentioned conjunction and adpositions (either skip or use it). BothAand theNstrings only consist of lowercase latin letters. Since the answer can be large, output the answer modulo1000000007.Note: This is a harder version of the problemACRYM, with larger constraints. Please read the input section carefully.InputThe first line is the number of test casesT. (1 ≤ T ≤ 20)For each test case, it starts with one integerN. (1 ≤ N ≤ 200)Next line is a stringA. (1 ≤ |A| ≤ 50000)Following N lines, each consisting of one stringWi. (1 ≤ |Wi| ≤ 250)It is guaranteed that W1is neither conjunction nor adposition.OutputOutput one integer indicating the number of possible combinations.ExampleInput:3\r\n3\r\nduckhim\r\nduck\r\nhello\r\nmoto\r\n7\r\nnatiofforessaa\r\nnational\r\noffice\r\nfor\r\nforest\r\nsafety\r\nin\r\naachen\r\n4\r\nwhiskey\r\nwhat\r\nis\r\nsecret\r\nkeyOutput:0\r\n4\r\n1ExplanationIn case 1, no combination is possible.In case 2, there are four possible combinations:NATIonalOFfice forFOREStSAfety inAachenNATIonalOFfice forFOREStSafety inAAchenNATIonalOfficeForFOREStSAfety inAachenNATIonalOfficeForFOREStSafety inAAchenIn case 3, only one possible combination exists:WHatIsSecretKEY",
  "sample_input": "Input:3\r\n3\r\nduckhim\r\nduck\r\nhello\r\nmoto\r\n7\r\nnatiofforessaa\r\nnational\r\noffice\r\nfor\r\nforest\r\nsafety\r\nin\r\naachen\r\n4\r\nwhiskey\r\nwhat\r\nis\r\nsecret\r\nkeyOutput:0\r\n4\r\n1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ACRYM2",
  "scraped_at": "2025-08-17 00:33:08",
  "test_cases": [
    {
      "input": "3\r\n3\r\nduckhim\r\nduck\r\nhello\r\nmoto\r\n7\r\nnatiofforessaa\r\nnational\r\noffice\r\nfor\r\nforest\r\nsafety\r\nin\r\naachen\r\n4\r\nwhiskey\r\nwhat\r\nis\r\nsecret\r\nkey",
      "expected_output": "0\r\n4\r\n1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "4\n9\n5\n5\n6",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n5\n9\n6\n5",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "3\n4\n4\n8",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "16\n45387184\n10433806\n67699450\n29648912\n90031864\n24872203\n13697529\n53289280\n34384409\n57079431\n89029636\n18870760\n46995414\n21686853\n74761978\n90055616",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "7\n88005855\n80752417\n63325678\n71846045\n75233204\n52756455\n99584971",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n49083737\n83642111\n35954175\n81604686\n31676606\n92627830\n78244866\n42140018\n19216458\n56792225\n97573307\n21018251\n53056182\n9588330\n86708626\n11082069",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "5\n52489805\n85479307\n25801307\n79023610\n24824361",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "5\n38056718\n7218609\n74369089\n23226611\n35798287",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "62\n77429\n86921\n50735\n5733\n90681\n95866\n51779\n38548\n51403\n27450\n16017\n60909\n5493\n74496\n94702\n47399\n99699\n70487\n10660\n32909\n14613\n94666\n1764\n59992\n25124\n56277\n72035\n40553\n72375\n19884\n55854\n57571\n31580\n23155\n83868\n23117\n7520\n15782\n63299\n8927\n40720\n51095\n67517\n69427\n57475\n25072\n30924\n31494\n54924\n31898\n2424\n55179\n45849\n83105\n94454\n27259\n81087\n68495\n28571\n35290\n76146\n14633",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "124\n44305\n4031\n51500\n80971\n21873\n25048\n62681\n30002\n85966\n90472\n13522\n10474\n15018\n76158\n56640\n1435\n36401\n94562\n41263\n96223\n7375\n21378\n23590\n66733\n62898\n85372\n8679\n58526\n2985\n34506\n17896\n78696\n38132\n29647\n18567\n65053\n99076\n57581\n12032\n14337\n99011\n97452\n98929\n50961\n83113\n96986\n46796\n65565\n33483\n51736\n76436\n12878\n20040\n57872\n66414\n7293\n32412\n47946\n62680\n68464\n67243\n83896\n44873\n66653\n20066\n29868\n71237\n81608\n19309\n20892\n46310\n2889\n7262\n29324\n30645\n44024\n62933\n67935\n5764\n86523\n89213\n23562\n51428\n29654\n56435\n78261\n77828\n56877\n10354\n78456\n77351\n60727\n38023\n7548\n56051\n29692\n20662\n43806\n39493\n42725\n73004\n8451\n21004\n2277\n98597\n64810\n31545\n88582\n30432\n61674\n57323\n43776\n70279\n66560\n41574\n24599\n58020\n72061\n50131\n63436\n3437\n10289\n44007\n45380",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "111\n79430\n19966\n17411\n907\n43200\n96538\n82822\n1739\n32475\n77120\n8269\n84697\n23979\n81159\n64016\n92057\n94959\n81601\n68462\n35412\n57920\n58013\n13689\n36847\n16384\n14402\n9200\n59987\n1799\n54084\n51096\n50979\n84006\n25073\n7997\n66198\n48678\n23099\n87596\n48378\n592\n42999\n17101\n70442\n71298\n40909\n3892\n50935\n18508\n93043\n95183\n10754\n47847\n80205\n63346\n1029\n38605\n54603\n34487\n60923\n48045\n84302\n90419\n70969\n92277\n33376\n83475\n98716\n88024\n97482\n28565\n22169\n95766\n51239\n75448\n55481\n78136\n66993\n18632\n21731\n54248\n41956\n31159\n27168\n36385\n96638\n84738\n72281\n17126\n14427\n11067\n78214\n37823\n6412\n41681\n69926\n28264\n21805\n32063\n10666\n33432\n58085\n85330\n82461\n20794\n86899\n76239\n87899\n37190\n61526\n19964",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "20\n44747\n35852\n82310\n88818\n61216\n34250\n30928\n61742\n12209\n29365\n52615\n48351\n66468\n2889\n87618\n19231\n46877\n80202\n80005\n79003",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "115\n41922\n65270\n51136\n26412\n78624\n26073\n32205\n61293\n45889\n41551\n93115\n87611\n93357\n43841\n36309\n10082\n61956\n21230\n40644\n76621\n60052\n16763\n29726\n91590\n99253\n12503\n90371\n55921\n58607\n82547\n5584\n6031\n99840\n17588\n55181\n32335\n20907\n66312\n31741\n25037\n94897\n69955\n99146\n17472\n66451\n15739\n37798\n8467\n2667\n76803\n23621\n13442\n41790\n61707\n91858\n33046\n32412\n32633\n24591\n67329\n13822\n57867\n58157\n48786\n57659\n33859\n3580\n23530\n52033\n31659\n64982\n18914\n38786\n40837\n48465\n74919\n65310\n10408\n86329\n16979\n10121\n51285\n95008\n68508\n78861\n82254\n28062\n99450\n84947\n60519\n90630\n66322\n23787\n22666\n56125\n60997\n32581\n94427\n74249\n52071\n86538\n82841\n86852\n13057\n84921\n45463\n27770\n93607\n95138\n93015\n88189\n67595\n13428\n14385\n9940",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "188\n49996\n95819\n76128\n63260\n20161\n50925\n9251\n21277\n5373\n10207\n40814\n7412\n23347\n78412\n28902\n17767\n24415\n839\n93407\n41806\n61264\n98428\n15662\n27436\n22390\n1720\n96558\n42867\n81892\n80692\n78977\n77222\n94964\n7204\n510\n81548\n78363\n3407\n92049\n23494\n49178\n86927\n80213\n94290\n96802\n6441\n28131\n14954\n57815\n10450\n76932\n60004\n85942\n9545\n29176\n51753\n78766\n23227\n51842\n72952\n73216\n97083\n56324\n52824\n66599\n13537\n96804\n19220\n20169\n97320\n50602\n79587\n9067\n42240\n82656\n63649\n73297\n77609\n74723\n70123\n68136\n83133\n8472\n4083\n42558\n53233\n30297\n27178\n91842\n30597\n92314\n57051\n36996\n62894\n82575\n52198\n6849\n32657\n44645\n93930\n91756\n37798\n90588\n94097\n82171\n38988\n72123\n53864\n59163\n63521\n381\n29872\n30028\n89407\n50191\n18822\n75135\n79636\n53399\n31412\n35283\n77552\n9077\n93430\n6939\n82192\n39202\n3703\n62515\n9700\n72243\n13930\n20351\n29135\n40984\n78641\n84136\n45553\n22233\n5636\n38388\n7330\n3669\n46781\n59025\n31510\n84098\n53832\n26561\n27470\n38254\n64461\n75047\n53412\n29622\n41010\n55413\n96976\n54429\n68860\n5204\n8681\n25214\n18341\n46052\n62903\n78937\n25120\n12388\n97980\n8323\n66299\n82556\n959\n70925\n7323\n63427\n84157\n61502\n30425\n9570\n39753\n99027\n83975\n41851\n17770\n55819\n14508",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "78\n81588\n91354\n37858\n34540\n98247\n30598\n20333\n62263\n66588\n83941\n61844\n85326\n70431\n45801\n9466\n48593\n63445\n42555\n10509\n85759\n74512\n44231\n67365\n11489\n27996\n66995\n5721\n60171\n95260\n27070\n41833\n26401\n20616\n79439\n66241\n43911\n74369\n47567\n15526\n49544\n66759\n35879\n60605\n6924\n35307\n57016\n49739\n25067\n38375\n13004\n26523\n80828\n45923\n67901\n60554\n83898\n44067\n58187\n66631\n36778\n66227\n92312\n18354\n74042\n44921\n62425\n6443\n56297\n26867\n27885\n16689\n11542\n80333\n73977\n87020\n67421\n5684\n22847",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n15558114\n60949221\n34666942\n22554616\n37586711\n36684151\n82052123\n75096220\n16160183\n39849391\n55301307\n56770455\n29397565\n8892213\n90801028\n30188561\n52381437\n13307882\n9014540\n82229310\n71250495\n41054427\n59834225\n38567785\n55570806\n43025491\n42971394\n52794912\n96126970\n7743678\n82307412\n65390275\n7571113\n27298194\n13883785\n13676897\n28773268\n4579783\n24727944\n64928199\n22679446\n63977413\n73475142\n82183580\n74500443\n64212719\n43771849\n19346030\n64691314\n23718907\n7044866\n48719908\n17778533\n3611538\n44075155\n83084820\n52741637\n32847868\n70867504\n86551647\n85477427\n46550124\n98443737\n35031581\n19540135\n29219975\n56580315\n5362236\n70763672\n66769777\n78983313\n78798925\n33004424\n70455880\n76082028\n97244556\n80457993\n14122860\n45902655\n92644066\n6048057\n64263746\n51619270\n80355918\n8431952\n1897018\n33392080\n70236272\n79412387\n62529312\n82762010\n65724\n42152240\n9273903\n56824142\n90100925\n78870514\n17636486\n36016773\n34065473\n88105648\n70125016\n58636425\n70623520\n55784277\n67276897\n19770165\n56604170\n63647252\n18209440\n31889642\n31297483\n96595670\n57332441\n23886108\n72031015\n15428499\n54400282\n77625358\n45416253\n52436514\n9949610\n51781375\n9775823\n88578413\n48586533\n25216703\n72144119\n5702495\n62789670\n18020603\n89337930\n78133515\n27302970\n78201320\n48167829\n13562817\n92095382\n89667602\n81129045\n86899608\n88282021\n83188734\n48413152\n58840049\n12922465\n98964879\n17364397\n71919693\n20133599\n33174205\n55094155\n3669950\n71400647\n97247099\n79147349\n90205768\n82463823\n46188242\n15250690\n48596797\n34335114\n74940527\n84538192\n22626104\n88572473\n98296043\n12336014\n55138707\n50432926\n15265573\n68066193\n43962636\n51690657\n675463\n49502688\n63344747\n90499989\n42885731\n24979090\n11252684\n61545703\n93076184\n20348626\n78732388\n68588979\n17012323\n61238060\n75103263\n99133610\n88595375\n56847207\n6847333\n94081408\n81281697\n66697791\n3050328\n13171272\n30401981\n50993693",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n93903839\n68870282\n21523014\n52634778\n53337736\n60385624\n56715672\n44818087\n32828351\n94872837\n29746853\n23668337\n76145476\n68425692\n55224257\n22429735\n48245520\n59792429\n73430052\n70724169\n246709\n6011150\n969713\n19500327\n94760608\n77830790\n68056473\n64382409\n9978394\n37191955\n33337258\n19770924\n81243118\n72428150\n80964193\n68177549\n8596354\n22217453\n26555760\n45713704\n17248296\n95353957\n97076734\n55954131\n10826759\n67197224\n14291286\n88626229\n75913865\n86824847\n33604720\n85786790\n19011165\n59441939\n41651160\n87395310\n99678236\n16701085\n6116509\n8217777\n45437944\n29801975\n76835462\n87585659\n34765235\n58184205\n77145542\n22367918\n42291257\n37421558\n81428772\n48869049\n14393494\n32638389\n68301080\n65657675\n29191045\n20318400\n10257109\n55308375\n67824711\n86942522\n44241542\n52812943\n2551795\n74312246\n86688166\n76002668\n11168197\n80252186\n3727735\n11870680\n70629669\n68835781\n59264704\n94367666\n80594659\n68466413\n24068461\n63038626\n59131782\n25566070\n93905676\n54360053\n21209598\n4997518\n12720739\n33236397\n14362627\n14267054\n18381365\n36708461\n27037873\n77621071\n36497928\n25143716\n72120504\n1177998\n2922419\n47083696\n60968253\n25105837\n81913008\n61016829\n85018441\n83913414\n95079289\n49584093\n29667568\n49203835\n53279083\n81452123\n12527939\n73894429\n94546891\n74357663\n62082742\n19909108\n64295553\n28650810\n88833717\n31080814\n44926444\n90257524\n35971742\n95305067\n5061533\n55250865\n74587598\n72064040\n73695153\n30387612\n34609216\n87763093\n75355602\n80496646\n27245695\n83254074\n79379211\n9077342\n13033412\n9210540\n39797740\n83500124\n65611369\n51674417\n71646823\n32027972\n21613527\n8714341\n57941154\n64235862\n10529259\n1492126\n67655932\n68854204\n47131179\n53811474\n49111916\n73042144\n2368393\n64555236\n80327198\n21786076\n83160105\n8445750\n31765445\n763958\n78712675\n24409006\n38316478\n8559829\n19221632\n69022698\n79748129\n10346377\n67988487\n9445992\n95024668\n81257144",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "1\n78915659",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 1)"
    },
    {
      "input": "1\n1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 1)"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:46",
  "total_test_cases": 20
}