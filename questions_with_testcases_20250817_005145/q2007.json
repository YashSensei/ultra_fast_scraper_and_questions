{
  "problem_code": "problems",
  "title": "Advanced Battleships",
  "tags": [],
  "text": "You managed to beat your friend in Battleships and take his Internet Points! Perfectly legitimately, of course. However, for some strange reason he’s upset, and now challenges you to a rematch - this time at the game of Advanced Battleships, and with even higher stakes!You each have a grid consisting of $M$ rows of $N$ cells each ($1 \\leq M, N \\leq 500$). Each cell is either empty or contains part of a player’s ship. What makes this game so “advanced” is the fact that each ship consists of a maximal set of 1 or more adjacent, nonempty cells. Two cells are considered adjacent if they share a common side. Of course, this means that ships can have some very strange shapes. No two ships can be adjacent to one another, of course.You know for a fact that you can distract your friend for a brief moment, this time by telling him that someone proved that P = NP, but this trick will again only work exactly once. While he isn’t looking, you’ll have time to snatch up some of his ships with one hand. Your hand can cover a square of exactly $S$x$S$ cells ($1 \\leq S \\leq min\\{M, N\\}$), and you can gather all the ships that are at least partially within such a square at once.Of course, your friend is no fool, so he’s got his grid well concealed. As such, you don’t know anything about it except its size, so when the time comes, you’ll just choose a random square of size $S$x$S$ that’s completely within the grid.As usual, these bets attract large crowds. One of the bystanders who can see your opponent’s grid knows your plan, and is curious as to the expected number of ships that you will grab (in other words, the average number of ships out of all the possible snatches you could make). Nerdy though he is, he can’t calculate it in his head, so he runs over to a computer and codes up a program...InputLine $1$: 3 integers, $M$, $N$, and $S$Next $M$ lines: $N$ characters each, representing your opponent’s grid – an ‘X’ represents a ship, while a ‘.’ represents an empty cellOutputA single number – the expected number of ships that you’ll grab, rounded to 6 decimal places.ExampleInput:5 5 2XXXX.X..X.X..X.X.....XX..Output:0.875000Explanation of Sample:There are 16 possible areas you could pick, yielding this many ships each:1 1 1 11 0 1 11 0 1 12 1 1 0This is a total of 14 ships, for an average of 0.875 per grab.",
  "sample_input": "Input:5 5 2XXXX.X..X.X..X.X.....XX..Output:0.875000",
  "sample_output": "1 1 1 11 0 1 11 0 1 12 1 1 0",
  "link": "https://www.spoj.com/problems/ABSHIP",
  "scraped_at": "2025-08-17 00:33:55",
  "test_cases": [
    {
      "input": "5 5 2XXXX.X..X.X..X.X.....XX..",
      "expected_output": "0.875000",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "4 1 5\n2 2 iillydwgw",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "2 9 4\n10 1 yeihwwgnelqgbwz",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "8 1 4\n1 3 jx",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "96 27 23\n88 73 gntujzixfbrgrbq",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "42 58 37\n4 88 ubobxfyj",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "2 41 93\n97 23 snzppmyhqy",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "76 56 3\n93 41 axvjwfyalkljabivkadl",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "6 98 96\n75 79 tvhgmmzssxbcwuspeyicpsrj",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "414 107 344\n318 272 bzkpysyae",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "478 225 104\n82 301 gmhqqwcpas",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "74 394 323\n411 370 zskydfzfnk",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "369 325 141\n115 308 qjknfpygoehk",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "83 329 143\n251 484 wlsgxbzppgssbfeq",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "173 141 438\n179 443 vfvh",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "186 141 462\n389 500 hlncpgvylaakvikz",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000\n1000 1000 eqcakpjaelmeyqrqh",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000\n1000 1000 j",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1 1 2\n1000 1 ofwhdrodkkxocvupqnhvkbddsb",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "999 1000 1000\n2 999 lozixqvywnbucp",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-17 00:51:51",
  "total_test_cases": 20
}