{
  "problem_code": "problems",
  "title": "Matrix Multiplication 2K",
  "tags": [],
  "text": "Consider the following C++ code, it constructs n×n matrices A,B and vector V from matrix C=A×B which you need to calculate.uint32_t n, i, j, d1, p1, r1, m1, d2, p2, m2, A[n][n], B[n][n];\r\nuint64_t C[n][n], V[n];//here you need to read n, p1, d1, r1, m1, p2, d2, r2, m2 from input.for (i=0; i<n; ++i)\r\n    for (j=0; j<n; ++j) {\r\n        d1 = d1 * p1 + r1;\r\n        d2 = d2 * p2 + r2;\r\n        A[i][j] = d1 >> (32 - m1);\r\n        B[i][j] = d2 >> (32 - m2);\r\n    }//here you need to calculate C=A*Bfor (i=0; i<n; ++i) {\r\n    V[i] = 0;\r\n    for (j=0; j<n; ++j)\r\n        V[i] ^= C[i][j];\r\n}//here you need to output V[0], V[1], ..., V[n-1], separated by spaces.InputYou are given integers n, p1, d1, r1, m1, p2, d2, r2, m2, separated by spaces.1≤n≤2048, 1≤m1,m2≤26, 0≤p1,d1,r1,p2,d2,r2<232.OutputYou need to output V[0], ..., V[n-1], separated by spaces.ExampleInput:4 1664525 0 1013904223 26 1664525 1 1013904223 26Output:3929555766216722 770418013451752 7738542081270672 4286515685761206P.S.There are 4 tests with n≈2048. My best solution time — ~3.2s (~0.8s per test) which is 20 times faster than time limit.Also try the challengeMATRMUL, to get AC there your time here should be less than 14s for cubic algorithm and 16s for Strassen's.",
  "sample_input": "uint32_t n, i, j, d1, p1, r1, m1, d2, p2, m2, A[n][n], B[n][n];\r\nuint64_t C[n][n], V[n];//here you need to read n, p1, d1, r1, m1, p2, d2, r2, m2 from input.for (i=0; i<n; ++i)\r\n    for (j=0; j<n; ++j) {\r\n        d1 = d1 * p1 + r1;\r\n        d2 = d2 * p2 + r2;\r\n        A[i][j] = d1 >> (32 - m1);\r\n        B[i][j] = d2 >> (32 - m2);\r\n    }//here you need to calculate C=A*Bfor (i=0; i<n; ++i) {\r\n    V[i] = 0;\r\n    for (j=0; j<n; ++j)\r\n        V[i] ^= C[i][j];\r\n}//here you need to output V[0], V[1], ..., V[n-1], separated by spaces.",
  "sample_output": "Input:4 1664525 0 1013904223 26 1664525 1 1013904223 26Output:3929555766216722 770418013451752 7738542081270672 4286515685761206",
  "link": "https://www.spoj.com/problems/MATRMUL0",
  "scraped_at": "2025-08-17 00:33:21"
}