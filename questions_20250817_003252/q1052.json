{
  "problem_code": "problems",
  "title": "Happiness for all",
  "tags": [],
  "text": "The separatist state of Nlogonia hasNcities numbered1throughN. Some pairs of cities are connected by highways, so that if there is a highway between cityAand cityBit is possible to travel fromAtoBor fromBtoA. We say that a citizen from cityican visit another from cityjif there exists a sequence of different citiesc1, c2... cmwithm ≥ 2such thatc1= i,cm= jand there is a highway between citiesckandck+1fork = 1, 2 ... m-1.The people of Nlogonia are very sociable, so they have friends in all the cities they can visit. However, they are also a bit lazy, so that they are not happy unless they can visit each of their friends by taking exactly one highway directly from their city to their friend's.To avoid Nlogonia's scission, the queen has decided to perform a number of infrastructure works in order to make all of its citizens happy. One possibility consists in building new highways between the cities of Nlogonia, incurring in a cost ofRper new highway built. Because building many highways can be very expensive, another possibility is to build stadiums in some of Nlogonia's cities. The building of a stadium costsE, and immediately makes all the citizens happy in the city where it is built. Then again, you should know that Nlogonia's inhabitants are furthermore somewhat jealous, so that they shall never be happy if there is no stadium in their own city, but there is one in some of their friend's cities. Can you help the queen calculate the minimum cost of the construction work necessary to make everyone in Nlogonia happy?InputThere are multiple test cases in the input file. For each test case, the first line contains four integersN, M, RandE. The numberNrepresents the number of cities in Nlogonia (2 ≤ N ≤ 1000),Mrepresents the original number of highways (1 ≤ M ≤ 105), whereasRandErepresent the cost of building a highway and a stadium, respectively (1 ≤ R, E ≤ 1000). Each of the following M lines describes a different highway using two integersAandB, representing the cities connected by said highway (1 ≤ A, B ≤ NwithA ≠ B).OutputFor each test case, print one line containing an integer representing the minimum cost of the construction work necessary to make everyone in Nlogonia happy.ExampleInput:9 6 11 12\r\n1 2\r\n3 2\r\n4 5\r\n5 6\r\n6 7\r\n9 7Output:71",
  "sample_input": "Input:9 6 11 12\r\n1 2\r\n3 2\r\n4 5\r\n5 6\r\n6 7\r\n9 7Output:71",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TAP2015D",
  "scraped_at": "2025-08-17 00:33:23"
}