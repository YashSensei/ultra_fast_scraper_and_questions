{
  "problem_code": "problems",
  "title": "Erdos et al",
  "tags": [],
  "text": "Paul Erdös was a Hungarian mathematician of the 20th century who reached the highest levels of recognition. So much so that it is considered an honour not only having written an article with him, but also having shared authorship of a publication with one of his co-authors. Moreover, writing an article with someone who wrote an article with someone who wrote an article with Erdös is an important aspiration of many young researchers.A natural consequence of such honours assignment, at least within the context of formal sciences, is the emergence ofErdös numbers. Erdös is the only person with an Erdös number of0, and for any other personp, his/her Erdös numbernis defined by the shortest sequence of articlesa1, ... , ansuch that Erdös is one of the authors of articlea1,pis one the authors of articlean, and every pair of consecutive articlesaiandai+1(fori = 1, 2, ..., N-1) have at least one author in common. If no sequence of articles linking Erdös andpexists, we shall say thatp's Erdös number isundefined.Your task in this problem is to compute Erdös numbers based only on a corpus of articles and authors given as input. Unfortunately, current science demands scientists to increase very rapidly the number of articles they write, causing both the total number of articles and the number of authors per article to be huge. Of course, this reality is an obstacle that a correct solution to this problem should be able to handle.InputThe first line contains two integersAandN, whereArepresents the number of articles in the corpus to be analysed andNthe number of people who appear in it (where2 ≤ A, N≤105). People are identified with integers between1andN, and Erdös will always be the person identified with number1.Each of the followingAlines describes an article. Each of these lines begins with an integerCrepresenting the number of authors of the article (2≤C≤105), and then there areCdistinct integersP1, P2, ... , PCrepresenting the identifiers of the authors of the article (1≤Pi≤Nfori = 1, 2, ... , C). The sum of the number of authors over all articles does not exceed105.OutputFor each test case you must print three integersD,MandS, whereDrepresents the number of people on the corpus who have a well-defined Erdös number,Mis the maximum Erdös number of one of those people andSis the sum of all the Erdös numbers belonging to people who have a well-defined Erdös number.Example 1Input:3 5\r\n2 1 5\r\n3 5 2 3\r\n3 3 2 4Output:5 3 8Example 2Input:5 11\r\n2 10 11\r\n4 1 3 5 7\r\n6 2 3 4 5 6 7\r\n4 3 5 7 9\r\n3 8 1 5Output:9 2 12Example 3Input:6 31\r\n9 1 2 3 15 20 25 30 9 10\r\n10 2 25 7 9 3 11 12 13 14 4\r\n10 11 12 13 14 4 16 17 18 19 5\r\n2 5 7\r\n9 21 22 23 24 26 27 28 29 7\r\n3 22 6 21Output:29 4 63",
  "sample_input": "Input:3 5\r\n2 1 5\r\n3 5 2 3\r\n3 3 2 4Output:5 3 8",
  "sample_output": "Input:5 11\r\n2 10 11\r\n4 1 3 5 7\r\n6 2 3 4 5 6 7\r\n4 3 5 7 9\r\n3 8 1 5Output:9 2 12",
  "link": "https://www.spoj.com/problems/TAP2014E",
  "scraped_at": "2025-08-17 00:34:34"
}