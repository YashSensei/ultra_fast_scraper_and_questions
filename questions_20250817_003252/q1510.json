{
  "problem_code": "problems",
  "title": "Samvel and Boxes",
  "tags": [],
  "text": "King of Boxes Robert wants to test Samvel.  He has given Samvel n boxes indexed from 1 to n. All the boxes except the first one are located in another box. Robert wants to fill the boxes with apples (At beginning boxes contain no apples).  Robert can ask Samvel queries of 4 types.The queries are:Robert says two integers x, y to Samvel. Samvel needs to add x (1 ≤ x ≤ 109) apples to the y-th box. (1 ≤ y ≤ n)Robert says two integers x, y to Samvel. Samvel needs to swap the indexes of the x-th and y-th boxes. (1 ≤ x, y ≤ n)Robert says an integer x to Samvel. Samvel needs to say the number of apples located in the box x (1 ≤ x ≤ n) and in the boxes that are in the box x (directly or indirectly).Robert says an integer x to Samvel. Samvel needs to answer the query of the third type for the box that has minimum index from the boxes that are located directly in the box x. (1 ≤ x ≤ n)Samvel needs your help. Help him and write a program to answer this queries.InputThe first line of input contains an integer n (2 ≤ n ≤ 105)  and q (1 ≤ q ≤ 105), number of boxes and number of queries.Second line contains n-1 integers a1... an-1. ai-1is the index of the box that contains box i. (1 ≤ ai≤ n)The lines from 3 to q+2 contain an integer k (type of the query). if k=1 or k=2 then goes the two integer x, y from the task, else there is only one integer x.OutputFor each query of type 3 or 4 you need to output one integer the answer of query in a separate line. If query type is 4 and given box has no other boxes in it print -1.ExampleInput:4 6\r\n1 1 2\r\n1 5 1\r\n3 1\r\n2 1 3\r\n3 3\r\n1 60 1\r\n4 3Output:5\r\n5\r\n60",
  "sample_input": "Input:4 6\r\n1 1 2\r\n1 5 1\r\n3 1\r\n2 1 3\r\n3 3\r\n1 60 1\r\n4 3Output:5\r\n5\r\n60",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/SAMBOX",
  "scraped_at": "2025-08-17 00:33:45"
}