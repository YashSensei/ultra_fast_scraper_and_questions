{
  "problem_code": "problems",
  "title": "Ada and Taxes",
  "tags": [],
  "text": "As you might already know, Ada the Ladybug is a farmer. She grows\r\nvegetables in a long furrow. All of the vegetables have some height. Local\r\npoliticians tax small vegetables, but as the furrow is very long, they always\r\ntax just a part of it.The taxes always have some limit on height. They are calculated very\r\nsimply: Tax collectors multiply the heights of all vegetables, which are\r\nlesser or equal to limit and are on desired segment.The taxes might be very high so tax collectors just round their income and\r\ntake only1000000007(109+7) banknotes. They are very kind, so they always leave\r\nthe rest to Ada. She is interested in how much they will leave her.NOTE:If none of the vegetable is lesser/equal to given limit, Ada is\r\nleft with symbolical 1 \"money\".InputThe first line contains an integer1 ≤ N, Q ≤ 3×105,\r\nthe number of vegetables Ada grows and the number of times the tax collectors\r\ncome.The second line containsNintegers1 ≤ Ai≤\r\n    3×105, the heights of vegetables.The nextQlines contains three integers0 ≤ L ≤ R < N,\r\nthe left and right vegetables of segment and1 ≤ H ≤\r\n3×105, the limit.OutputPrint a single line for each query with the number of money Ada will be left with\r\nafter each tax collecting.Example Input10 6\r\n1 2 3 4 5 10 9 8 7 6\r\n5 5 5\r\n0 2 3\r\n0 9 9\r\n4 8 8\r\n2 4 11\r\n2 2 3Example Output1\r\n6\r\n362880\r\n280\r\n60\r\n3",
  "sample_input": "10 6\r\n1 2 3 4 5 10 9 8 7 6\r\n5 5 5\r\n0 2 3\r\n0 9 9\r\n4 8 8\r\n2 4 11\r\n2 2 3",
  "sample_output": "1\r\n6\r\n362880\r\n280\r\n60\r\n3",
  "link": "https://www.spoj.com/problems/ADATAXES",
  "scraped_at": "2025-08-17 00:34:20"
}