{
  "problem_code": "problems",
  "title": "Divide Polygon (HARD)",
  "tags": [],
  "text": "This is hard version ofDTPOLY.Determine the number of ways to cut a convex polygon withNvertices if the only cuts allowed are from vertex to vertex, each cut divides exactly one polygon into exactly two polygons, and you must end up with exactlyKpolygons. Consider each vertex distinct. For example, there are three ways to cut a square - the two diagonals and not cutting at all - but only two ways to cut it to form 2 polygons, and only one way to cut it to form 1 polygon. The order of cuts does not matter. Since the number of ways can be very large, you should return the number taken moduloM.InputInput contains several test cases, i-th line consists of 3 integers:Ni(3 ≤Ni,ΣNi≤ 108over all test cases),Ki(1 ≤Ki≤Ni- 2) andMi(1 <Mi< 260), all pairs (Ni,Ki) are different.OutputOn the i-th line print the number of different ways to cut the polygon withNivertices intoKipieces moduloMi.ExampleInput:4 2 100\r\n6 3 100\r\n10000000 2 1000000007\r\n10000000 5000000 1000000014000000049Output:2\r\n21\r\n984650007\r\n780127215155143528",
  "sample_input": "Input:4 2 100\r\n6 3 100\r\n10000000 2 1000000007\r\n10000000 5000000 1000000014000000049Output:2\r\n21\r\n984650007\r\n780127215155143528",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/DTPOLY2",
  "scraped_at": "2025-08-17 00:33:58"
}