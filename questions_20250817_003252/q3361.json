{
  "problem_code": "problems",
  "title": "Permutation Code",
  "tags": [],
  "text": "As the owner of a computer forensics company, you have just been given\r\n     the following note by a new client:I, Albert Charles Montgomery, have just discovered the most amazing\r\n    cypher for encrypting messages. Let me tell you about it.To begin, you will need to decide on a set of symbols, call itS,   perhaps with the lettersRATE. The size of this set must be\r\na  power of 2 and the order of the symbols inSis important.   You must note thatRis at position 0,Aat 1,Tat 2, andEat 3. You will   also need one permutationPof all those symbols, sayTEAR. Finally you will\r\n need an integer, call itx. Together,\r\n these make up the key. Given a key,  you are now ready to convert a plaintext\r\n messageMof lengthn(M[0],M[1]...M[n-1]),\r\n that has some but not necessarily all of the symbols  inS, into  a cyphertext stringC, also of lengthn(C[0],C[1],...C[n-1]),\r\n  that has  some but not necessarily all of the symbols inS.The encrypting algorithm computesCas follows:Calculate an integerdas the remainder after dividing the\r\n integer part of (n1.5+x) byn. This can be expressed more succinctly\r\n asd= (int)(n1.5+x) %n, where \"%\" is the remainder operator.SetC[d] to be the symbol inSwhose position is the  same   as the\r\n position ofM[d] inP.For eachjâ‰ din 0..n-1,\r\n              setC[j] to be the symbol inSwhose position is the  value   obtained\r\n by xor-ing the position ofM[j] inPwith the position  ofM[(j+1)\r\n%n]   inS. Note that the bitwise xor operator\r\n is \"^\" in C, C++, and Java.For example, consider this scenario whereS=RATE,P=TEAR,x=102,M=TEETER, andn=6. To computed, first calculate 61.5+ 102\r\n= 116.696938, then take the remainder after dividing by 6. Sod= 116 % 6 = 2. The following table\r\n shows the steps in filling in the cyphertextC. Note  that the order of the steps is\r\nnot important.012345S=RATEP=TEARM=TEETERC=EM[0] isT,Tis atP[0].M[1] isE,Eis atS[3].C[0] =S[0 xor 3] =S[3]ETM[1]\r\n isE,Eis atP[1].M[2] isE,Eis atS[3].C[1] =S[1 xor 3] =S[2]ETA2 is d. M[2] isE,Eis atP[1], soC[2] =S[1]ETAEM[3]\r\n isT,Tis atP[0].M[4] isE,Eis atS[3].C[3] =S[0 xor 3] =S[3]ETAEAM[4]\r\n isE,Eis atP[1].M[5] isR,Ris atS[0].C[4] =S[1\r\n xor 0] =S[1]ETAEAAM[5]\r\n isR,Ris atP[3].M[0] isT,Tis atS[2].C[5] =S[3 xor 2] =S[1]I have included additional examples of encrypted messages at the\r\n end   of  this note for you to experiment with. However, first, I need to\r\n tell  you about the decryption algorithm.Unfortunately, the next page of the note, with the decrypting algorithm,\r\n     is completely unreadable because it is covered with huge, overlapping,\r\n  messy   ink blots. Given your considerable skill in unravelling puzzles,\r\n your task   is to write the decoder based on your knowledge of the encoding\r\n algorithm.InputThe input for the decoder\r\n   consists of one or more sets of {key, encrypted   message} pairs. The\r\nkey    is on 3 separate lines. The first line contains the  single integerx, 0 <x< 10,000; the second line contains\r\n the stringS; and the third line\r\n contains the stringP, which\r\n   will be a permutation ofS.  The length ofS(and thereforeP)\r\n   will always be one of the following powers of two: 2, 4, 8, 16, or\r\n   32.  Following the key is a line containing\r\n  the encrypted message stringC, which\r\n will contain at least one and at most sixty characters.\r\n The stringsS,P, andCwill not contain whitespace, but may\r\n   contain printable characters other than letters and digits.\r\n The end of the input is a line  which contains\r\n the single integer 0.OutputFor each input set print\r\n  the decrypted string on a single line, as shown    in the  sample output.ExampleInput:102\r\nRATE\r\nTEAR\r\nETAEAA\r\n32\r\nABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,;\r\n;ABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,\r\nMOMCUKZ,ZPD\r\n1956\r\nACEHINT_\r\nACTN_IHE\r\nCIANCTNAAIECIA_TAI\r\n0Output:TEETER\r\nHELLO_WORLD\r\nTHE_CAT_IN_THE_HAT",
  "sample_input": "Input:102\r\nRATE\r\nTEAR\r\nETAEAA\r\n32\r\nABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,;\r\n;ABCDEFGHIJKLMNOPQRSTUVWXYZ._!?,\r\nMOMCUKZ,ZPD\r\n1956\r\nACEHINT_\r\nACTN_IHE\r\nCIANCTNAAIECIA_TAI\r\n0Output:TEETER\r\nHELLO_WORLD\r\nTHE_CAT_IN_THE_HAT",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/PERMCODE",
  "scraped_at": "2025-08-17 00:34:11"
}