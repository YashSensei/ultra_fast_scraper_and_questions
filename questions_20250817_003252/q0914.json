{
  "problem_code": "problems",
  "title": "IOI2009 Mecho",
  "tags": [],
  "text": "Mecho the bear has found a little treasure - the bees' secret honeypot, which is full of honey! He was happily eating his newfound treasure until suddenly one bee saw him and sounded the bee alarm. He knows that at this very moment hordes of bees will emerge from their hives and start spreading around trying to catch him. He knows he has to leave the honeypot and go home quickly, but the honey is so sweet that Mecho doesn't want to leave too soon. Help Mecho determine the latest possible moment when he can leave.Mecho's forest is represented by a square grid ofNbyNunit cells, whose sides are parallel to the north-south and east-west directions. Each cell is occupied by a tree, by a patch of grass, by a hive or by Mecho's home. Two cells are considered adjacent if one of them is immediately to the north, south, east or west of the other (but not on a diagonal). Mecho is a clumsy bear, so every time he makes a step, it has to be to an adjacent cell. Mecho can only walk on grass and cannot go through trees or hives, and he can make at mostSsteps per minute. At the moment when the bee alarm is sounded, Mecho is in the grassy cell containing the honeypot, and the bees are in every cell containing a hive (there may be more than one hive in the forest). During each minute from this time onwards, the following events happen in the following order:If Mecho is still eating honey, he decides whether to keep eating or to leave. If he continues eating, he does not move for the whole minute. Otherwise, he leaves immediately and takes up toSsteps through the forest as described above. Mecho cannot take any of the honey with him, so once he has moved he cannot eat honey again.After Mecho is done eating or moving for the whole minute, the bees spread one unit further across the grid, moving only into the grassy cells. Specifically, the swarm of bees spreads into every grassy cell that is adjacent to any cell already containing bees. Furthermore, once a cell contains bees it will always contain bees (that is, the swarm does not move, but it grows).In other words, the bees spread as follows: When the bee alarm is sounded, the bees only occupy the cells where the hives are located. At the end of the first minute, they occupy all grassy cells adjacent to hives (and still the hives themselves). At the end of the second minute, they additionally occupy all grassy cells adjacent to grassy cells adjacent to hives, and so on. Given enough time, the bees will end up simultaneously occupying all grassy cells in the forest that are within their reach. Neither Mecho nor the bees can go outside the forest. Also, note that according to the rules above, Mecho will always eat honey for an integer number of minutes. The bees catch Mecho if at any point in time Mecho finds himself in a cell occupied by bees.TaskWrite a program that, given a map of the forest, determines the largest number of minutes that Mecho can continue eating honey at his initial location, while still being able to get to his home before any of the bees catch him.Constraints1 ≤N≤ 800 - the size (side length) of the map.1 ≤S≤ 1,000 - the maximum number of steps Mecho can take in each minute.InputThe input contains several test cases.The fist line contains the number of test casesT.Each test case has the form as following:The first line contains the integersNandS, separated by a space.The nextNlines represent the map of the forest. Each of these lines containsNcharacters with each character representing one unit cell of the grid. The possible characters and their associated meanings are as follows:Tdenotes a tree,Gdenotes a grassy cell,Mdenotes the initial location of Mecho and the honeypot, which is also a grassy cell,Ddenotes the location of Mecho's home, which Mecho can enter, but the bees cannot.Hdenotes the location of a hive.Note:It is guaranteed that the map will contain exactly one letterM, exactly one letterDand at least one letterH. It is also guaranteed that there is a sequence of adjacent lettersGthat connects Mecho to his home, as well as a sequence of adjacent lettersGthat connects at least one hive to the honeypot (i.e., to Mecho's initial location). These sequences might be as short as length zero, in case Mecho's home or a hive is adjacent to Mecho's initial location. Also, note that the bees cannot pass through or fly over Mecho's home. To them, it is just like a tree.OutputFor each test case, your program must write to standard output a single line containing a single integer: the maximum possible number of minutes that Mecho can continue eating honey at his initial location, while still being able to get home safely. If Mecho cannot possibly reach his home before the bees catch him, the number your program writes to standard output must be-1instead.ExampleFor the input data:1\r\n7 3\r\nTTTTTTT\r\nTGGGGGT\r\nTGGGGGT\r\nMGGGGGD\r\nTGGGGGT\r\nTGGGGGT\r\nTHHHHHTthe correct result is:1Explanation of the example:After eating honey for one minute, Mecho can take the shortest path directly to the right and he will be home in another two minutes, safe from the bees.For the input data:1\r\n7 3\r\nTTTTTTT\r\nTGGGGGT\r\nTGGGGGT\r\nMGGGGGD\r\nTGGGGGT\r\nTGGGGGT\r\nTGHHGGTthe correct result is:2Explanation of the example:After eating honey for two minutes, Mecho can take steps →↑→ during the third minute, then steps →→→ during the fourth minute and steps ↓→ during the fifth minute.",
  "sample_input": "1\r\n7 3\r\nTTTTTTT\r\nTGGGGGT\r\nTGGGGGT\r\nMGGGGGD\r\nTGGGGGT\r\nTGGGGGT\r\nTHHHHHT",
  "sample_output": "1",
  "link": "https://www.spoj.com/problems/CTOI09_1",
  "scraped_at": "2025-08-17 00:33:10"
}