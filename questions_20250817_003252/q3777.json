{
  "problem_code": "problems",
  "title": "Moon Safari (Hard)",
  "tags": [],
  "text": "Airis a music duo from France.\r\nYou will be told the secret of the critically acclaimed albumMoon Safari: mathematics.\r\nThe goal of your new task is to compute an ethereal sum.Three trips on the moon are provided,Moon(easy),Moon1(medium),Moon2(hard)\r\nwith different constraints.InputThe first line contains an integerT, the number of test cases.\r\nOn the nextTlines, you will be given three integersN,aandr.OutputOutputTlines, one for each test case, withSN,a,r= sum(a^i i^r, foriin [1..N] ).\r\nSince the answer can get very big, output it modulo 109+7.ExampleInput:2\r\n3 4 5\r\n6 7 8Output:16068\r\n329990641ExplanationThe first case is, withN=3,a=4,r=5, about the sum :\r\n4^1 × 1^5 +\r\n4^2 × 2^5 +\r\n4^3 × 3^5 = 4 + 512 + 15552 =16068.\r\n\r\nThe second case is, withN=6,a=7,r=8, about the sum :\r\n7^1 × 1^8 +\r\n7^2 × 2^8 +\r\n7^3 × 3^8 +\r\n7^4 × 4^8 +\r\n7^5 × 5^8 +\r\n7^6 × 6^8 +\r\n7^7 × 7^8 = 204329992069 ≡329990641(mod 10^9+7).Constraints0 < T×r < 2 560 000\r\n1 < N < 10^9\r\n1 < a < 10^9Uniform random input in the range.\r\nMore precise information : there are 5 input files.\r\nIn0 : T<20000 and r <= 128\r\nIn1 : T<2000 and r <= 1250\r\nIn2 : T<200 and r <= 11000\r\nIn3 : T<20 and r <= 100000\r\nIn4 : T<2 and r <= 1000000InformationThis trip can be done with a O(T×r×log(N)) method and some interpreted languages.\r\nEdited(2017-02-11, after compiler changes).\r\nMy non optimal Py3 code got AC under 5s for each of the 5 input files.\r\n@speed addicts : My fastest C code got AC in 0.42s. (approx 0.08s per file)\r\nGood luck and have fun ;-)",
  "sample_input": "Input:2\r\n3 4 5\r\n6 7 8Output:16068\r\n329990641",
  "sample_output": "0 < T×r < 2 560 000\r\n1 < N < 10^9\r\n1 < a < 10^9",
  "link": "https://www.spoj.com/problems/MOON2",
  "scraped_at": "2025-08-17 00:34:32"
}