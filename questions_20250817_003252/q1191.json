{
  "problem_code": "problems",
  "title": "Product of factorials (hard)",
  "tags": [],
  "text": "Fornpositive integer, letF(n) = 1! × 2! × 3! × 4! × ... × n!, product of factorial(i) for i in [1..n],\r\n\r\n\r\n\r\n\r\nForpa prime number, andnan integer,\r\nand letV(p, n) = max({i>=0 integer, such that p^i divides F(n)}).InputThe first line of input contains an integerT, the number of test cases.\r\nOn each of the nextTlines, your are given\r\ntwo integerspa prime number, ande.OutputFor each test case, you have to printV(p, p^e).\r\nAs the answer may not fit in a 64-bit container, just output your answer modulo 10^9+7.ExampleInput:1\r\n2 2Output:5Constraints0 < T < 10^5\r\n1 < p < 10^18, a prime number\r\n0 < e < 10^18pandeare log-uniform independent randomly distributed.Warning: input contains tricky cases too.A single line of human-readable-Python code can get AC in the third of the time limit. A fast C code ends in 0.04s. (edit 2017-02-11, after compiler changes)\r\n;-) Have fun.",
  "sample_input": "Input:1\r\n2 2Output:5",
  "sample_output": "0 < T < 10^5\r\n1 < p < 10^18, a prime number\r\n0 < e < 10^18",
  "link": "https://www.spoj.com/problems/FACTMULP",
  "scraped_at": "2025-08-17 00:33:24"
}