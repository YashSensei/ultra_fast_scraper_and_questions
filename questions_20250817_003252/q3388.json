{
  "problem_code": "problems",
  "title": "Cardsharper",
  "tags": [],
  "text": "Zenek is a well known (at least in Byteotia) card-sharper. He spent most of his best years practicing one card shuffle with his deck ofncards, which for simplicity we will call 1, 2 ...n. Unfortunately, it turns out that knowing this one card shuffleais not enough to earn a good living. To become rich and famous Zenek needs to knowkshufflesc1...ck. As he doesn't have  enough time to learn all of them, he decided to learn only one shufflebso that using bothaandbhe will be able to perform as many ofcias it is possible.Each shuffle is described bynnumberst1,t2...tn. Such description means that after performing shuffle, card that was originally at positioniwill be at positionti.TaskFind shufflebmaximizing number of shuffles that can be performed.InputFirst line containsn(2 ≤n≤ 52). Second line containsnnumbersa1,a2...andescribing shuffle that Zenek already knows. Third line containsk(2 ≤k≤ 6).i-th of the nextklines contains description ofci.OutputFirst line contains description of the shufflebthat Zenek should learn.i-th of the nextklines contains:-1when it is not possible to performciusing onlyaandbm,r1,r2...rm(0 ≤m≤ 500000, 0 ≤ri≤ 106) meaning that applyingar1times, thenbr2times, thenar3times and so on is the same as applying shufflecionce.ExamplesInput:5\r\n2 3 4 5 1\r\n3\r\n1 3 2 4 5\r\n1 2 3 4 5\r\n5 4 3 2 1Output:2 1 3 4 5\r\n3 4 1 1\r\n0\r\n9 1 1 3 1 4 1 1 1 1Input:5\r\n1 2 3 4 5\r\n3\r\n1 3 2 4 5\r\n5 4 3 2 1\r\n1 2 5 4 3Output:1 3 2 4 5\r\n2 0 1\r\n-1\r\n-1",
  "sample_input": "Input:5\r\n2 3 4 5 1\r\n3\r\n1 3 2 4 5\r\n1 2 3 4 5\r\n5 4 3 2 1Output:2 1 3 4 5\r\n3 4 1 1\r\n0\r\n9 1 1 3 1 4 1 1 1 1",
  "sample_output": "Input:5\r\n1 2 3 4 5\r\n3\r\n1 3 2 4 5\r\n5 4 3 2 1\r\n1 2 5 4 3Output:1 3 2 4 5\r\n2 0 1\r\n-1\r\n-1",
  "link": "https://www.spoj.com/problems/CARD",
  "scraped_at": "2025-08-17 00:34:25"
}