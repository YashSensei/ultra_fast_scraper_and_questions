{
  "problem_code": "problems",
  "title": "Zig",
  "tags": [],
  "text": "SeeZZPERMproblem description. This an improved version with more demanding test cases.InputThe input consists of at most 15 test cases. Each case contains a word (W) not longer than 64 letters and one positive number (D <= 1000000000). The letters of each word are in increasing order. Input is terminated by EOF.OutputFor each case output all of the zig-zag permutations of W whose rank is divisible by D, in increasing lexicographic order, one word per line. In the next line print the total number of zig-zag permutations of W. There is no case that produces more than 365 lines of output. Print an empty line after each case.ExampleInput:j 1\r\nabc 2\r\naaabc 1\r\naaabb 2\r\naaaaaaaaaaaaaaaaabbbbbbbbbbbbbbbcccdd 123456\r\naaaaaaaaabbbbbbbbbcccccccccddddddddd 1000000000Output:j\r\n1\r\n\r\nbac\r\ncab\r\n4\r\n\r\nabaca\r\nacaba\r\n2\r\n\r\n1\r\n\r\nbabacbcabacabadabababababababababadab\r\n213216\r\n\r\nabacbcacbdadcdbcadbdacbdacbdadbcbcad\r\nabadadcdcdcdbdbdadbcabacacbdbcbcacab\r\nacabacbcbdbcbdcdadadacbcadbcbcadadbd\r\nacacbcbdacbdcdacbcadbdbcbcadadbdabad\r\nacadbcadbdbcacadbdbcacbdbdacbdbcadac\r\nacbcacbcadbdadadadbcbdcdabacacbdbdbc\r\nacbcbdadbdcdbcbcbcacbdadadadadbcacab\r\nacbdadcdcdadadbdababacbcbcbcacbdbdac\r\nacbdcdbdbcacbcbcadabadbcabadbdcdacad\r\nadacbcacbcbcbdcdcdbdadadabadbdbcacab\r\nadadbcbcadbcabacadbdbcbdabadcdcdacbc\r\nadbcadbcabacbdacacbcbcbdcdadbdadbdac\r\nadbdacababacadadcdbcbcadbdacbcbdcdbc\r\nadbdcdacbdbcbdbcadadadbcadacbcacbcab\r\nadcdbdacadacbdbcbdadacbcbcadbdbcacab\r\nbabacbdcdbdcdbcadcdbcabacacadadbdacb\r\nbacacadbdcdbcbdbdcdacbdacabacadbcadb\r\nbacadcdbcbdabacbcacacadadadcdbdbdbcb\r\nbacbdadacabacadacbdcdbcadbcbdbcbdadc\r\nbadacadbcadacbcbdadbdbcacbcbdcdabadc\r\nbadbcacbdabadcdbcadbdacabacbdacbdcdc\r\nbadbdcdbdadacbcbcacacbdbdacbdadbcaca\r\nbcabacadbdbdacacbdadcdadbcbcbcadacbd\r\nbcacadacbcbdcdbdbcbdbdadadabacbdacac\r\nbcacbdbdcdcdababadacbcadacacbdbdbcad\r\nbcadbcadbdbdcdcdadbcbcacbcababadacad\r\nbcbcabadacadcdadacbdadbcbdcdbcacbdab\r\nbcbcbcadbcadbcadbdadbcbcadabacadadcd\r\nbcbdacbdacbdbcbdadacacbdcdbdadacabac\r\nbcbdbdbdcdacacacbdbcadadbcababacadcd\r\nbdabadcdbdadbcadcdbcbdcdbcabacabacac\r\nbdacbcbcbcadadbcadcdabadbcacbdcdabad\r\nbdadbcabacbcbcababadacadcdcdbdcdacbd\r\nbdbcacacbdbcadbcbdabacbcadacadadbdcd\r\nbdbcbdacacbdadbdcdababadadcdbcacbcac\r\nbdbdbcadbcacadbcadacadbdbdcdbcacacab\r\nbdcdacbdadadbcbcacacbcacabadbdbcadbd\r\nbdcdcdadacadcdbdbcababadbcacbcadbcab\r\ncabacbdcdbdadacacadbcbcacadbcbdbdadb\r\ncacabadcdbdbdbcbcbdacabadbdacbdacadc\r\ncacadcdbcbcbdcdacababacbcadbdbdbdada\r\ncacbdadbdadacbdababacbcbdcdcdcdabacb\r\ncadacadbdabacbcacbdbdcdadbcadadbcbcb\r\ncadbcacbcbdcdbdbcadbcbdadabacbdacada\r\ncadbdbcbdacadbdacadacbdbcbcadbcabadc\r\ncbcabacbcbdadabacbcadbdadcdcdadacbdb\r\ncbcadacadadbdbcacbcadbdbdacbcabadcdb\r\ncbcbcadacbcadadadbcbdacadbcbdbdacadb\r\ncbcbdbcadcdacbdadacbdbcacadacbdabadb\r\ncbdacadacbcbdcdbdabadbcbcacabadcdadb\r\ncbdadbdadabadcdabadcdacbcbcabacbcbdc\r\ncbdbcbdcdbcbdacacbdadadcdababacabadc\r\ncbdcdacbdbcbdadacacadbcabababadcdbdc\r\ncdabadacabadcdbdcdbdbcabadbcbcacadbc\r\ncdacbcbcadabadcdbdbcbcacbdadadabadbc\r\ncdadbcacacbcadadbdbdbcabadbcbcbcadad\r\ncdbcacadbcbdbcadbdadadbdbcacbcadabac\r\ncdbcbdadadacbdbcabacbcbcabadacadcdbd\r\ncdbdbcabadcdbdbdcdacacababadbdacacbc\r\ncdcdacacbcadbcabadbdcdbcbcabadadbdab\r\ndababacbcbcadbdacacbcacbdbdcdadcdadb\r\ndabadbdcdacacadabadcdbdbcbcbcacbdbca\r\ndacadacbdbdbcacbcadbdbcacbcadbdcdaba\r\ndacbcbdadadcdbdacadcdababacbcacbdbcb\r\ndadabadbcbcadcdbdacbcadacadbcbcbdbca\r\ndadbcadadbdcdcdabacbcbdbcacbdbcabaca\r\ndadcdbcacabadadbcabadbcadcdadbcbcbcb\r\ndbcacbcadacadbcacbdadacbcbdacbdbdadb\r\ndbcadcdbcbdbdadbdadbcacbcacacbcabada\r\ndbcbdacbcadbdacbdadbdacbcadbcacadacb\r\ndbdacacbdadbcbcbcbcadbdadbcadbcadaca\r\ndbdbcacadacabacbcadacbdadcdbdbdbcbca\r\ndbdcdabacadadbcbdcdbcacacbcbdbdacaba\r\ndcdacadadbcbcabacbcacbdbcbdbcadadadb\r\ndcdbcadadbcbcadbcbcadabadbdcdbcacaba\r\ndcdcdacabadbdbdacacbcacbdababadbcbdc\r\n76317369490",
  "sample_input": "Input:j 1\r\nabc 2\r\naaabc 1\r\naaabb 2\r\naaaaaaaaaaaaaaaaabbbbbbbbbbbbbbbcccdd 123456\r\naaaaaaaaabbbbbbbbbcccccccccddddddddd 1000000000Output:j\r\n1\r\n\r\nbac\r\ncab\r\n4\r\n\r\nabaca\r\nacaba\r\n2\r\n\r\n1\r\n\r\nbabacbcabacabadabababababababababadab\r\n213216\r\n\r\nabacbcacbdadcdbcadbdacbdacbdadbcbcad\r\nabadadcdcdcdbdbdadbcabacacbdbcbcacab\r\nacabacbcbdbcbdcdadadacbcadbcbcadadbd\r\nacacbcbdacbdcdacbcadbdbcbcadadbdabad\r\nacadbcadbdbcacadbdbcacbdbdacbdbcadac\r\nacbcacbcadbdadadadbcbdcdabacacbdbdbc\r\nacbcbdadbdcdbcbcbcacbdadadadadbcacab\r\nacbdadcdcdadadbdababacbcbcbcacbdbdac\r\nacbdcdbdbcacbcbcadabadbcabadbdcdacad\r\nadacbcacbcbcbdcdcdbdadadabadbdbcacab\r\nadadbcbcadbcabacadbdbcbdabadcdcdacbc\r\nadbcadbcabacbdacacbcbcbdcdadbdadbdac\r\nadbdacababacadadcdbcbcadbdacbcbdcdbc\r\nadbdcdacbdbcbdbcadadadbcadacbcacbcab\r\nadcdbdacadacbdbcbdadacbcbcadbdbcacab\r\nbabacbdcdbdcdbcadcdbcabacacadadbdacb\r\nbacacadbdcdbcbdbdcdacbdacabacadbcadb\r\nbacadcdbcbdabacbcacacadadadcdbdbdbcb\r\nbacbdadacabacadacbdcdbcadbcbdbcbdadc\r\nbadacadbcadacbcbdadbdbcacbcbdcdabadc\r\nbadbcacbdabadcdbcadbdacabacbdacbdcdc\r\nbadbdcdbdadacbcbcacacbdbdacbdadbcaca\r\nbcabacadbdbdacacbdadcdadbcbcbcadacbd\r\nbcacadacbcbdcdbdbcbdbdadadabacbdacac\r\nbcacbdbdcdcdababadacbcadacacbdbdbcad\r\nbcadbcadbdbdcdcdadbcbcacbcababadacad\r\nbcbcabadacadcdadacbdadbcbdcdbcacbdab\r\nbcbcbcadbcadbcadbdadbcbcadabacadadcd\r\nbcbdacbdacbdbcbdadacacbdcdbdadacabac\r\nbcbdbdbdcdacacacbdbcadadbcababacadcd\r\nbdabadcdbdadbcadcdbcbdcdbcabacabacac\r\nbdacbcbcbcadadbcadcdabadbcacbdcdabad\r\nbdadbcabacbcbcababadacadcdcdbdcdacbd\r\nbdbcacacbdbcadbcbdabacbcadacadadbdcd\r\nbdbcbdacacbdadbdcdababadadcdbcacbcac\r\nbdbdbcadbcacadbcadacadbdbdcdbcacacab\r\nbdcdacbdadadbcbcacacbcacabadbdbcadbd\r\nbdcdcdadacadcdbdbcababadbcacbcadbcab\r\ncabacbdcdbdadacacadbcbcacadbcbdbdadb\r\ncacabadcdbdbdbcbcbdacabadbdacbdacadc\r\ncacadcdbcbcbdcdacababacbcadbdbdbdada\r\ncacbdadbdadacbdababacbcbdcdcdcdabacb\r\ncadacadbdabacbcacbdbdcdadbcadadbcbcb\r\ncadbcacbcbdcdbdbcadbcbdadabacbdacada\r\ncadbdbcbdacadbdacadacbdbcbcadbcabadc\r\ncbcabacbcbdadabacbcadbdadcdcdadacbdb\r\ncbcadacadadbdbcacbcadbdbdacbcabadcdb\r\ncbcbcadacbcadadadbcbdacadbcbdbdacadb\r\ncbcbdbcadcdacbdadacbdbcacadacbdabadb\r\ncbdacadacbcbdcdbdabadbcbcacabadcdadb\r\ncbdadbdadabadcdabadcdacbcbcabacbcbdc\r\ncbdbcbdcdbcbdacacbdadadcdababacabadc\r\ncbdcdacbdbcbdadacacadbcabababadcdbdc\r\ncdabadacabadcdbdcdbdbcabadbcbcacadbc\r\ncdacbcbcadabadcdbdbcbcacbdadadabadbc\r\ncdadbcacacbcadadbdbdbcabadbcbcbcadad\r\ncdbcacadbcbdbcadbdadadbdbcacbcadabac\r\ncdbcbdadadacbdbcabacbcbcabadacadcdbd\r\ncdbdbcabadcdbdbdcdacacababadbdacacbc\r\ncdcdacacbcadbcabadbdcdbcbcabadadbdab\r\ndababacbcbcadbdacacbcacbdbdcdadcdadb\r\ndabadbdcdacacadabadcdbdbcbcbcacbdbca\r\ndacadacbdbdbcacbcadbdbcacbcadbdcdaba\r\ndacbcbdadadcdbdacadcdababacbcacbdbcb\r\ndadabadbcbcadcdbdacbcadacadbcbcbdbca\r\ndadbcadadbdcdcdabacbcbdbcacbdbcabaca\r\ndadcdbcacabadadbcabadbcadcdadbcbcbcb\r\ndbcacbcadacadbcacbdadacbcbdacbdbdadb\r\ndbcadcdbcbdbdadbdadbcacbcacacbcabada\r\ndbcbdacbcadbdacbdadbdacbcadbcacadacb\r\ndbdacacbdadbcbcbcbcadbdadbcadbcadaca\r\ndbdbcacadacabacbcadacbdadcdbdbdbcbca\r\ndbdcdabacadadbcbdcdbcacacbcbdbdacaba\r\ndcdacadadbcbcabacbcacbdbcbdbcadadadb\r\ndcdbcadadbcbcadbcbcadabadbdcdbcacaba\r\ndcdcdacabadbdbdacacbcacbdababadbcbdc\r\n76317369490",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ZZPERM2",
  "scraped_at": "2025-08-17 00:34:25"
}