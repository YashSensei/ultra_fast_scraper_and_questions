{
  "problem_code": "problems",
  "title": "Find Linear Recurrence",
  "tags": [],
  "text": "You are given the first $2K$ integers $a_0, a_1, \\ldots, a_{2K-1}$ (modulo $M$) of an infinite integer sequence $(a_i)_{i=0}^{\\infty}$ that satisfies an integer-coefficient linear recurrence relation of order $K$.That is, they satisfy $$   a_n = \\sum_{i=1}^{K} c_i a_{n-i} $$ for $n \\ge K$, where $c_1, \\ldots, c_K$ are integer constants.Find $a_{2K}$ modulo $M$.InputThe first line contains $T$ ($1 \\le T \\le 4000$), the number of test cases.Each test case consists of two lines:First line contains $K$ ($1 \\le K \\le 50$) and $M$ ($1 \\le M < 2^{31}$).Next line contains $2K$ integers $a_0, a_1, \\ldots, a_{2K-1}$ (modulo $M$).Note:$M$ isnot necessarily a prime.OutputFor each test case, output $a_{2K}$ modulo $M$.ExampleInput6\r\n1 16\r\n4 8\r\n1 10\r\n4 8\r\n2 64\r\n13 21 34 55\r\n2 27\r\n13 21 7 1\r\n3 1000000007\r\n32 16 8 4 2 1\r\n2 64\r\n13 21 34 56Output0\r\n6\r\n25\r\n8\r\n500000004\r\n40",
  "sample_input": "6\r\n1 16\r\n4 8\r\n1 10\r\n4 8\r\n2 64\r\n13 21 34 55\r\n2 27\r\n13 21 7 1\r\n3 1000000007\r\n32 16 8 4 2 1\r\n2 64\r\n13 21 34 56",
  "sample_output": "0\r\n6\r\n25\r\n8\r\n500000004\r\n40",
  "link": "https://www.spoj.com/problems/FINDLR",
  "scraped_at": "2025-08-17 00:34:10"
}