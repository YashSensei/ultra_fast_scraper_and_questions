{
  "problem_code": "problems",
  "title": "Happiness",
  "tags": [],
  "text": "You are given an array on N elements a[1], a[2], a[3] ... a[N].Now you will have to answer some queries.In every query, you will be given an interval, [l, r]. For this interval you have to print the total summation of happiness of all the elements of the given array between the interval [l, r].The happiness of an element a[i] between interval [l, r] is: the number of sub-array [lj, rj] where the minimum value between [lj, rj] is equal to a[i]. Here,l ≤ lj≤ i and i ≤ rj≤ r.Now, you have to print the total summation of happiness of all the elements between [l, r].InputThe first line of the input contains the number of test cases T. The first line of each test case contains two numbers, N and M. N is the number of elements in array a and M is the number of queries you need to perform.The next line contains N integers, the array a: a[1], a[2], a[3] ... a[N].Next M lines contains two integers, l and r.Constraints1 ≤ T ≤ 51 ≤ N, M ≤ 500001 ≤ a[i] ≤ 10000000001 ≤ l ≤ r ≤ NOutputFor each test case, you need to print the case number on the first line in this format: Case X: where X is the case number.In the next M lines, you need to print the total summation of happiness of all the elements between [l, r] of the given array.ExampleInput:25 21 3 2 4 31 32 45 25 3 7 6 81 42 5Output:Case 1:66Case 2:1010Problem Setter: Raihat Zaman Neloy. Used in Eid 2016 contest. For more about Eid 2016 contest:Click Here",
  "sample_input": "Input:25 21 3 2 4 31 32 45 25 3 7 6 81 42 5Output:Case 1:66Case 2:1010",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/HAPPINESS",
  "scraped_at": "2025-08-17 00:34:18"
}