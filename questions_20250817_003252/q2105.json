{
  "problem_code": "problems",
  "title": "Palindromic DNA",
  "tags": [],
  "text": "A DNA sequence is composed of a series of four possible nucleobases, namely Adenine, Guanine, Thymine and Cytosine; we will refer to each of these bases by their initial. For our purposes, nucleobases have an associated cyclic “order”:Ais followed byG, which in turn is followed byT, which is followed byC, which is followed byAagain. State-of-the-art research in genomics has revealed the startling fact that many diseases are caused by certain subsequences of bases not forming a palindromic sequence! Your mission as a leading researcher at ICPC laboratories is to take a DNA stringSand a series of subsetsP1...Ptof indices to characters (nucleobases) inS, and transformSso that each of the restrictions of the resulting string toP1...Ptare palindromic. (The restriction ofSto a subsetP= {i1,i2...ik} of indices, where 0 ≤i1<i2< ... <ik< |S|, is the stringSi1Si2…Sik). It is possible to inspect any base ofSat will, but only three transformations can be applied to a base:Leave it unaltered.Increase it by 1 in the cyclic order of nucleobases (e.g. turnCintoA).Decrease it by 1 (e.g. turnTintoG).Moreover, owing to limitations of current technology, it is impossible to modify two bases in consecutive positions of the sequence. Is our goal achievable?By way of example, consider DNA sequenceAGTAT. Number positions starting from 0, and suppose we have the three subsetsP1= {1, 4},P2= {0, 1} andP3= {0, 2, 4}. One solution is to increase the first character and decrease the last, yieldingS′ =GGTAG. The restrictions ofS′ toP1,P2andP3areGG,GGandGTG, respectively; all of them are palindromic.One case where no solution is possible is when the string isCATGC, and we require the subsequences determined by positions {0,3} and {3,4} be palindromic. Here, characters 3, 0 and 4 would all need to become aT. But this entails modifying consecutive characters 3 and 4, which is not allowed.InputThe first line of each test case has two integersNandT(1 ≤N≤ 10 000, 1 ≤T≤ 6 000), the sequence length and number of subsets to consider. The next line contains the DNA sequence of lengthN, all of whose characters are inACGT. The subsets are described by the followingTlines. Each line starts by “L:”, whereL(0 ≤L≤N) is the number of positions in the subset, and is followed byTdistinct integers between 0 andN− 1 in increasing order. Subsets may overlap partially or totally.A blank line separates different test cases. The input file is terminated by a line containing0 0.OutputIn a single line per test case, printYESif the task is solvable andNOotherwise.ExampleInput:5 3\r\nAGTAT\r\n2: 1 4\r\n2: 0 1\r\n3: 0 2 4\r\n\r\n5 3\r\nCATGC\r\n0:\r\n2: 0 3\r\n2: 3 4\r\n\r\n0 0Output:YES\r\nNOProblem setter: David García Soriano",
  "sample_input": "Input:5 3\r\nAGTAT\r\n2: 1 4\r\n2: 0 1\r\n3: 0 2 4\r\n\r\n5 3\r\nCATGC\r\n0:\r\n2: 0 3\r\n2: 3 4\r\n\r\n0 0Output:YES\r\nNO",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/PALINDNA",
  "scraped_at": "2025-08-17 00:33:54"
}