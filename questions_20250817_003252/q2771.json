{
  "problem_code": "problems",
  "title": "Recursive Sequence (Version III)",
  "tags": [],
  "text": "Sequence(ai)of natural numbers is defined as follows:ai= biifi ≤ kai= c1ai-1+ c2ai-2+ ... +  ckai-kifi > kwherebjandcjare given natural numbers for1≤ j≤k. Your task is to computea2m+a2m+1+a2m+2+ ... +a2nfor givenm≤nand output it modulo a given positive integerp(not necessarily prime).InputOn the first row there is the numberTof test cases (T≤50).Each following test case contains four lines:k- number of elements of(c)and(b)(1≤k≤15)b1... bk-knatural numbers where0≤bj≤109separated by spacesc1... ck-knatural numbers where0≤cj≤109separated by spacesm,n,p- natural numbers separated by spaces (1≤m≤n≤1018,1≤p≤108)OutputExactlyTlines, one for each test case:  (a2m+a2m+1+a2m+2+ ... +a2n) modulop.ExampleInput:232 3 51 2 310 15 100000015401 131 940 406 673 592 532 452 733 966 602 600 61 212 25713 12 81 75 37 12 10 35 25 75 16 90 27 33 472 85704376 99999991Output:24878332397016NoteYou can try the problemSPPfirst.",
  "sample_input": "Input:232 3 51 2 310 15 100000015401 131 940 406 673 592 532 452 733 966 602 600 61 212 25713 12 81 75 37 12 10 35 25 75 16 90 27 33 472 85704376 99999991Output:24878332397016",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/SPP3",
  "scraped_at": "2025-08-17 00:33:58"
}