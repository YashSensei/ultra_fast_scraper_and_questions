{
  "problem_code": "problems",
  "title": "Alice in Amsterdam, I mean Wonderland",
  "tags": [],
  "text": "This is a fact that not many people know, but Alice lived in Amsterdam. Yes, there you go. And as many kids of the time, she used to go for some medicinal mushrooms to the drug store (the pharmacies, the coffee shops didn't exist yet). Usually, between the regular mushrooms, a magical one could be found, producing as expected, deep and vivid hallucinations. During one of those hallucinations, Alice was transported to a \"wonderland\", where many weird things happened. One thing was particularly dazzling for her: even though everything looked pretty familiar, the distance between monuments of the city was sometimes negative!!! Although, zero distance between two different monuments means a direct path doesn't exist. A loop from a given monument right back to it can be of length zero (with means that it can be reached instantly like in real life) or negative, like for regular paths. Alice also thought that she saw some positive distances for loops, but we should treat those cases as zero distance.Now, as a very smart girl as she is, she figured out a way to find the shortest path between any two monuments. Unfortunately, as expected, Alice forgot it when she got sober again. She was only able to remember that, in some cases, she could get stuck in a cycle path with negative distance. In such cases, there will always be a cheaper path to get to the same monument. This was one of the few things that had perfect sense for her: Your shortest path will be shorter if you take that cycle again and again, to infinity. Alice, has been trying to figure optimal distances all over again, but she can't. She doesn't want to trip again, she has been clean for longer than a year (good for her!!). Would you be so kind to help her?Given a list of monuments in a city, and their relative distances, find the shortest paths between some pairs of monuments.InputEach case, starts with one line containingN, the number of monuments in the test case (1 ≤N≤ 100). Next N lines will each contain one stringKandNintegersKj, separated by single spaces.Kis a name of a monument and will consist of at most 20 alphanumeric characters. Each integerKj(0 ≤j<N) in lineidescribes the distance from monument i to j (-230≤Kj≤ 230). Next line will contain a single integerQ(1 ≤Q≤N2). It will be followed by Q lines, each with a pair of integers (U,V), indicating the start and destination monument for the path that is queried (0 ≤U,U<N).End of the input is indicated by a test case withN= 0 and should not be processed.OutputFor each test case, print a line \"Case #tc:\" (without quotes), where tc is the case number, starting from 1. NextQlines should describe query results. If the optimal distance can be infinitely small, print only \"NEGATIVE CYCLE\". In other cases, start the line with \"start_name-destination_name\" followed by the actual result. If the destination can't be reached, print \"NOT REACHABLE\", otherwise print the integer distance.ExampleInput:2Nieuwkerk -1 1Oudekerk 1 040 00 11 11 03Nieuwkerk 0 -5 0Oudekerk 10 0 0Pierteck -100 -100 090 00 10 21 01 11 22 02 12 20Output:Case #1:NEGATIVE CYCLENEGATIVE CYCLENEGATIVE CYCLENEGATIVE CYCLECase #2:Nieuwkerk-Nieuwkerk 0Nieuwkerk-Oudekerk -5Nieuwkerk-Pierteck NOT REACHABLEOudekerk-Nieuwkerk 10Oudekerk-Oudekerk 0Oudekerk-Pierteck NOT REACHABLEPierteck-Nieuwkerk -100Pierteck-Oudekerk -105Pierteck-Pierteck 0",
  "sample_input": "Input:2Nieuwkerk -1 1Oudekerk 1 040 00 11 11 03Nieuwkerk 0 -5 0Oudekerk 10 0 0Pierteck -100 -100 090 00 10 21 01 11 22 02 12 20Output:Case #1:NEGATIVE CYCLENEGATIVE CYCLENEGATIVE CYCLENEGATIVE CYCLECase #2:Nieuwkerk-Nieuwkerk 0Nieuwkerk-Oudekerk -5Nieuwkerk-Pierteck NOT REACHABLEOudekerk-Nieuwkerk 10Oudekerk-Oudekerk 0Oudekerk-Pierteck NOT REACHABLEPierteck-Nieuwkerk -100Pierteck-Oudekerk -105Pierteck-Pierteck 0",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/UCV2013B",
  "scraped_at": "2025-08-17 00:34:00"
}