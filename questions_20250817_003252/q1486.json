{
  "problem_code": "problems",
  "title": "Chiaki Sequence",
  "tags": [],
  "text": "Chiaki is interested in an infinite sequence $a_1, a_2, a_3, ...$, which defined as follows: $$a_n = \\begin{cases} n, & n \\le 2 \\\\ 2 \\cdot a_{n-1}, & n \\text{ is odd} \\\\ a_{n-1}+r_{n-1}, & n \\text{ is even}\\end{cases}$$  where $r_n$ is the smallest positive integer not in the set $S_n = \\{a_j - a_i \\mid 1 \\le i < j \\le n\\}$.Chiaki would like to know the sum of the first $n$ terms of the sequence, i.e. $\\sum\\limits_{i=1}^{n} a_n$. As this number may be very large, Chiaki is only interested in its remainder modulo ($10^9 + 7$).InputThere are multiple test cases. The first line of input contains an integer $T$ ($1 \\le T \\le 1000$), indicating the number of test cases. For each test case:The first line contains an integer $n$ ($1 \\le n < 10^{100}$) without leading zeros.OutputFor each test case, output an integer denoting the answer.ExampleInput11\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n1000000000Output1\r\n3\r\n7\r\n15\r\n31\r\n52\r\n94\r\n145\r\n247\r\n359\r\n834069170InformationThere are $5$ input files and my unoptimized python3 code runs about 1.1 sec per file.",
  "sample_input": "11\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n1000000000",
  "sample_output": "1\r\n3\r\n7\r\n15\r\n31\r\n52\r\n94\r\n145\r\n247\r\n359\r\n834069170",
  "link": "https://www.spoj.com/problems/A001856",
  "scraped_at": "2025-08-17 00:33:35"
}