{
  "problem_code": "problems",
  "title": "Mining your own business",
  "tags": [],
  "text": "John Digger is the owner of a large illudium phosdex mine. The mine is made up of a series of tunnels that meet at various large junctions. Unlike some owners, Digger actually cares about the welfare of his workers and has a concern about the layout of the mine. Specifically, he worries that there may a junction which, in case of collapse, will cut off workers in one section of the mine from other workers (illudium phosdex, as you know, is highly unstable). To counter this, he wants to install special escape shafts from the junctions to the surface. He could install one escape shaft at each junction, but Digger doesn't care about his workers that much. Instead, he wants to install the minimum number of escape shafts so that if any of the junctions collapses, all the workers who survive the junction collapse will have a path to the surface.Write a program to calculate the minimum number of escape shafts and the total number of ways in which this minimum number of escape shafts can be installed.InputThe input consists of several test cases. The first line of each case contains a positive integerN(Nâ‰¤ 5x104)indicating the number of mine tunnels. Following this areNlines each containing two distinct integerssandt, wheresandtare junction numbers. Junctions are numbered consecutively starting at 1. Each pair of junctions is joined by at most a single tunnel. Each set of mine tunnels forms one connected unit (that is, you can get from any one junction to any other).The last test case is followed by a line containing a single zero.OutputFor each test case, display its case number followed by the minimum number of escape shafts needed for the system of mine tunnels and the total number of ways these escape shafts can be installed. You may assume that the result fits in a signed 64-bit integer.Follow the format of the sample output.ExampleInput:9\r\n1 3\r\n4 1\r\n3 5\r\n1 2\r\n2 6\r\n1 5\r\n6 3\r\n1 6\r\n3 2\r\n6\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0Output:Case 1: 2 4\r\nCase 2: 4 1",
  "sample_input": "Input:9\r\n1 3\r\n4 1\r\n3 5\r\n1 2\r\n2 6\r\n1 5\r\n6 3\r\n1 6\r\n3 2\r\n6\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0Output:Case 1: 2 4\r\nCase 2: 4 1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/BUSINESS",
  "scraped_at": "2025-08-17 00:33:35"
}