{
  "problem_code": "problems",
  "title": "Strange Food Chain",
  "tags": [],
  "text": "There are 3 kinds of animals A, B and C. A can eat B, B can eat C, C can eat A. It's interesting, isn't it?Now we have n animals, numbered from 1 to n. Each of them is one of the 3 kinds of animals: A, B, C.Today Mary tells us k pieces of information about these n animals. Each piece has one of the two forms below:1 x y: It tells us the kind of x and y are the same.2 x y: It tells us x can eat y.Some of these k pieces are true, some are false. The piece is false if it satisfies one of\r\nthe 3 conditions below, otherwise it's true.X or Y in this piece is larger than n.This piece tells us X can eat X.This piece conflicts to some true piece before.InputThe first line contains a single integer t. t blocks follow.For every block, the first line contains two integers n (1 ≤ n ≤ 50000) and k (1 ≤ k ≤ 100000).\r\nk lines follow, each contains 3 positive integers D (1 ≤ D ≤ 2), X, Y, separated by single spaces.OutputOutput t lines, each contains a single integer - the number of false pieces in the corresponding block.ExampleInput:1\r\n100 7\r\n1 101 1\r\n2 1 2\r\n2 2 3\r\n2 3 3\r\n1 1 3\r\n2 3 1\r\n1 5 5Output:3HintThe false pieces are the 1st, the 4th and the 5th ones.Warning: large Input/Output data, be careful with certain languages.",
  "sample_input": "Input:1\r\n100 7\r\n1 101 1\r\n2 1 2\r\n2 2 3\r\n2 3 3\r\n1 1 3\r\n2 3 1\r\n1 5 5Output:3",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/CHAIN",
  "scraped_at": "2025-08-17 00:33:23"
}