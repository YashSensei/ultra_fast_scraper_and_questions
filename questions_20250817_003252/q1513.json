{
  "problem_code": "problems",
  "title": "Another Travelling Salesman Problem",
  "tags": [],
  "text": "Ariel is a travelling salesman in his own world. Ariel wants to buy some toys at cityXand sells them at cityY(Xcan be equal toY).His world forms a weighted tree. The cost to travel from cityXto cityYis the sum of weight of the edges between cityXand cityY.You are givenA[i],B[i]—A[i]denotes the maximum number of toys that Ariel can buy at cityi, andB[i]denotes the price of buying or selling one toy in cityi.Ariel can choose two cities. Let it beXandY. such that he can buy some toy at cityX, travel betweenXandY, and sell some toy at cityY. Ariel can only buy some toy at no more than one city, and can only sell some toy at no more than one city.Help Ariel to maximize his profit.InputFirst line contains an integer N.Second line contains N integer A[i].Third line contains N integer B[i].The next N-1 lines contains U V and W, there is an edge between U and V with weight W.OutputOne integer that denote maximum profit Ariel can get.Constraints2 ≤ N ≤ 1e5.1 ≤ A[i], B[i], W ≤ 1e9.1 ≤ U, V ≤ NExampleInput:4\r\n10 10 10 10\r\n5 5 5 5\r\n1 2 1\r\n2 3 1\r\n3 4 1Output:0Input:5\r\n1 9 4 16 5 \r\n20 5 10 15 19 \r\n2 1 6\r\n2 3 6\r\n2 4 7\r\n3 5 4Output:129Input:10\r\n9 7 5 19 7 2 10 7 2 4 \r\n16 17 13 2 2 19 14 18 4 1\r\n9 1 4\r\n1 2 7\r\n10 3 5\r\n2 4 6\r\n7 5 5\r\n7 6 1\r\n5 8 7\r\n5 9 10\r\n7 10 1Output:290",
  "sample_input": "Input:4\r\n10 10 10 10\r\n5 5 5 5\r\n1 2 1\r\n2 3 1\r\n3 4 1Output:0",
  "sample_output": "Input:5\r\n1 9 4 16 5 \r\n20 5 10 15 19 \r\n2 1 6\r\n2 3 6\r\n2 4 7\r\n3 5 4Output:129",
  "link": "https://www.spoj.com/problems/YOSALES",
  "scraped_at": "2025-08-17 00:33:37"
}