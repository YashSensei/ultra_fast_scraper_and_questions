{
  "problem_code": "problems",
  "title": "Amazing Factor Sequence (hard)",
  "tags": [],
  "text": "Let $s_1(n)$ be the sum of positiveproperdivisors of $n$.For example, $s_1(1) = 0$, $s_1(2) = 1$ and $s_1(6) = 6$.Let $$S(n) = \\sum _{i=1}^n s_1(i).$$Given $N$, find $S(N)$.InputFirst line contains $T$Â ($1 \\le T \\le 10^5$), the number of test cases.Each of the next $T$ lines contains a single integer $N$. ($1 \\le N < 2^{63}$)OutputFor each number $N$, output a single line containing $S(N)$.ExampleInput6\r\n1\r\n2\r\n3\r\n10\r\n100\r\n1000000000000000000Output0\r\n1\r\n2\r\n32\r\n3249\r\n322467033424113218863487627735401433InformationThere are 6 Input files.- Input #1: $1 \\le N \\le 10^5$, TL = 2s.- Input #2: $1 \\le T \\le 60,\\ 1 \\le N \\le 10^{15}$, TL = 10s.- Input #3: $1 \\le T \\le 25,\\ 1 \\le N \\le 10^{16}$, TL = 10s.- Input #4: $1 \\le T \\le 10,\\ 1 \\le N \\le 10^{17}$, TL = 10s.- Input #5: $1 \\le T \\le 5,\\ 1 \\le N \\le 10^{18}$, TL = 10s.- Input #6: $1 \\le T \\le 2,\\ 1 \\le N < 2^{63}$, TL = 10s.My C++ solution runs in about 0.85 seconds for each Input #2 - #6.NoteProbably, $O(\\sqrt{n})$ solutions will not pass.Intended solutions have a running time of about $O(n^{1/3} \\log n)$.Time limits are somewhatstrict.The answer can be $\\ge 2^{64}$.DIVCNT1is a little easier than this.",
  "sample_input": "6\r\n1\r\n2\r\n3\r\n10\r\n100\r\n1000000000000000000",
  "sample_output": "0\r\n1\r\n2\r\n32\r\n3249\r\n322467033424113218863487627735401433",
  "link": "https://www.spoj.com/problems/AFS3",
  "scraped_at": "2025-08-17 00:34:06"
}