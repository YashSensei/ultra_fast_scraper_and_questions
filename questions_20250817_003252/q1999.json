{
  "problem_code": "problems",
  "title": "Delta catheti II (Hard)",
  "tags": [],
  "text": "(3, 4, 5)is a famous Pythagorean triple,\r\nit gives a quick answer to the question:\r\n\r\nFor a given integerd, is there a Pythagorean triple(a, b, c)such thatb - a = d?A solution is(3d, 4d, 5d),\r\n and in fact one can easily prove that the set of solutions is infinite, and\r\nthat there is an obvious total order on those solutions.\r\nGivenn, you'll have to find thenth term of the sequence of solutions.Geometrically, it is the study of right angle triangles for which the difference of the\r\ncatheti is equal tod.InputThe first line of input contains an integerT, the number of test cases.2Tlines follow. Each case is on two lines.\r\nThe first line of the case contains\r\n three integersn, d, m.\r\nThe second line contains an integerLand2Lother integers (p, e) ; this gives the prime factorization ofdin standard format (d = product p^e).OutputFor each test case, compute thenth term amongst\r\nthe solutions(a, b, c)for the problem :a2+ b2= c2withb - a = dand0 < a < b < c.As the answer could not fit in a 64-bit container, simply output your answer modulom.ExampleInput:3\r\n1 1 235813\r\n0\r\n3 21 1000\r\n2 3 1 7 1\r\n9 119 11\r\n2 7 1 17 1Output:3 4 5\r\n63 84 105\r\n5 3 1ExplanationsFor the first case, the first solution is(3, 4, 5), as 4 - 3 = 1.For the second case, the first solutions are:(15, 36, 39), (24, 45, 51), (63, 84, 105), (144, 165, 219), (195, 216, 291), (420, 441, 609), ...The third one is(63, 84, 105).For the third case, the first solutions are:(24, 143, 145), (49, 168, 175), (57, 176, 185), (85, 204, 221), (136, 255, 289),\r\n (180, 299, 349), (196, 315, 371), (261, 380, 461), (357, 476, 595), (481, 600, 769),\r\n (616, 735, 959), ...The 9th solution is(357, 476, 595), reduced modulo 11, we get(5, 3, 1).Constraints0 < T < 10^4\r\n0 < n < 10^18\r\n0 < d < 10^14\r\n1 < m < 10^9dis the product of two integers lower than 10^7.n, d1, d2, m: Uniform randomly chosen in their range.\r\nThose constraints are set to allow C-like users to work only with 64bit containers.For your information, my 3kB-python3 code get AC in 1.22s. (Edit 2017-02-11, after compiler change)\r\nIt should be much faster with a compiled language.Warning: It's my hardest problem.\r\nHave fun ;-)",
  "sample_input": "Input:3\r\n1 1 235813\r\n0\r\n3 21 1000\r\n2 3 1 7 1\r\n9 119 11\r\n2 7 1 17 1",
  "sample_output": "Output:3 4 5\r\n63 84 105\r\n5 3 1",
  "link": "https://www.spoj.com/problems/DELTACA2",
  "scraped_at": "2025-08-17 00:34:02"
}