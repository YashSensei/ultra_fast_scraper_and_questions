{
  "problem_code": "problems",
  "title": "Word equations",
  "tags": [],
  "text": "Every non-empty sequence of elements 0 and 1 is called a binary word. A word equation is an equation of the formx1x2...xl=y1y2...yr, wherexiandyjare binary digits (0 or 1) or variables i.e. small letters of English alphabet. For every variable there is a fixed length of the binary words that can be substituted for this variable. This length is called a length of variable. In order to solve a word equation we have to assign binary words of appropriate length to all variables (the length of the word assigned to the variablexhas to be equal to the length of this variable) in such a way that if we substitute words for variables then both sides of the equation (which are binary words after substitution) become equal.For a given equation compute how many distinct solutions it has.ExampleLeta,b,c,d,ebe variables and let 4, 2, 4, 4, 2 be their lengths (4 is the length ofa, 2 is the length ofbetc.). Consider the equation:1bad1 = acbeThis equation has 16 distinct solutions.InputThe number of equationstis in the first line of input, thentdescriptions of equations follow separated by an empty line.Each description consists of 6 lines. An equation is described in the following way: in the first line of the description there is an integerk, 0 <=k<= 26, which denotes the number of distinct variables in the equation. We assume that variables are the firstksmall letters of English alphabet. In the second line there is a sequence ofkpositive integers separated by single spaces. These numbers denote the lengths of variablesa,b, ... from the equation (the first number is the length ofa, the second -b, etc.). There is an integerlin the third line of the description, which is the length of the left size of equation, i.e. the length of the word built of digits 0 or 1 and variables (single letters). The left side of the equation is written in the next line as a sequence of digits and variables with no spaces between them. The next two lines contain the description of the right side of the equation. The first of these lines contains a positive integerr, which is the length of the right side of the equation. The second line contains the right side of the equation which is encoded in the same way as the left side. The number of digits plus sum of the lengths of variables (we count all appearances of variables) on each side of the equation is not greater than 10000.OutputFor each equation your program should output one line with the number of distinct solutions.ExampleInput:1\r\n5\r\n4 2 4 4 2\r\n5\r\n1bad1\r\n4\r\nacbeOutput:16",
  "sample_input": "Input:1\r\n5\r\n4 2 4 4 2\r\n5\r\n1bad1\r\n4\r\nacbeOutput:16",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/WORDEQ",
  "scraped_at": "2025-08-17 00:33:14"
}