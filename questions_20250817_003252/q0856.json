{
  "problem_code": "problems",
  "title": "Ada and Zoo",
  "tags": [],
  "text": "Ada the Ladybug is a well know farmer. As she has experience with building fences and breeding animals, she was asked by leader of local zoo - Lichsteiner Leech - to help them design a paddock for animals.The problem is following: The zoo breeds very rare beasts called Tyg3Rs. There are few of them in aN x Nsquare paddock with squares have different heights. The Tyg3Rs live in (little) squares and the breeders want them to play with each other. At first it is not possible to travel between distinct squares, but it is possible to connect any two adjacent squares for cost of absolute difference of their heights (by making slope).Now, for each subset of Tyg3Rs, the zoo wants to know minimal price to connect the squares in such way, that each Tyg3R can get to each other. As the output would be pretty big, they just want you to sum these costs.As her good friend (and as the instances are too big for her to handle), she has asked you to help her with this problem.InputThe first line containsT, the number of test-cases.The first line of each test-case contains2 ≤ N ≤ 17, the size of big square.Each of the nextNlines containNintegers, the heights of each square. Each number is between0and1000.The next line contains1 ≤ Q ≤ 10, the number of Tyg3Rs.The nextQlines contains two integers:0 ≤ x, y < N, the coordinates of Tyg3Rs. Note that multiple Tyg3Rs might already live in the same square.OutputFor each test-case print the sum of costs of cheapest way to connect all subset of Tyg3Rs.Example Input4\r\n3\r\n1 2 1\r\n2 1 2\r\n1 2 1\r\n3\r\n0 0\r\n0 2\r\n2 1\r\n3\r\n5 5 5\r\n7 5 5\r\n3 4 4\r\n4\r\n0 0\r\n0 0\r\n0 0\r\n2 0\r\n3\r\n1 2 3\r\n4 5 6\r\n7 8 9\r\n2\r\n0 0\r\n2 2\r\n8\r\n1 8 5 2 3 6 7 4\r\n1 5 7 5 4 6 8 7\r\n9 8 7 4 5 2 3 6\r\n1 4 5 7 2 5 3 6\r\n5 2 1 2 4 5 8 5\r\n9 9 9 9 6 6 4 5\r\n2 2 3 4 9 1 9 1\r\n1 4 1 4 7 5 2 1\r\n5\r\n0 0\r\n5 6\r\n3 3\r\n2 1\r\n7 7Example Output12\r\n14\r\n8\r\n441Input ExplanationPrices of subsets of first test-case000: 0\r\n100: 0\r\n010: 0\r\n001: 0\r\n110: 2\r\n101: 3\r\n011: 3\r\n111: 4For the second test-case, each subset costs 0, unless those, which consists of last Tyg3R (and some other) - those cost 2.The third test-case has only one valuable subset (of both Tyg3Rs), which goes on top/right border, and costs 8.",
  "sample_input": "4\r\n3\r\n1 2 1\r\n2 1 2\r\n1 2 1\r\n3\r\n0 0\r\n0 2\r\n2 1\r\n3\r\n5 5 5\r\n7 5 5\r\n3 4 4\r\n4\r\n0 0\r\n0 0\r\n0 0\r\n2 0\r\n3\r\n1 2 3\r\n4 5 6\r\n7 8 9\r\n2\r\n0 0\r\n2 2\r\n8\r\n1 8 5 2 3 6 7 4\r\n1 5 7 5 4 6 8 7\r\n9 8 7 4 5 2 3 6\r\n1 4 5 7 2 5 3 6\r\n5 2 1 2 4 5 8 5\r\n9 9 9 9 6 6 4 5\r\n2 2 3 4 9 1 9 1\r\n1 4 1 4 7 5 2 1\r\n5\r\n0 0\r\n5 6\r\n3 3\r\n2 1\r\n7 7",
  "sample_output": "12\r\n14\r\n8\r\n441",
  "link": "https://www.spoj.com/problems/ADAZOO",
  "scraped_at": "2025-08-17 00:33:15"
}