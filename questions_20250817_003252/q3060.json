{
  "problem_code": "problems",
  "title": "Ada and Tomel",
  "tags": [],
  "text": "As you might already know, Ada the Ladybug is a farmer. She grows a tomeltree. Tomel indeed is a very specific tree. Its growing process starts with one root node with a fruit of random flavor. Whenever a next branch grows, it begins to grow from a random node which is already grown up. No growing starts until the branch is fully grown. As a branch fully grows up, a node with fruit with random flavor appears at the end of the branch.As you surely haven't heard word random for a long time, Ada chooses three random paths and wants to find the number of distinct flavors which grow on the union of these three paths.NOTE:Every random mentioned above is really meant to be random with equal probability for each possible values.InputThe first line of input will contain three integersN, K, Q:1     ≤ N, Q ≤  3×105, 1 ≤ K ≤ 1000, the number of nodes of tomel tree, the universe of flavors and the number of Ada's questions.The next line will containN-1integers0 ≤ Pi<     iis the parent ofithnode (hereigoes from1toN-1).The next line will containNintegers1 ≤ Fi≤ K, the flavor of each fruit.The nextQlines will contain six integers0 ≤ B, E, X, Y, L,     R < N, where the pairs of beginnings/ends of the paths are: (B,     E), (X, Y),  (L, R)OutputFor each query output the number of distinct flavors which are on the three paths.Example Input5 2 5\r\n0 0 0 2\r\n1 1 1 1 2\r\n3 2 3 1 1 4\r\n1 0 2 4 2 3\r\n2 1 4 3 1 0\r\n1 3 3 0 3 1\r\n4 2 0 3 4 1Example Output2\r\n2\r\n2\r\n1\r\n2Example Input7 3 7\r\n0 0 0 1 2 3\r\n1 3 2 2 2 1 1\r\n3 2 3 6 3 5\r\n0 2 6 0 4 2\r\n3 6 3 0 2 0\r\n2 0 4 0 2 0\r\n1 5 5 3 2 6\r\n1 2 0 5 0 6\r\n0 4 5 3 2 0Example Output2\r\n3\r\n2\r\n3\r\n3\r\n3\r\n3Example Input8 5 7\r\n0 1 0 1 3 0 3\r\n1 1 4 2 3 1 3 1\r\n1 4 2 3 2 4\r\n3 1 4 2 3 6\r\n6 0 0 7 0 6\r\n3 4 2 1 3 4\r\n5 1 0 1 2 1\r\n5 2 4 5 7 6\r\n2 5 1 6 7 2Example Output4\r\n4\r\n3\r\n4\r\n3\r\n4\r\n4Example Input12 6 10\r\n0 1 0 2 0 4 4 5 6 6 5\r\n5 4 1 5 3 5 3 5 4 6 4 6\r\n3 9 5 3 5 7\r\n10 8 10 11 6 0\r\n11 6 8 11 3 9\r\n9 2 6 4 8 5\r\n6 5 10 0 2 5\r\n9 11 2 3 2 9\r\n2 3 1 6 10 7\r\n5 2 3 1 9 3\r\n3 4 6 3 6 4\r\n3 8 2 5 0 8Example Output5\r\n5\r\n5\r\n5\r\n4\r\n5\r\n4\r\n5\r\n4\r\n3Example Input20 10 22\r\n0 1 2 0 4 5 3 6 8 2 7 2 9 8 13 2 16 10 16\r\n6 7 3 10 7 2 10 6 7 3 6 1 1 3 9 9 8 2 9 3\r\n4 13 5 0 17 7\r\n0 2 8 6 8 13\r\n9 19 12 14 5 13\r\n12 14 9 19 5 18\r\n6 4 9 12 2 16\r\n0 1 11 14 14 0\r\n11 4 17 5 1 13\r\n7 16 1 7 8 15\r\n7 1 14 12 8 16\r\n9 8 18 1 4 18\r\n14 8 4 2 2 12\r\n4 16 3 5 10 19\r\n1 6 7 16 11 12\r\n11 0 5 18 12 8\r\n14 17 0 18 3 19\r\n10 12 5 6 4 10\r\n18 19 14 3 15 9\r\n3 9 13 19 1 18\r\n0 5 3 18 1 16\r\n9 19 12 1 13 7\r\n0 2 7 13 16 19\r\n0 11 3 13 12 4Example Output6\r\n4\r\n8\r\n8\r\n7\r\n7\r\n7\r\n6\r\n8\r\n4\r\n5\r\n6\r\n7\r\n7\r\n7\r\n6\r\n7\r\n7\r\n7\r\n7\r\n6\r\n6",
  "sample_input": "5 2 5\r\n0 0 0 2\r\n1 1 1 1 2\r\n3 2 3 1 1 4\r\n1 0 2 4 2 3\r\n2 1 4 3 1 0\r\n1 3 3 0 3 1\r\n4 2 0 3 4 1",
  "sample_output": "2\r\n2\r\n2\r\n1\r\n2",
  "link": "https://www.spoj.com/problems/ADATOMEL",
  "scraped_at": "2025-08-17 00:34:23"
}