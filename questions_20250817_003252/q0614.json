{
  "problem_code": "problems",
  "title": "LCM GCD Love",
  "tags": [],
  "text": "Bob fell in love with LCM and GCD. So much that he started seeing LCMs and GCDs everywhere. Betty, his girlfriend was jealous and she gave Bob an array A[ ] of integers, which had nothing to do with LCMs or GCDs.Quickly, naughty Bob evaluated a new array B[ ] containing n integers, such that B[i] is LCM(1, 2, 3 ... A[i]), A[i]>0. When A[i] is 0, B[i] is also 0.Angry Betty decided to give m queries to Bob, each being one of the following type:\"0 i j p\", meaning add 'p' to each element in A[i...j]. -300000 ≤ p ≤ 300000, 0 ≤ i ≤ j < n\"1 i j\", meaning print the LCM of all elements in B[i...j]. 0 ≤ i ≤ j < n\"2 i j\", meaning print the GCD of all elements in B[i...j]. 0 ≤ i ≤ j < nInputFirst line contains n (n ≤ 100000) and m (m ≤ 35000).Second line contains n integers in the original array A[ ].Next m lines contain one of the above said queries.It is guaranteed that A[i] after any number of updates will satisfy 0 ≤ A[i] ≤ 300000.OutputOutput one line for each query of type 1 or 2, modulo 1000000007.ExampleInput:5 5\r\n4 1 3 6 2\r\n1 2 4\r\n2 1 3\r\n0 0 3 2\r\n1 1 2\r\n2 2 4Output:60\r\n1\r\n60\r\n2",
  "sample_input": "Input:5 5\r\n4 1 3 6 2\r\n1 2 4\r\n2 1 3\r\n0 0 3 2\r\n1 1 2\r\n2 2 4Output:60\r\n1\r\n60\r\n2",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/LGLOVE",
  "scraped_at": "2025-08-17 00:33:08"
}