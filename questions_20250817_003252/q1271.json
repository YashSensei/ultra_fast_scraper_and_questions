{
  "problem_code": "problems",
  "title": "100pct failure in 72 hours",
  "tags": [],
  "text": "HAL9000 is a fantastic mega-computer, very powerful, maybe too much.\r\nIt is known it can solve many problems, for obvious example those related to recursive sequences.A linear recursive sequence (an) can be defined by an integerd, the order,dintegers (aiforiin [0..d[ ), the first terms, anddintegers (biforiin [0..d[ ), giving the relation : \r\nforn>= d :an=an-1× bd-1+an-2× bd-2+\r\n... +an-(d-1)× b1+an-d× b0.  Withb0!= 0.Dave was afraid about HAL power and tried to limit it. HAL didn't appreciate...\r\nWhen Dave asked HAL for a common task, the answer wasunexpected.\r\nDave would like to knowSn= sum(aiforiin [0..n]), in order to open the pod bay doors.\r\nHAL refused to give him the answer ; here's a part of one of their last conversations.Dave: Hello, HAL. Do you read me, HAL?\r\nHAL: Affirmative, Dave. I read you.\r\nDave: Give me the sum S_n_, HAL. (Input 2, 5, 0 1, 1 2)\r\nHAL: I'm sorry, Dave. I'm afraid I can't do that.\r\n     I'll just give you a_n_, a_n+1_, ... , a_n+d-1_. (Output 29 70)\r\nDave: What's the problem?\r\nHAL: I think you know what the problem is just as well as I do.\r\n[...]\r\nDave: HAL, I won't argue with you anymore! Give me the sum S_n_!\r\nHAL: Dave, this conversation can serve no purpose anymore. Goodbye.You have to help Dave to find this sumSn, unless HAL will take Dave's life.\r\n\r\nPlease do that quickly, everybody is in danger. Warning, Dave's terminal islimitedto 1024 bytes.InputThe first line contains an integerT, the number of test cases.\r\nEach test case is made of 4 lines.\r\nThe first line containsd, n.\r\nThe second line containsaiforiin [0..d[ \r\nThe third line constainsbiforiin [0..d[ \r\nThe fourth line contains the partial answer of HAL :an+iforiin [0..d[ \r\n(The answer of HAL is useless since Dave wants the sum foriin [0..n]).OutputOutputTlines, one for each test case, containing the required sumSn.\r\nSince the answer can get very big, output it modulo 109+7, just like HAL did.ExampleInput:2\r\n2 5\r\n0 1\r\n1 2\r\n29 70\r\n3 5\r\n5 17 8\r\n2 1 0\r\n43 96 127Output:49\r\n142ExplanationThe first case is about the 0-indexed sequence : 0, 1, 2, 5, 12, 29, 70, 169, ...\r\nHAL answered 29 70, the 5th and next term. But the required sum is 0+1+2+5+12+29 = 49.Constraints0 < T < 100\r\n0 < d < 1000 \r\n0 < n < 10^9\r\n0 <= a_i < 10^6\r\n0 <= b_i < 10^6, b_0 > 0\r\n0 <= HAL's answers < 10^9+7InformationThe challenge is to solve the problem in time, with the shortest code.The winner will achieve the next step in evolution, whatever that may be.\r\nMy Py3 code (under 300B) got AC under the third of a second. (updated 2017-02-11 ; compiler changes)\r\nGood luck and have fun ;-)Original Quotes for HAL 9000.",
  "sample_input": "Dave: Hello, HAL. Do you read me, HAL?\r\nHAL: Affirmative, Dave. I read you.\r\nDave: Give me the sum S_n_, HAL. (Input 2, 5, 0 1, 1 2)\r\nHAL: I'm sorry, Dave. I'm afraid I can't do that.\r\n     I'll just give you a_n_, a_n+1_, ... , a_n+d-1_. (Output 29 70)\r\nDave: What's the problem?\r\nHAL: I think you know what the problem is just as well as I do.\r\n[...]\r\nDave: HAL, I won't argue with you anymore! Give me the sum S_n_!\r\nHAL: Dave, this conversation can serve no purpose anymore. Goodbye.",
  "sample_output": "Input:2\r\n2 5\r\n0 1\r\n1 2\r\n29 70\r\n3 5\r\n5 17 8\r\n2 1 0\r\n43 96 127Output:49\r\n142",
  "link": "https://www.spoj.com/problems/HAL9000",
  "scraped_at": "2025-08-17 00:33:24"
}