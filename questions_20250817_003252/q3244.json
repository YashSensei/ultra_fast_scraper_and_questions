{
  "problem_code": "problems",
  "title": "Count on a treap",
  "tags": [],
  "text": "In computer science, a treap is a binary search tree according to the keys and meanwhile a heap according to the weights.Your task is to maintain amax-treapsupporting the following operations:0k w: Insert a new node, whose key and weight arekandw.1k: Delete a node in the treap with keyk.2kukv: Return the distance between nodeuwhose key iskuand nodevwhose key iskv.No two nodes share a same key or same weight, and we guarantee the node is indeed in the treap before a delete operation takes place.InputThe first line contains an integerN(1 ≤N≤ 200000), the number of operations. The nextNlines each contains two or three integers \"0kw\", \"1k\" or \"2kukv\" (0 <k,w,ku,kv≤ maxlongint).OutputFor each query operation, print the distance betweenuandv.ExampleInput:12\r\n0 4 17535\r\n0 10 38964\r\n0 2 21626\r\n0 1 61321\r\n2 1 10\r\n2 10 4\r\n1 10\r\n1 1\r\n0 8 42634\r\n2 8 4\r\n2 8 2\r\n2 4 2Output:1\r\n2\r\n2\r\n1\r\n1",
  "sample_input": "Input:12\r\n0 4 17535\r\n0 10 38964\r\n0 2 21626\r\n0 1 61321\r\n2 1 10\r\n2 10 4\r\n1 10\r\n1 1\r\n0 8 42634\r\n2 8 4\r\n2 8 2\r\n2 4 2Output:1\r\n2\r\n2\r\n1\r\n1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/COT5",
  "scraped_at": "2025-08-17 00:34:14"
}