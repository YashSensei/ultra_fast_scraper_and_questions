{
  "problem_code": "problems",
  "title": "The way to Bytemountain",
  "tags": [],
  "text": "Byteman woke up early this morning, just after dawn. He is planning to get to the top of Bytemountain, so\r\nthe spent the night in a mountain hostel right in the middle of picturesque mountain range of Lower Bytehills.\r\nSince Bytemountain in the highest mountain of the range, at each trail crossing there is a signpost pointing\r\nat the trail leading towards its peak.In the mountain hostel Byteman met a guide who knows Lower Bytehills like the back of his hand. The\r\nguide informed Byteman that the signposts are being reorganized and because of that he should not rely too\r\nmuch on the signposts. In particular, the very peak of Bytemountain is also a crossing and at this crossing\r\nthere is a signpost pointing to some trail “leading” to Bytemountain!The guide will explain Byteman how to get to the peak. Luckily, all trail crossings are numbered from 1\r\nto n and each crossing contains a tablet with the number of the crossing written on it. The guide’s directions\r\nwill have the following form: “Walk along the trails pointed by the signposts until you reach crossing s1, then\r\ntake a map and choose the trail connecting crossing s1with crossing c1. Afterwards keep walking along the\r\ntrails pointed by the signposts until you reach crossing s2. The take a look at the map and choose the trail\r\nconnecting s2and c2. . . Finally, when you reach si, take the last look at the map and walk along the trail\r\nconnecting siand ci. If you keep walking along the trails pointed by the signposts since then, you will reach\r\nthe peak of Bytemountain.”Byteman would not like the description of the route to be too complicated, so he asked the guide for a route\r\nthat would not require looking at the map more than k times.The guide had to take a deeper thought, because he knows that some trails are more exciting than others\r\nand he would like to show Byteman the most interesting route.The route may lead through the same trails and crossing many times (some trails are so exciting that they\r\nmay be worth visiting multiple times!)Byteman ends his walk when he reaches the peak for the first time after using all instructions provided by\r\nthe guide. This means that Byteman can visit the peak of Bytemountain multiple times during the walk, but\r\nhe will end his walk only after all instructions have been used.How interesting can the route provided by the guide be?InputThe first line of the standard input contains two integers n and k (1 ≤ n ≤ 50000, 0 ≤ k ≤ 100) separated by\r\na single space. They denote the number of trail crossings and the maximum number of times Byteman would\r\nlike to look at the map. The crossings are numbered from 1 to n, the mountain hostel is located at crossing 1,\r\nand the peak of Bytemountain is the crossing number n.The following n lines contain descriptions of the respective trail crossings. Each crossing’s description\r\nconsists of a single line and is composed of integers separated by single spaces. The first one of these numbers, mi(1 ≤ mi≤ n-1), denotes the number of trails going out of the crossing. After that there are mipairs of numbers ai,j, bi,j(1 ≤ ai,j≤ n, 1 ≤ bi,j≤ 10000), meaning that from the ith crossing there is a trail leading to\r\ncrossing ai,jwith beauty equal to bi,j. The first pair of numbers denotes the trail that leads to Bytemountain\r\naccording to the signpost at the crossing. Each trail is bidirectional and connects two different crossings. Each\r\ntwo crossings can be connected by at most one trail. The total number of all trails does not exceed 100000.Each trail connecting crossings i and j will appear in the input twice: first time in the list of trails going\r\nout of the ithcrossing and second time in the list of trails going out of the jthcrossing. In both cases the\r\nbeauty of the trail will be the same.OutputThe first and only line of the standard output should contain a single integer denoting the maximum possible\r\nsum of beauties of consecutive trails on the route from the mountain hostel to the peak of Bytemountain that\r\nsatisfies Byteman’s requirements. You can assume that there exists at least one such route.ExampleFor the input data:5 2\r\n2 3 4 2 2\r\n3 1 2 5 4 4 3\r\n2 1 4 4 3\r\n3 2 3 5 5 3 3\r\n2 2 4 4 5the correct result is:14Explanation of the example. In the above figure the edges represent trails connecting respective crossings,\r\nthe numbers next to the edges — the beauties of the trails, and the arrows denote the trails pointed by the\r\nsignposts at respective crossings.The guide will ask Byteman to look at the map twice, at crossings number 3 and 2. This way Byteman’s\r\nwalk will lead along the route 1 – 3 – 4 – 2 – 5. The total beauty of the trails on this route is 14.",
  "sample_input": "5 2\r\n2 3 4 2 2\r\n3 1 2 5 4 4 3\r\n2 1 4 4 3\r\n3 2 3 5 5 3 3\r\n2 2 4 4 5",
  "sample_output": "14",
  "link": "https://www.spoj.com/problems/AE4B",
  "scraped_at": "2025-08-17 00:33:58"
}