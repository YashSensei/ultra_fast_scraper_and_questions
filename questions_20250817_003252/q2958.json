{
  "problem_code": "problems",
  "title": "Who is the Best?",
  "tags": [],
  "text": "Baratheon is one of the oldest houses in the Land of Seven Kingdoms. There have been many kings and their many heirs. The hierarchy is represented as a tree where each character is a node with initial value as theVarys_Valuegiven by Lord Varys. You are the analyser appointed to the current King to give insights about a character.There areQcommands given by the King which can be any of the following type:1. Multiply theVarys_Valueof all the characters in path fromutovby a given numberP.2. For a given characterX, find the number ofordered pairs (i,j)such thatLCM(i,j)is equal to current value at nodeX. (Insight)For commands of second type, print the number of such pairs (modulo1000000007).InputFirst line contains 2 space separated integersNandQindicating the number of total characters and number of queries you need to answer.In the nextN-1lines, each line contains 2 integersu,vwhich indicates a relationship between characteruand characterv.Next line containsNspace separated integerV1, V2, V3, ...... VNwhereViindicates the Varys_Value ofithcharacter.FollowingQlines contains the queries to be answered.Types of Queries:1 u v P- Query of first type2 X- Query of second typeOutputFor each query of second type, print the answer to the query in a new line.Constraints1 ≤ N ≤ 1000001 ≤ Q ≤ 1000001 ≤ u, v ≤ N1 ≤ P ≤ 1001 ≤ Vi≤ 100000ExampleSample Input:6 6 \r\n1 2\r\n4 6\r\n1 3\r\n5 1\r\n4 5\r\n7 8 4 8 1 2\r\n1 2 1 14\r\n2 4\r\n1 6 5 10\r\n2 5\r\n1 6 4 10\r\n2 1Sample Output:7\r\n9\r\n15",
  "sample_input": "Sample Input:6 6 \r\n1 2\r\n4 6\r\n1 3\r\n5 1\r\n4 5\r\n7 8 4 8 1 2\r\n1 2 1 14\r\n2 4\r\n1 6 5 10\r\n2 5\r\n1 6 4 10\r\n2 1Sample Output:7\r\n9\r\n15",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/INS16F",
  "scraped_at": "2025-08-17 00:34:18"
}