{
  "problem_code": "problems",
  "title": "Snail family problems",
  "tags": [],
  "text": "In this problem we'll be looking at a group of snails. Two snails, numberedaandbcan get married, and some time after that they may even get divorced. Any snail may be married to number of other snails.The problem arises because snails don't like being married to their ancestors, and they don't know who their ancestors are - they only know the set of snails they're directly related to. A marriage between two snails from which one is an ancestor of the other is called \"bad\".If they knew who the oldest snail (the ancestor of everyone else) is, everyone would know their ancestors.For the given group ofNsnails numbered from 1 toN, you'll be givenN-1 pairs of snails (a,b), indicating that snails a and b are directly related.Next you'll be givenQqueries of the form:Qn- supposenis the oldest snail, how many \"bad\" marriages are there in the group?M a b- snailsaandbjust got married.D a b- snailsaandbjust got divorced.No snail can ever get married to himself.You may assume that no pair will get married twice (if they are already married). You may also assume that no pair will get divorced if they don't get married before that.InputThe first line of input contains an integerN(2 ≤N≤ 200000).Each of the nextN-1 lines contains a pair of integersaandb(1 ≤a<b≤ N).The next line contains an integerQ(1 ≤Q≤ 300000).Each of the nextQlines contains a query as defined above.OutputFor each query of typeQoutput a single line containing the number of \"bad\" marriages if snail numberednwas the oldest one.ExampleInput:51 21 32 42 59Q 1M 3 5Q 1Q 3M 1 4Q 3Q 4D 3 5Q 3Output:001211",
  "sample_input": "Input:51 21 32 42 59Q 1M 3 5Q 1Q 3M 1 4Q 3Q 4D 3 5Q 3Output:001211",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/INCEST",
  "scraped_at": "2025-08-17 00:34:06"
}