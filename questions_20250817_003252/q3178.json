{
  "problem_code": "problems",
  "title": "Generating Alien DNA",
  "tags": [],
  "text": "GigaFarma is one of the largest pharmaceutical companies in the world, and it is currently conducting experiments using alien DNA. Its goal is to produce a chain of alien DNA that will report the maximum possible benefit when commercialized.A chain ofalienDNA can be understood as a non-empty sequence of genes connected by links, and in turn eachgeneis a non-empty sequence of bases. Because not every possible sequence of bases corresponds to a valid gene, GigaFarma has created a catalogue of genes that appear in alien DNA, which are the only ones considered valid sequences of bases. Each of these genes has avalueaccording to its functionality, and a given chain of alien DNA has amarket valuethat is the sum of the values of the genes that compose it.We will represent the differentbaseswith lowercase letters,'a'-'z', andlinksusing a hyphen'-'. In the following example we can see on the left a possible list of genes and their corresponding values; on the right there are some chains of alien DNA that can be formed with these genes, along with their corresponding market values.GigaFarma can only produce very specific DNA chains, which we callproducible. These chains are a non-empty sequence of DNA portions that the company can synthesize, joined without any additional links between them. Eachportionis a sequence of bases and links containing at least one link, but without any consecutive, initial or final links. Each portion has a givencost, determined by the difficulty associated to its production, so each producible chain of DNA has aproduction costthat is the sum of the costs of each of the portions that form it. In the following example, we can see on the left a list of DNA portions and their costs; on the right we have some producible chains of DNA that can be formed with these portions, along with their associated production cost.Note that there might be multiple ways of forming the same producible chain using different portions. This is the case of\"como-como-les\"in the example, which can be obtained using portions\"como-co\"and\"mo-les\"with a production cost of7, or just using\"como-como-les\"with a production cost of12. Of course, when there is more than one way to synthesize a given producible chain of DNA, GigaFarma will always do so using the cheapest possible process.Clearly, the set of alien DNA chains is infinite, just like the set of producible DNA chains. However, GigaFarma is not directly interested in any of these sets, but in their intersection. If we check the previous examples, we can see that\"como-les\"is a valid alien DNA chain, but is not producible;\"mo-les\"is producible, but is not an alien DNA chain; and\"como-como-les\"is both. For each alien and producible DNA chain, the company can commercialize this chain to get anet benefitthat equals the market value of this chain minus its production cost. Of course, if this net benefit is not positive, the corresponding chain will never be produced.Because there is so much genetic material all over the place, GigaFarma would pay anything in order to know what is the maximum net benefit it can obtain for some producible and alien DNA chain.InputEach test case is described using several lines. The first line contains two integer numbersGandP, representing the number of genes in the catalogue and the number of portions GigaFarma can produce (1 ≤ G, P ≤ 100).Each of the followingGlines describes a different gene using a stringSand an integerV. The stringShas between1and10characters, and is formed solely by lowercase letters representing the bases that form this gene; the integerVrepresents the value of this gene (1 ≤ V ≤ 1000).Each of the followingPlines describe a different DNA portion, using a stringTand an integerC. The stringThas between1and30characters, and is composed of lowercase letters and hyphens only, respectively representing the bases and links in this portion.Tcontains at least one link, but will never have initial, final or consecutive links. The integerCrepresents the production cost for the corresponding portion (1 ≤ C ≤ 1000).Note that in every test case, all of the genes are different from one another, and all of the portions are also different from one another. The end of the input is signalled by a line containing two times the number-1.OutputFor each test case, you should print a single line containing an integer number, representing the maximum net benefit that GigaFarma can obtain from a producible and alien DNA chain. If no net benefit is positive, you should print the value 0. If the net benefit can be arbitrarily large, you should print an asteris'*'.ExampleInput:4 6\r\nhola 5\r\ncomo 5\r\nles 3\r\nva 2\r\ncomo-co 3\r\nmo-co 8\r\nmo-les 4\r\ncomo-como-les 12\r\nta-no-sirven 100\r\nhasta-es 200\r\n2 3\r\nxyz 1000\r\nzyxxyz 1000\r\nxyz-zyx 1\r\nzyx-xyz 1\r\nxyz-xyz-zyx-xyz 1\r\n2 1\r\nabc 1\r\nabcabc 1000\r\nabc-abc 999\r\n1 1\r\nser 10\r\nno-ser 5\r\n-1 -1Output:6\r\n0\r\n*\r\n0",
  "sample_input": "Input:4 6\r\nhola 5\r\ncomo 5\r\nles 3\r\nva 2\r\ncomo-co 3\r\nmo-co 8\r\nmo-les 4\r\ncomo-como-les 12\r\nta-no-sirven 100\r\nhasta-es 200\r\n2 3\r\nxyz 1000\r\nzyxxyz 1000\r\nxyz-zyx 1\r\nzyx-xyz 1\r\nxyz-xyz-zyx-xyz 1\r\n2 1\r\nabc 1\r\nabcabc 1000\r\nabc-abc 999\r\n1 1\r\nser 10\r\nno-ser 5\r\n-1 -1Output:6\r\n0\r\n*\r\n0",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TAP2012G",
  "scraped_at": "2025-08-17 00:34:21"
}