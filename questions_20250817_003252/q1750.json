{
  "problem_code": "problems",
  "title": "Query on a tree VII",
  "tags": [],
  "text": "You are given a tree (an acyclic undirected connected graph) with n nodes. The tree nodes are numbered from 1 ton. Each node has a color, white or black, and a weight. We will ask you to perform some instructions of the following form:0 u: ask for the maximum weight among the nodes which are connected tou, two nodes are connected if all the node on the path fromutov(inclusiveuandv) have a same color.1 u: toggle the color ofu(that is, from black to white, or from white to black).2 u w: change the weight ofutow.InputThe first line contains a numberndenoted how many nodes in the tree(1 ≤n≤ 105). The nextn-1 lines, each line has two numbers (u,v) describe a edge of the tree(1 ≤u,v≤ n).  The next 2 lines, each line containsnnumber, the first line is the initial color of each node(0 or 1), and the second line is the initial weight, let's say Wi, of each node(|Wi| ≤ 109).  The next line contains a numbermdenoted how many operations we are going to process(1 ≤m≤ 105). The nextmlines, each line describe a operation (t,u) as we mentioned above(0 ≤t≤ 2, 1 ≤u≤n, |w| ≤ 109).OutputFor each query operation, output the corresponding result.ExampleInput 1:5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0 1 1 1 1\r\n1 2 3 4 5\r\n3\r\n0 1\r\n1 1\r\n0 1Output 1:1\r\n5Input 2:7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0 0 0 0 0 0 0\r\n1 2 3 4 5 6 7\r\n4\r\n0 1\r\n1 1\r\n0 2\r\n0 3Output 2:7\r\n5\r\n7Warning: large input/output data ,be careful with certain languages",
  "sample_input": "Input 1:5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0 1 1 1 1\r\n1 2 3 4 5\r\n3\r\n0 1\r\n1 1\r\n0 1Output 1:1\r\n5",
  "sample_output": "Input 2:7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0 0 0 0 0 0 0\r\n1 2 3 4 5 6 7\r\n4\r\n0 1\r\n1 1\r\n0 2\r\n0 3Output 2:7\r\n5\r\n7",
  "link": "https://www.spoj.com/problems/QTREE7",
  "scraped_at": "2025-08-17 00:33:48"
}