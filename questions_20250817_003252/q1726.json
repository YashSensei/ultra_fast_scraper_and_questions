{
  "problem_code": "problems",
  "title": "Watching the game",
  "tags": [],
  "text": "In the kingdom of Nlogonia there is a lake known as the \"Big O\" because of its perfectly round shape. On the side of this lake there areNhouses, each of them a distance of one nlogonic unit apart from its neighbors. The houses are numbered from1toNin clockwise order, as can be seen in the following figure forN = 8.In this way, ifi < jthe distance in clockwise order from houseito housejisj-i, whereas the corresponding distance in counterclockwise order isN - j + i. Note that the distance from a house to itself isNin both directions.It is well known that the people of Nlogonia are avid football fans, so when a family moves to a house on the side of the lake it is very important for them to know who are their closest neighbors that follow the same team as they do. This is not always easy, since there may be many houses around the lake, many different football teams in Nlogonia, and a lot of moving around. Given a sequence ofMmovings, people who live on the shore of the lake want to welcome each new family arriving by telling them the distance from their new home to the closest houses that follow the same team as they do, both in clockwise and counterclockwise order. Note that if there is no other house on the shore of the lake whose family follows the same team as the newly arrived, said distance shall beNin both directions, as the closest house would in fact be the same house involved in the moving. Do you want to take part in the welcoming committee?In Nlogonia there areFfootball teams, identified by different integer numbers from0toF-1. Because we don't want you to waste any time going from door to door asking which team is followed in each house, we will assume that initially the family living in house numberiis a fan of team numberei, being this number generated in pseudo-random fashion by the recursive formulae1= Aandei= (B × ei-1+ C) mod Ffori = 2, 3, ..., NwhereA,BandCare constants and the expressionx mod yrepresents the remainder of the integer division ofxbyy.InputThe first line contains two integer numbersNandF, respectively indicating the number of houses around the lake and the number of football teams in Nlogonia (3 ≤ N≤105and1≤F≤106). The second line contains three integer numbersA,BandC, which determine which team is followed by the families initially living around the lake as is described in the problem statement (0≤A, B, C < F).The third line contains a single integer numberM, representing the number of movings that will be happening (1≤M≤105). Each of the followingMlines describes a moving using two integer numbersIandE, meaning that a family following teamEis moving to house numberI(1≤I≤Nand0≤E < F). The movings appear in the order that they occur, and should be taken into account by the committee for further welcomings.OutputPrintMlines, thei-th of them indicating the result of thei-th moving described in the input. Each line should contain two integer numbersdccwanddcw, representing the distances in nlogonic units from the house involved in the moving to the first house whose family follows the same team, in counterclockwise and clockwise order respectively.ExampleInput:5 10\r\n1 1 1\r\n6\r\n1 1\r\n2 2\r\n3 1\r\n4 2\r\n5 1\r\n3 1Output:5 5\r\n5 5\r\n2 3\r\n2 3\r\n2 1\r\n2 2",
  "sample_input": "Input:5 10\r\n1 1 1\r\n6\r\n1 1\r\n2 2\r\n3 1\r\n4 2\r\n5 1\r\n3 1Output:5 5\r\n5 5\r\n2 3\r\n2 3\r\n2 1\r\n2 2",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TAP2013D",
  "scraped_at": "2025-08-17 00:33:37"
}