{
  "problem_code": "problems",
  "title": "Query on a tree IV",
  "tags": [],
  "text": "You are given a tree (an acyclic undirected connected graph) with N nodes, and nodes numbered 1,2,3...,N. Each edge has an integer value assigned to it(note that the value can be negative). Each node has a color, white or black.\r\nWe define dist(a, b) as the sum of the value of the edges on the path from node a to node b.All the nodes are white initially.We will ask you to perform some instructions of the following form:C a: change the color of node a.(from black to white or from white to black)A: ask for the maximum dist(a, b), both of node a and node b must be white(a can be equal to b). Obviously, as long as there is a white node, the result will always be non negative.InputIn the first line there is an integer N (N <= 100000)In the next N-1 lines, the i-th line describes the i-th edge: a line with three integers a b c denotes an edge between a, b of value c (-1000 <= c <= 1000)In the next line, there is an integer Q denotes the number of instructions (Q <= 100000)In the next Q lines, each line contains an instruction \"C a\" or \"A\"OutputFor each \"A\" operation, write one integer representing its result.\r\nIf there is no white node in the tree, you should write \"They have disappeared.\".ExampleInput:3\r\n1 2 1\r\n1 3 1\r\n7\r\nA\r\nC 1\r\nA\r\nC 2\r\nA\r\nC 3\r\nAOutput:2\r\n2\r\n0\r\nThey have disappeared.",
  "sample_input": "Input:3\r\n1 2 1\r\n1 3 1\r\n7\r\nA\r\nC 1\r\nA\r\nC 2\r\nA\r\nC 3\r\nAOutput:2\r\n2\r\n0\r\nThey have disappeared.",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/QTREE4",
  "scraped_at": "2025-08-17 00:33:09"
}