{
  "problem_code": "problems",
  "title": "Recursive Sequence (Version X)",
  "tags": [],
  "text": "Sequence(ai)of natural numbers is defined as follows:ai= bi(fori ≤ m)ai= c1ai-1+ c2ai-2+ ... + ctai-t(fori > t)wherebjandcjare given natural numbers. Your task is to computeanand output it modulo 109+7.The above is the description of the original problemSEQ. However, to be a problem in a regional contest, the description will be slightly modified to make the problem a little bit complicated: for almost all integersi>m, aifollows the formula given above, but there areqexceptions n1, n2... nq:ani= di1ani-1+ di2ani-2+ ... + ditiani-ti(for 1 ≤i≤q)InputFor each test case, the first line contains three integersn(m<n≤ 109),m(1 ≤m≤ 100),q(0 ≤q≤ 100). The second line containsmintegers b1, b2... bm. The following line contains several integers, first comes t (t ≤ 100), then t integers c1, c2... ct. The followingqlines describeqspecial cases of the recurrent formula, each containing several integers, namely ni, ti(ti≤ 100, ti< ni), di1, di2... diti, as mentioned earlier. It is satisfied that all niare distinct. All integers are non-negative. Unless specified, all integers are not greater than 109. Input is terminated by EOF. You might assume that all given data is correct. That is to say, all the required numbers can be fixed uniquely by the given input data.OutputFor each test case output the answer in a single line. Refer to the example for more format details.ExampleInput:7 5 0\r\n1 1 2 3 5\r\n2 1 1\r\n10 5 1\r\n1 1 2 3 5\r\n2 1 1\r\n10 2 1 2Output:Case 1: 13\r\nCase 2: 76",
  "sample_input": "Input:7 5 0\r\n1 1 2 3 5\r\n2 1 1\r\n10 5 1\r\n1 1 2 3 5\r\n2 1 1\r\n10 2 1 2Output:Case 1: 13\r\nCase 2: 76",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/SPP2",
  "scraped_at": "2025-08-17 00:34:08"
}