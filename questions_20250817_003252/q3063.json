{
  "problem_code": "problems",
  "title": "Ada and Graft",
  "tags": [],
  "text": "As you might already know, Ada the Ladybug is a farmer. She grows a big fruittree(with root in 0). There is a fruit on every node of the tree. Ada is competing in grafting competition and this is her masterpiece. The most valuable tree wins the competition. The value of tree is product of values of each node. The value of a node is the number of distinct fruit kinds in its subtree.Can you find the value of Ada's tree? Since this number might be pretty big, output it modulo109+7InputThe first and line will contain1 ≤ N ≤ 4*105.The next line will containN-1integers0 ≤ pi<     i, the parent of ithnode.The next line will containNintegers0 ≤ Fi≤     109, the fruit growing on ithnode.OutputPrint a single integer - the value of tree modulo1000000007.Example Input5\r\n0 0 1 1\r\n1 1 1 2 2Example Output4Example Input4\r\n0 1 2\r\n6 7 2 3Example Output24Example Input11\r\n0 1 1 1 3 5 2 7 5 4\r\n494052753 959648710 959648710 959648710 494052753 959648710 959648710 959648710 959648710 494052753 959648710Example Output32",
  "sample_input": "5\r\n0 0 1 1\r\n1 1 1 2 2",
  "sample_output": "4",
  "link": "https://www.spoj.com/problems/ADAGRAFT",
  "scraped_at": "2025-08-17 00:34:10"
}