{
  "problem_code": "problems",
  "title": "If Chain",
  "tags": [],
  "text": "Consider the following code:if (a)if (b)if (c)foo();wherea, bandcare boolean variables. If we run this code in C++, the functionfoo()is called if and only if all three variables are true. However, recently a new language - C-- - is being developed. In this language, when anif()evaluates to false, only the statement directly following it is not executed; for example, ifawas false, the program would jump fromif(a)toif(c).Using this convention, there are 5 different possible assignments of truth values to the variablesa,b,cwhich end up callingfoo(). Consideringa,b,cas three bits in that order, they are 111, 101, 100, 011 and 001.Givennboolean variables within a chain ofmif()'s, where the variables within oneif()are separated usinglogical or, count the number of ways to assign truth values to them which end up calling the functionfoo()(the call tofoo()is after the lastif()).InputThe first line of the input is the number of test cases1 ≤T ≤ 30.Ttest cases follow.The first line of each test case contains two nonnegative integersn ≤ 105- the number of boolean variables (they are numbered1throughn) - andm ≤ 105- the number ofif()'s.mlines follow, thei-th line describing thei-thif(). The first integer in each line is a positive integerki- the number of variables in thei-thif()(implicitly separated by thelogical oroperator) - followed bykipositive integers in the range[1, n]: the variables in thei-thif(). Not all variables need necessarily appear within theif()chain, and the variables within oneif()need not be distinct.The sum ofkiwithin a test case will not exceed5×105. Additionally, the sum ofn,mandkiwithin a single input file will not exceed2×106.The input is quite large - make sure to read it efficiently.OutputFor each case, output the string \"Casex:y\" in a single line, wherexis the number of the test case, starting from 1, andyis the number of ways of assigning truth values to thenboolean variables (out of2n), which when run in C-- end up callingfoo(), modulo109+9.ExampleInput:2\r\n3 3\r\n1 1\r\n1 2\r\n1 3\r\n5 3\r\n2 1 2\r\n3 1 3 5\r\n2 2 4Output:Case 1: 5\r\nCase 2: 24",
  "sample_input": "if (a)if (b)if (c)foo();",
  "sample_output": "Input:2\r\n3 3\r\n1 1\r\n1 2\r\n1 3\r\n5 3\r\n2 1 2\r\n3 1 3 5\r\n2 2 4Output:Case 1: 5\r\nCase 2: 24",
  "link": "https://www.spoj.com/problems/IFCHAIN",
  "scraped_at": "2025-08-17 00:34:12"
}