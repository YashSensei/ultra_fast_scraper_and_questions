{
  "problem_code": "problems",
  "title": "String Queries",
  "tags": [],
  "text": "Consider a string S, consisting of lowercase letters.You are given a list of queries, each of which belong to one of the following two types:Q a b: Returns the number of ways of rearranging the letters in the substring [a, b] such that for each substring X in the resulting string A, Reverse(X) is also present in A. Reverse(X) reverses the string X.U a b: Sorts the substring [a, b] lexicographically.Thus, given the string S and a list of queries, print the answer for each query of type 1. Since the answer can be huge, print the result modulo 106109099.Finally, output the string S, with the updates made, if any.Note: Two ways of rearranging the letters are considered different if, for two resulting strings A, B you can find an index i such that A[i] != B[i].InputFirst line contains T, the number of test cases.For each test case, first line contains S, the input string.Next line contains N, the number of queries. Each of the next N lines contains a string of the form \"X a b\" where X is one of {\"Q\", \"U\"} and a and b are positive integers such that 1 ≤ a ≤ b ≤ |S|.OutputFor each test case, print X + 1 lines, where X is the number of queries of type Q.For each query of type Q, print one number which is the answer to the query.(X + 1)th line for each test case, should contain the updated string S.Constraints1 ≤ T ≤ 101 ≤ |S| ≤ 500001 ≤ N ≤ 2000ExampleInput:2\r\nnittirichy\r\n3\r\nQ 2 5\r\nU 1 4\r\nQ 1 5\r\nshabba\r\n5\r\nQ 2 3\r\nQ 2 6\r\nU 1 4\r\nQ 2 5\r\nQ 1 6Output:2\r\n2\r\ninttirichy\r\n0\r\n2\r\n0\r\n0\r\nabhsba",
  "sample_input": "Input:2\r\nnittirichy\r\n3\r\nQ 2 5\r\nU 1 4\r\nQ 1 5\r\nshabba\r\n5\r\nQ 2 3\r\nQ 2 6\r\nU 1 4\r\nQ 2 5\r\nQ 1 6Output:2\r\n2\r\ninttirichy\r\n0\r\n2\r\n0\r\n0\r\nabhsba",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/STRINGQ",
  "scraped_at": "2025-08-17 00:34:30"
}