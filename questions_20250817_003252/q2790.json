{
  "problem_code": "problems",
  "title": "Segmentation",
  "tags": [],
  "text": "Bobs just got an array A ofnintegers from his mother Ksenxi. She asked him to calculate the goodness of A.Let's define f(a, b) of A as minimum value on interval [a, b] in A. Goodness of A is the number of pairs of segments [a, b], [c, d] such that1≤ a ≤ b < c ≤ d ≤nand f(a, b) ≤ f(c, d).Since Bobs is writing an essay on matura in a few days he is now reading short summaries of books on the mandatory reading list so he needs your help to answer this hard question to his mom.InputThe first line of the input contains an integern(1≤n≤500000).The second line contains n space-separated integers A1, A2... An(0≤ Ai≤109) - the array elements.OutputPrint out a single integer - the goodness of A. As the answer can be quite a large number, you should print it modulo109+ 7(1000000007).ExampleInput:5\r\n5 3 0 9 8Output:21",
  "sample_input": "Input:5\r\n5 3 0 9 8Output:21",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/HJB",
  "scraped_at": "2025-08-17 00:34:15"
}