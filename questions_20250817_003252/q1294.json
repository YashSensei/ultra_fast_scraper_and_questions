{
  "problem_code": "problems",
  "title": "Join",
  "tags": [],
  "text": "There are two tables. These tables are filled with numeric data. Each column of each table has a unique name. You need to implement JOIN operation for those tables. JOIN creates a new result table by combining column values of the two tables based upon the join-predicate. The query compares each row of the first table with each row of the second to find all pairs of rows which satisfy the join-predicate. When the join-predicate is satisfied, column values for each matched pair of rows of the table are combined into a result row. The result of the join can be defined as the outcome of first taking the Cartesian product of all records in the tables (combining every record in the first table with every record in the second table) - then return all the records which satisfy the join predicate. After that needed column are picked and printed as the result. Moreover the resulting rows should be output in the lexicographic order.InputThe input starts with the description of the first table. The first line consists of k1names of the columns of the table separated with spaces. All the names contain only small Latin letters and digits. Next line contain number n1– the number of records in the table. In each of the next n1lines there are k1integers – data written in the table. The description of the second table in the same format follows. Next line is number q – the number of queries. The description of each query follows in the following format:SELECT <list of the names of columns>\r\nJOIN ON <a name of the column from the first table>=<a name of the column of the second table>Constraints2 ≤ k1, k2≤ 101 ≤ n1, n2≤ 50000All the integers in the tables are positive and less than 100000.1 ≤ q ≤ 10OutputFor each query print the result of JOIN operation. You should print only the columns given in the query and in the appropriate order. The rows should be ordered lexicographically. The result of each query won't contain more than 50000 records. Print blank line after the answer for each query. See the example for more information.ExampleInput:id1 a b\r\n4\r\n1 2 3\r\n2 2 3\r\n3 2 4\r\n2 4 4\r\nid2 c d\r\n3\r\n3 3 3\r\n5 2 1\r\n1 3 4\r\n3\r\nSELECT a,b,c\r\nJOIN ON id1=d\r\nSELECT id1,d\r\nJOIN ON a=c\r\nSELECT id2,id1,d\r\nJOIN ON b=cOutput:a b c\r\n2 3 2\r\n2 4 3\r\n\r\nid1 d\r\n1 1\r\n2 1\r\n3 1\r\n\r\nid2 id1 d\r\n1 1 4\r\n1 2 4\r\n3 1 3\r\n3 2 3",
  "sample_input": "SELECT <list of the names of columns>\r\nJOIN ON <a name of the column from the first table>=<a name of the column of the second table>",
  "sample_output": "Input:id1 a b\r\n4\r\n1 2 3\r\n2 2 3\r\n3 2 4\r\n2 4 4\r\nid2 c d\r\n3\r\n3 3 3\r\n5 2 1\r\n1 3 4\r\n3\r\nSELECT a,b,c\r\nJOIN ON id1=d\r\nSELECT id1,d\r\nJOIN ON a=c\r\nSELECT id2,id1,d\r\nJOIN ON b=cOutput:a b c\r\n2 3 2\r\n2 4 3\r\n\r\nid1 d\r\n1 1\r\n2 1\r\n3 1\r\n\r\nid2 id1 d\r\n1 1 4\r\n1 2 4\r\n3 1 3\r\n3 2 3",
  "link": "https://www.spoj.com/problems/ADV04H",
  "scraped_at": "2025-08-17 00:33:28"
}