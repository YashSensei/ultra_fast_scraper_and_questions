{
  "problem_code": "problems",
  "title": "Rainbow",
  "tags": [],
  "text": "This time Blue Mary continues doing meaningless calculations! (see problemSPY) She is interested in calculating theK-th power of a very largeN×Nmatrix A, whereAi,j= i ×D+Qji and j are 0-based index of the row and column of element Ai,j, respectively.Now she needs your help (again).To keep the output small, you are only asked to output some of its elements.InputMultiple test cases.The first line of each test case contains 5 space-separated integersN,K,D,Q,Min this order.Mlines follow, each contains two space-separated integersRiandCi.Input terminates by EOF.All input numbers are non-negative integers and no more than 109.(D,RiandCimay be 0, others must be positive integers.)NandMwill be no more than 105.RiandCiwill be less thanN.Input is almost uniformly-random generated, and the number of \"large\" test cases is relatively small.OutputFor each test case output exactlyMlines. Each line contains only one integer: The number at theRi-th row andCi-th column (0-based) of the matrixAK. As the result may be quite large, output it modulo 109+2015.ExampleInput:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_input": "Input:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/RAINBOW2",
  "scraped_at": "2025-08-17 00:34:06"
}