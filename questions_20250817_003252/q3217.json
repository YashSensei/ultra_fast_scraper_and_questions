{
  "problem_code": "problems",
  "title": "Graph",
  "tags": [],
  "text": "Given an undirected graph withnnodes andmweighted edges, every node having one of two colors - black (denoted as 0) and white (denoted as 1). You are to performqoperations of two kinds:Cx: Change thex-th node´s color. A black node should be changed into a white node, and vice versa.QA B: Find the sum of weight of edges whose two end points of color A and B. A and B can be either 0 or 1.InputThe first line contains two integersn(1 ≤n≤ 105) andm(1 ≤m≤ 105) specified above.The second line containsnintegers, thei-th of which represents the color of thei-th node, 0 for black and 1 for white.The followingmlines represent edges. Each line has three integer u, v and w (1 ≤ u, v ≤ n, u ≠ v), indicating there is an edge of weight w between u and v. w fits into 32-bit signed integer.The next line contains only one integerq(1 ≤q≤ 105), the number of operations.The followingqlines - operations mentioned above. See samples for detailed format.OutputFor eachQquery, print one line containing the desired answer. See samples for detailed format.ExampleInput:4 3\r\n0 0 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 2\r\nQ 0 0\r\nQ 0 1Output:6\r\n3\r\n3Input:4 3\r\n0 1 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 3\r\nQ 0 0\r\nQ 0 1Output:3\r\n0\r\n4This problem has a somewhat strict source limit and time limit.",
  "sample_input": "Input:4 3\r\n0 0 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 2\r\nQ 0 0\r\nQ 0 1Output:6\r\n3\r\n3",
  "sample_output": "Input:4 3\r\n0 1 0 0\r\n1 2 1\r\n2 3 2\r\n3 4 3\r\n4\r\nQ 0 0\r\nC 3\r\nQ 0 0\r\nQ 0 1Output:3\r\n0\r\n4",
  "link": "https://www.spoj.com/problems/GRAPH2",
  "scraped_at": "2025-08-17 00:34:19"
}