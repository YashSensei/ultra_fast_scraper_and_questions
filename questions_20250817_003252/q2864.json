{
  "problem_code": "problems",
  "title": "Ada and Cities",
  "tags": [],
  "text": "Ada the Ladybug and her friends are on trip in Bugraine. Most of them are in different cities at the moment. They want to spread as much as possible, make hologram-skype to show all others the city. They have agreed, to make this call in timeT.The cities are connected with bi-directional roads. Each of the road has some length (which equals to time it takes to travel between two cities).InputThe first line will contain the number of test-cases.The first line of each test-case begins with four integers:N, M, F, T, number of cities, number of roads, number of friends (Ada inclusive) and time they have:1 ≤ N, F ≤ 500,0 ≤ M ≤ 105, 0 ≤ T ≤ 5*108Then a line withFintegers follows,1 ≤ Hi≤ N, the city, whereithfriend currently is.AfterwardMlines follow, with three integersA, B, L,1 ≤ A, B ≤ N, 1 ≤ L ≤ 106, indicating a road, which connect citiesA, Bwith length ofLPS: There might exist multiple roads between two cities and there might also be a \"circular route\" which begins and ends in the same city!OutputFor each test-case, print maximal number of different cities Ada and her friends can end up at afterTtime!Example Input3\r\n5 5 4 3\r\n1 1 1 1\r\n1 2 3\r\n1 5 2\r\n5 4 2\r\n4 3 1\r\n2 3 2\r\n7 7 6 3\r\n6 6 2 2 2 2\r\n1 7 5\r\n1 2 5\r\n7 2 4\r\n2 3 2\r\n3 4 3\r\n5 4 1\r\n2 5 2\r\n5 5 4 4\r\n1 1 1 1\r\n1 2 3\r\n1 5 2\r\n5 4 2\r\n4 3 1\r\n2 3 2Example Output3\r\n5\r\n4Output ExplanationInfirsttest-case, all 4 friends begin in same node. From this node, one can get to nodes2and5, or stay in the node (in time ≤ 3). Since everyone is in node 1, best they can do is to choose one friend who goes to 5, one who goes to 2 and the rest of them can stay so with \"1, 1, 2, 5\" they can occupy 3 different nodes (at most).Insecondtest-case, friends on6can go nowhere (just stay in 6). Friends on 2 can go to3, 4, 5or stay on2. So with friends in6, 6, 2, 3, 4, 5we get maximum of 5 different cities.Last (third) test-case is same as first - except for time. This one additional time-unit will let friends go to4(or to nodes which they can go in first test-case). \"1, 2, 4, 5\" would make 4 different cities!",
  "sample_input": "3\r\n5 5 4 3\r\n1 1 1 1\r\n1 2 3\r\n1 5 2\r\n5 4 2\r\n4 3 1\r\n2 3 2\r\n7 7 6 3\r\n6 6 2 2 2 2\r\n1 7 5\r\n1 2 5\r\n7 2 4\r\n2 3 2\r\n3 4 3\r\n5 4 1\r\n2 5 2\r\n5 5 4 4\r\n1 1 1 1\r\n1 2 3\r\n1 5 2\r\n5 4 2\r\n4 3 1\r\n2 3 2",
  "sample_output": "3\r\n5\r\n4",
  "link": "https://www.spoj.com/problems/ADACITY",
  "scraped_at": "2025-08-17 00:34:13"
}