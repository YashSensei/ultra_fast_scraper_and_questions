{
  "problem_code": "problems",
  "title": "Fibonacci Power Sum (hard)",
  "tags": [],
  "text": "This problem is a harder version ofFIBPWSUM.The Fibonacci numbers is defined by$$ f_0=0, f_1=1, $$and$$ f_n = f_{n-1}+f_{n-2} $$for $n > 1$.Given three integers $N$, $C$ and $K$, compute the summation$$ \\sum_{n=0}^N f_{Cn}^K. $$Since the answer can be huge, output it modulo $10^9+7$.InputThe first line contains an integer $T$, denoting the number of test cases. Each test case contains three space separated integers in the order: $N$, $C$ and $K$.Constraints$1 \\leq T \\leq 100$$1 \\leq N, C \\leq 10^{18}$$1 \\leq K \\leq 10^5$OutputFor each test case, output a single line in the format \"Case X: Y\" without the quotes. Here, X is the case number and Y is the desired answer denoting the sum of the series.ExampleInput:5\r\n10 1 1\r\n5 2 2\r\n3 3 4\r\n1000000007 7 9\r\n996969696969696 9 6Output:Case 1: 143\r\nCase 2: 3540\r\nCase 3: 1340448\r\nCase 4: 880410497\r\nCase 5: 689328397Creditssgtlaugh-FIBPWSUMZOJ 3774. Power of FibonacciInformationThere are two test files. The first file is randomly generated while the second file is not.@Speed Adicts: My solution runs in 1.94s. (approx less than 1s per file)",
  "sample_input": "Input:5\r\n10 1 1\r\n5 2 2\r\n3 3 4\r\n1000000007 7 9\r\n996969696969696 9 6Output:Case 1: 143\r\nCase 2: 3540\r\nCase 3: 1340448\r\nCase 4: 880410497\r\nCase 5: 689328397",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/FIBPSUM2",
  "scraped_at": "2025-08-17 00:33:57"
}