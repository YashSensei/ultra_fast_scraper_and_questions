{
  "problem_code": "problems",
  "title": "Incomplete hierarchy",
  "tags": [],
  "text": "After many years of art, young Florian wants to work in a conglomerate. This company consists of N employees denoted 1, 2 ... N, of which some areinterns. Florian knows all interns in this company. In the hierarchy, every employee has a single boss, except for one employee (the CEO) who does not have a boss. There is no cycle within the hierarchy; in other words, the hierarchy is a tree. Also,anintern cannot be superior to a non-intern.Speaking to interns, Florian has collected a wealth of information aboutpartsof the hierarchy. Namely, for every intern he knows who his/her boss is (this boss could also be an intern).Florian now counts the distance of two interns in the hierarchy, which is the number of bosses between these interns. More precisely, thedistance in the hierarchybetween two employees is obtained by climbing the hierarchy starting with them, and counting all their direct or indirect superiors up to their first common superior (including him). If one of the observed two employees is superior to another (directly or indirectly), we only count the employees who are strictly between them in the hierarchy.Help young Florian determine thelargest distance of two internsacross the hierarchy, if this number can be uniquely determined from the known data.InputThe first line contains two integers N and M, the total number of employees in the company and the number of interns (2 ≤ M < N ≤ 100 000).Each of the following M lines contains two integers A and B, intern and his boss (1 ≤ A, B ≤ N, A ≠ B). No intern will have two bosses.OutputPrint the required largest intern distance, or -1 if the answer cannot be determined.ExamplesInput:5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4Output:2Input:7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6Output:-1Input:3 2\r\n2 1\r\n3 1Output:1",
  "sample_input": "Input:5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4Output:2",
  "sample_output": "Input:7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6Output:-1",
  "link": "https://www.spoj.com/problems/PODUZECE",
  "scraped_at": "2025-08-17 00:33:41",
  "test_cases": [
    {
      "input": "5 4\r\n2 1\r\n3 2\r\n4 3\r\n5 4",
      "expected_output": "2",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "7 4\r\n1 2\r\n2 3\r\n4 5\r\n5 6",
      "expected_output": "-1",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "8 4\n7 2\n9 9\n4 10\n4 4",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "9 2\n10 7\n6 7\n8 2\n2 10",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "4 5\n6 7\n8 7\n2 7\n6 8",
      "expected_output": "To be computed",
      "type": "small_case_5",
      "description": "Generated small test case"
    },
    {
      "input": "81 94\n7 70\n56 69\n31 88\n92 83",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "48 46\n35 12\n36 51\n54 83\n3 33",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "18 100\n68 65\n100 43\n2 19\n80 85",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "65 10\n36 100\n8 47\n42 5\n49 59",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "22 34\n49 79\n61 20\n82 30\n75 92",
      "expected_output": "To be computed",
      "type": "medium_case_10",
      "description": "Generated medium test case"
    },
    {
      "input": "48648 12986\n46974 20577\n22302 35531\n29962 8507\n14390 19356",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "48243 27427\n30307 45718\n30886 10542\n31041 24802\n36480 39101",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "33217 19947\n42393 28177\n37337 7919\n36340 17741\n39651 9010",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "22048 40700\n6231 25559\n29605 5645\n23657 27563\n31227 32365",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "12556 26284\n36978 45853\n11485 43437\n9945 48524\n38254 39228",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "31055 14712\n33948 28992\n39608 10869\n30578 24850\n45908 17834",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "5942 46275\n39622 38375\n35298 34873\n13796 16306\n7421 37985",
      "expected_output": "To be computed",
      "type": "large_case_17",
      "description": "Generated large test case"
    },
    {
      "input": "100000 100000\n100000 100000\n100000 100000\n100000 100000\n100000 100000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "100000 100000\n100000 100000\n100000 100000\n100000 100000\n100000 100000",
      "expected_output": "To be computed",
      "type": "max_case_19",
      "description": "Generated max test case"
    },
    {
      "input": "100000 1\n99999 99999\n99999 1\n1 1\n1 1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:17",
  "total_test_cases": 20
}