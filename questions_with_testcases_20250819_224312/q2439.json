{
  "problem_code": "problems",
  "title": "Rainbow",
  "tags": [],
  "text": "This time Blue Mary continues doing meaningless calculations! (see problemSPY) She is interested in calculating theK-th power of a very largeN×Nmatrix A, whereAi,j= i ×D+Qji and j are 0-based index of the row and column of element Ai,j, respectively.Now she needs your help (again).To keep the output small, you are only asked to output some of its elements.InputMultiple test cases.The first line of each test case contains 5 space-separated integersN,K,D,Q,Min this order.Mlines follow, each contains two space-separated integersRiandCi.Input terminates by EOF.All input numbers are non-negative integers and no more than 109.(D,RiandCimay be 0, others must be positive integers.)NandMwill be no more than 105.RiandCiwill be less thanN.Input is almost uniformly-random generated, and the number of \"large\" test cases is relatively small.OutputFor each test case output exactlyMlines. Each line contains only one integer: The number at theRi-th row andCi-th column (0-based) of the matrixAK. As the result may be quite large, output it modulo 109+2015.ExampleInput:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_input": "Input:10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1Output:100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/RAINBOW2",
  "scraped_at": "2025-08-17 00:34:06",
  "test_cases": [
    {
      "input": "10 3 0 1 10\r\n0 0\r\n1 1\r\n2 2\r\n3 3\r\n4 4\r\n5 5\r\n6 6\r\n7 7\r\n8 8\r\n9 9\r\n2 2 1 2 4\r\n0 0\r\n0 1\r\n1 0\r\n1 1",
      "expected_output": "100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n100\r\n5\r\n8\r\n8\r\n13",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3 2 5 3 7\n5 1\n5 3\n5 4\n8 1\n2 10\n8 2\n8 8\n9 7\n5 1\n5 8\n4 10 3 4 9\n1 10\n7 2\n4 7\n4 8",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "10 10 9 6 9\n10 10\n8 1\n5 7\n8 3\n3 10\n3 5\n7 2\n1 9\n4 10\n6 5\n4 1 6 5 1\n7 9\n4 7\n10 9\n5 7",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "2 1 7 6 3\n6 6\n4 5\n6 3\n10 6\n3 1\n4 2\n2 10\n6 8\n6 2\n7 4\n7 3 1 10 4\n3 2\n3 2\n6 1\n10 2",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "46 4 79 92 86\n30 78\n66 79\n5 51\n78 63\n30 81\n86 67\n59 67\n61 1\n76 77\n20 10\n5 43 65 90 83\n4 48\n98 90\n74 18\n46 31",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "26 25 84 95 61\n10 49\n52 48\n94 11\n86 41\n4 54\n99 36\n65 99\n76 25\n27 43\n27 40\n51 22 92 70 83\n99 6\n15 19\n98 64\n65 54",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "95 59 68 67 50\n64 65\n57 67\n62 16\n39 51\n26 95\n39 30\n53 95\n100 25\n35 51\n63 26\n75 17 29 53 9\n89 84\n65 34\n99 12\n47 15",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "50 30 98 57 62\n84 41\n16 93\n68 90\n100 63\n44 61\n52 81\n47 89\n30 57\n23 51\n40 3\n82 23 76 92 35\n20 45\n98 57\n1 48\n35 63",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "17 75 39 94 75\n89 85\n1 77\n36 80\n100 66\n59 97\n54 16\n66 24\n3 31\n7 30\n97 19\n5 49 38 12 7\n5 88\n92 39\n83 82\n6 15",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "287 192 366 112 483\n401 352\n248 246\n161 164\n119 144\n362 426\n100 272\n251 348\n389 55\n246 133\n498 368\n377 134 145 52 297\n320 155\n347 388\n64 236\n398 60",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "99 188 372 79 478\n268 449\n228 412\n339 157\n469 388\n459 125\n225 463\n425 233\n333 305\n379 74\n174 287\n460 53 380 83 487\n497 483\n277 422\n225 452\n306 396",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "458 75 144 260 411\n463 300\n452 72\n272 260\n271 218\n321 178\n328 390\n136 322\n349 427\n157 125\n300 461\n157 271 484 244 422\n198 494\n197 121\n153 147\n370 276",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "496 376 106 337 158\n235 396\n347 228\n218 459\n229 83\n85 433\n457 375\n79 455\n497 151\n98 346\n275 372\n181 54 50 232 418\n408 107\n175 299\n141 174\n196 334",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "272 488 245 78 82\n361 143\n281 136\n114 426\n163 309\n110 371\n483 202\n54 171\n421 149\n355 313\n370 488\n363 356 94 424 481\n464 346\n101 199\n214 138\n130 278",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "418 475 196 81 67\n442 165\n442 56\n78 356\n307 484\n143 158\n315 182\n373 412\n245 370\n141 69\n127 90\n155 102 418 227 69\n89 264\n363 271\n386 392\n135 262",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "334 431 371 373 127\n126 104\n308 135\n210 328\n223 278\n104 212\n457 418\n149 187\n492 421\n135 159\n226 465\n164 254 259 71 482\n328 318\n406 237\n165 270\n74 199",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000 1000 1000 1000\n1000 1000\n1000 1000\n1000 1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1 1000 1 999\n1000 999\n999 999\n999 2\n999 1\n1 2\n1000 1\n1 2\n2 1\n1 1000\n2 2\n999 999 1000 1 1\n999 2\n999 999\n2 999\n1 999",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "999 1000 1 999 1\n999 2\n999 1\n1 2\n999 1\n999 999\n1000 1000\n1 1000\n1 1\n2 1\n1 1000\n1 1 2 1 999\n1 1000\n1000 999\n2 1000\n1 2",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:20",
  "total_test_cases": 20
}