{
  "problem_code": "problems",
  "title": "Kth Shortest Path",
  "tags": [],
  "text": "EnglishVietnameseIsaac is tired of his daily trip to his office, using the same shortest route everyday. Although this saves his time, he must see the same scenery again and again. He cannot stand such a boring commutation any more.One day, he decided to improve the situation. He would change his route everyday at least slightly. His new scheme is as follows. On the first day, he uses the shortest route. On the second day, he uses the second shortest route, namely the shortest except one used on the first day. In general, on the k-th day, the k-th shortest route is chosen. Visiting the same place twice on a route should be avoided, of course.You are invited to help Isaac, by writing a program which finds his route on the k-th day. The problem is easily modeled using terms in the graph theory. Your program should find the k-th shortest path in the given directed graph.InputThe input consists of multiple datasets, each in the following format.n  m  k  a  b\r\nx1  y1  d1\r\nx2  y2  d2\r\n...\r\nxm  ym  dmEvery input item in a dataset is a non-negative integer. Two or more input items in a line are separated by a space.n is the number of nodes in the graph. You can assume the inequality 2 ≤ n ≤ 50.m is the number of (directed) edges. a is the start node, and b is the goal node. They are between 1 and n, inclusive. You are required to find the k-th shortest path from a to b. You can assume 1 ≤ k ≤ 200 and a ≠ b.The i-th edge is from the node xi to yi with the length di (1 ≤ i ≤ m). Both xi and yi are between 1 and n, inclusive. di is between 1 and 10000, inclusive. You can directly go from xi to yi, but not from yi to xi unless an edge from yi to xi is explicitly given. The edge connecting the same pair of nodes is unique, if any, that is, if i ≠ j, it is never the case that xi equals xj and yi equals yj. Edges are not connecting a node to itself, that is, xi never equals yi. Thus the inequality 0 ≤ m ≤ n(n − 1) holds.Note that the given graph may be quite unrealistic as a road network. Both the cases m = 0 and m = n(n − 1) are included in the judges’ data.The last dataset is followed by a line containing five zeros (separated by a space).OutputFor each dataset in the input, one line should be output as specified below. An output line should not contain extra characters such as spaces.If the number of distinct paths from a to b is less than k, the string \"None\" should be printed. Note that the first letter of None is in uppercase, while the other letters are in lowercase.If the number of distinct paths from a to b is k or more, the node numbers visited in the k-th shortest path should be printed in the visited order, separated by a hyphen (minus sign). Note that a must be the first, and b must be the last in the printed line.In this problem the term shorter (thus shortest also) has a special meaning. A path P is defined to be shorter than Q, if and only if one of the following conditions holds.The length of P is less than the length of Q. The length of a path is defined to be the sum of lengths of edges on the path.The length of P is equal to the length of Q, and P’s sequence of node numbers comes earlier than Q’s in the dictionary order. Let’s specify the latter condition more precisely. Denote P’s sequence of node numbers by p1, p2 ... ps, and Q’s by q1, q2 ... qt. p1 = q1 = a and ps = qt = b should be observed. The sequence P comes earlier than Q in the dictionary order, if for some r (1 ≤ r ≤ s and r ≤ t), p1 = q1, …, p(r − 1) = q(r − 1), and pr < qr (pr is numerically smaller than qr).A path visiting the same node twice or more is not allowed.SampleInput5 20 10 1 5\r\n1 2 1\r\n1 3 2\r\n1 4 1\r\n1 5 3\r\n2 1 1\r\n2 3 1\r\n2 4 2\r\n2 5 2\r\n3 1 1\r\n3 2 2\r\n3 4 1\r\n3 5 1\r\n4 1 1\r\n4 2 1\r\n4 3 1\r\n4 5 2\r\n5 1 1\r\n5 2 1\r\n5 3 1\r\n5 4 1\r\n4 6 1 1 4\r\n2 4 2\r\n1 3 2\r\n1 2 1\r\n1 4 3\r\n2 3 1\r\n3 4 1\r\n3 3 5 1 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n0 0 0 0 0Output1-2-4-3-5\r\n1-2-3-4\r\nNone",
  "sample_input": "n  m  k  a  b\r\nx1  y1  d1\r\nx2  y2  d2\r\n...\r\nxm  ym  dm",
  "sample_output": "Input5 20 10 1 5\r\n1 2 1\r\n1 3 2\r\n1 4 1\r\n1 5 3\r\n2 1 1\r\n2 3 1\r\n2 4 2\r\n2 5 2\r\n3 1 1\r\n3 2 2\r\n3 4 1\r\n3 5 1\r\n4 1 1\r\n4 2 1\r\n4 3 1\r\n4 5 2\r\n5 1 1\r\n5 2 1\r\n5 3 1\r\n5 4 1\r\n4 6 1 1 4\r\n2 4 2\r\n1 3 2\r\n1 2 1\r\n1 4 3\r\n2 3 1\r\n3 4 1\r\n3 3 5 1 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n0 0 0 0 0Output1-2-4-3-5\r\n1-2-3-4\r\nNone",
  "link": "https://www.spoj.com/problems/MKTHPATH",
  "scraped_at": "2025-08-17 00:33:38",
  "test_cases": [
    {
      "input": "n  m  k  a  b\r\nx1  y1  d1\r\nx2  y2  d2\r\n...\r\nxm  ym  dm",
      "expected_output": "Input5 20 10 1 5\r\n1 2 1\r\n1 3 2\r\n1 4 1\r\n1 5 3\r\n2 1 1\r\n2 3 1\r\n2 4 2\r\n2 5 2\r\n3 1 1\r\n3 2 2\r\n3 4 1\r\n3 5 1\r\n4 1 1\r\n4 2 1\r\n4 3 1\r\n4 5 2\r\n5 1 1\r\n5 2 1\r\n5 3 1\r\n5 4 1\r\n4 6 1 1 4\r\n2 4 2\r\n1 3 2\r\n1 2 1\r\n1 4 3\r\n2 3 1\r\n3 4 1\r\n3 3 5 1 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n0 0 0 0 0Output1-2-4-3-5\r\n1-2-3-4\r\nNone",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "pdij ibnf riwov wswsi ghi\n4 2 6\ne gdjs bzoe\n2 4 4\nqbmt dvsl bnz\nij\ndbxdc yo l",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "ld cxhy bw k v\n4 8 4\nvzzuw xdu uws\n6 3 2\nquk ddnen oxbmv\nwaa\nktf o h",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "iqphc komny ok fy ssow\n7 9 6\nvvj jsczo u\n10 7 3\nhwp kn vki\nil\njmzh iog e",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "t tuhw ox pd wdnag\n16 33 1\nug kcnd ctd\n34 33 31\nosq fpfr opy\nsxvdy\nod yu qd",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "hnwni e ov vbq zo\n27 19 47\nrdp al adlz\n19 22 26\njueod gni ropdn\ngqkhw\noot zdax zvm",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "rg lwtg kvakl b mmir\n35 16 47\nrucvn o syj\n47 46 28\nxzw d amq\nwrp\nhnfuq tcp nxgjk",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "b cra nvi gcza rw\n1 11 46\nquc qjyrd eqrvw\n4 23 24\nhiaw rlso h\nfeb\npkt p h",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "aq yajz juf cc khqam\n41 7 26\njxg kfy ryzql\n49 46 3\nxet ysbd derc\nkqvd\nntfzm fdj ojk",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "o jt vj u nhdk\n25 17 19\nlrm ca zgpi\n13 13 7\nzoj yk l\ny\nmgdl pwj jud",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "lxqg i qdf pyn fmvn\n24 21 24\njuxsh qptg xgulb\n19 17 2\ngfbh jgc g\nkkfo\nxaj r cok",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "csejw zc qrvzc qu jlost\n10 16 8\nfobeu scn qzh\n14 6 5\nffex dwkrt ipu\nxlhj\nuvgtg yjv qczf",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "lnvj mlti nrq pokm u\n23 18 14\nkq ukl qrsqf\n11 7 17\nifti pdn tkvp\nlvd\nywjh x fbdcx",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "cja advb nwl aqn z\n23 3 14\nrfa alwk bil\n3 6 16\nmky pp zgvmj\nuaj\nwg fm rhaf",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "gudu mul s lwm epi\n5 14 20\nez kheuz f\n14 4 5\ncsfwz h t\ntdbjl\nt gwzvv tzc",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "tvf ldu dar ktei d\n19 19 6\nnpk afvhq wyp\n6 25 21\nkngiy ze yqzkx\nv\nnet vpjo bp",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "uogg nhtb b i cmyqr\n50 50 50\njdeqm ups joo\n50 50 50\nutg eh l\nenlf\nqpc rbat c",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "hunfc qmuh coo dnq zotzh\n50 50 50\naodhk b hkzc\n50 50 50\nov irmn xcriq\nk\noboe bcsnj qakg",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "yyntg difv zutcc jd m\n50 49 2\nsuq fi sabjh\n49 1 1\naphzb qnbh sgf\ncan\ne vzpcp mh",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "p uyh r ktkwa jozp\n49 2 1\nuas pyuog zom\n2 50 1\nxkxx snuw evrbe\nd\nog zrl lcrv",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:17",
  "total_test_cases": 20
}