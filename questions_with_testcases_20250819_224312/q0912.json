{
  "problem_code": "problems",
  "title": "A HUGE TOWER",
  "tags": [],
  "text": "The ancient Babylonians decided to build a huge tower. The tower consists ofNcubic building blocks that are stacked one onto another. The Babylonians gathered many building blocks of various sizes from all over the country. From their last unsuccessful attempt they have learned that if they put a large block directly onto a much smaller block, the tower will fall.Task specificationEach two building blocks are different, even if they have the same size. For each building block you are given its side length. You are also given an integerDwith the following meaning: you are not allowed to put block A directly onto block B if the side length of A is strictly larger thanDplus the side length of B.Compute the number of different ways in which it is possible to build the tower usingallthe building blocks. Since this number can be very large, output the result modulo 109+ 9.Input specificationThe first line of the input contains two positive integersNandD: the number of building blocks and the tolerance respectively.The second line containsNspace-separated integers; each represents the size of one building block.ConstraintsAll numbers in the input files are positive integers not exceeding 109.Nis always at least 2.In test cases worth 70 pointsNwill be at most 70.Out of those, in test cases worth 45 points,Nwill be at most 20.Out of those, in test cases worth 10 points,Nwill be at most 10.For some of the test cases the total number of valid towers will not exceed 1,000,000. These test cases are worth 30 points in total.For the last six test cases (worth 30 points) the value ofNis larger than 70. No upper bound onNis given for these test cases.Output specificationOutput a single line containing a single integer: the number of towers that can be built, modulo 1,000,000,009.Examplesinput:4 1\r\n1 2 3 100output:4We can arrange the first three blocks in any order, except for 2, 1, 3 or 1, 3, 2. The last block has to be at the bottom.input:6 9\r\n10 20 20 10 10 20output:36We are not allowed to put a cube of size 20 onto a cube of size 10. There are six ways to order the cubes of size 10, and six ways to order the cubes of size 20.",
  "sample_input": "input:4 1\r\n1 2 3 100output:4",
  "sample_output": "input:6 9\r\n10 20 20 10 10 20output:36",
  "link": "https://www.spoj.com/problems/CTOI10D3",
  "scraped_at": "2025-08-17 00:33:05",
  "test_cases": [
    {
      "input": "input:4 1\r\n1 2 3 100output:4",
      "expected_output": "input:6 9\r\n10 20 20 10 10 20output:36",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "1 1\nkkqotro 4\n2 8 7 1 1\n4 8 5 lqffkowwf",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "9 5\nltkhqy 10\n9 9 4 9 6\n6 2 2 czzub",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "1 5\neeqsk 5\n2 5 7 9 3\n8 4 7 facgjrjbqjy",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "31 65\nuigi 59\n50 31 40 38 4\n97 51 56 zmzjxvmm",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "21 12\nrmcnexl 62\n57 11 82 65 63\n48 3 12 gijqrlhqavt",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "63 94\nmckajne 39\n89 45 23 68 75\n9 87 41 sooblj",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "35 88\nct 8\n65 97 25 95 83\n48 29 10 wu",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "45 17\nhjxcv 4\n10 8 42 50 38\n93 43 43 lb",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "325 180\nd 345\n176 242 263 495 144\n420 206 370 tolmpuw",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "419 403\ni 154\n305 293 193 115 142\n147 254 143 uzeadmw",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "171 417\nzj 486\n306 340 292 467 444\n344 254 266 bgcejuvnaa",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "387 419\nioyr 414\n150 497 224 181 129\n413 190 188 ydcyloggdhz",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "221 261\nqouubs 309\n235 135 350 174 300\n418 165 218 yxyecdjqaeo",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "225 485\nf 382\n108 164 264 442 205\n162 198 393 er",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "136 194\nzhavnvz 338\n378 297 177 260 314\n340 414 449 quz",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000\nslwjoob 1000\n1000 1000 1000 1000 1000\n1000 1000 1000 zkyswonjsg",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000\nzj 1000\n1000 1000 1000 1000 1000\n1000 1000 1000 oezbeieexzb",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000\npnp 1000\n1000 1 2 2 1000\n999 1 1 cdwhixyovx",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "2 1000\nge 1\n999 999 1000 1 1\n1000 2 1000 w",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:15",
  "total_test_cases": 20
}