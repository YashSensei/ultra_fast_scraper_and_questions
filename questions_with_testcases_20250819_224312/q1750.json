{
  "problem_code": "problems",
  "title": "Query on a tree VII",
  "tags": [],
  "text": "You are given a tree (an acyclic undirected connected graph) with n nodes. The tree nodes are numbered from 1 ton. Each node has a color, white or black, and a weight. We will ask you to perform some instructions of the following form:0 u: ask for the maximum weight among the nodes which are connected tou, two nodes are connected if all the node on the path fromutov(inclusiveuandv) have a same color.1 u: toggle the color ofu(that is, from black to white, or from white to black).2 u w: change the weight ofutow.InputThe first line contains a numberndenoted how many nodes in the tree(1 ≤n≤ 105). The nextn-1 lines, each line has two numbers (u,v) describe a edge of the tree(1 ≤u,v≤ n).  The next 2 lines, each line containsnnumber, the first line is the initial color of each node(0 or 1), and the second line is the initial weight, let's say Wi, of each node(|Wi| ≤ 109).  The next line contains a numbermdenoted how many operations we are going to process(1 ≤m≤ 105). The nextmlines, each line describe a operation (t,u) as we mentioned above(0 ≤t≤ 2, 1 ≤u≤n, |w| ≤ 109).OutputFor each query operation, output the corresponding result.ExampleInput 1:5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0 1 1 1 1\r\n1 2 3 4 5\r\n3\r\n0 1\r\n1 1\r\n0 1Output 1:1\r\n5Input 2:7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0 0 0 0 0 0 0\r\n1 2 3 4 5 6 7\r\n4\r\n0 1\r\n1 1\r\n0 2\r\n0 3Output 2:7\r\n5\r\n7Warning: large input/output data ,be careful with certain languages",
  "sample_input": "Input 1:5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0 1 1 1 1\r\n1 2 3 4 5\r\n3\r\n0 1\r\n1 1\r\n0 1Output 1:1\r\n5",
  "sample_output": "Input 2:7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0 0 0 0 0 0 0\r\n1 2 3 4 5 6 7\r\n4\r\n0 1\r\n1 1\r\n0 2\r\n0 3Output 2:7\r\n5\r\n7",
  "link": "https://www.spoj.com/problems/QTREE7",
  "scraped_at": "2025-08-17 00:33:48",
  "test_cases": [
    {
      "input": "Input 1:5\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n0 1 1 1 1\r\n1 2 3 4 5\r\n3\r\n0 1\r\n1 1\r\n0 1Output 1:1\r\n5",
      "expected_output": "Input 2:7\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n3 6\r\n3 7\r\n0 0 0 0 0 0 0\r\n1 2 3 4 5 6 7\r\n4\r\n0 1\r\n1 1\r\n0 2\r\n0 3Output 2:7\r\n5\r\n7",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "10 10\nx jy\n9 7\n9 6\n7 4\n2 3\n4 9 5 1 9\n9 9 2 5 2\n7\n6 1\n4 3\n1 8 9 1\n9 zadqmq iw\n4",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "9 2\nqdpn o\n2 8\n7 9\n6 5\n3 10\n8 6 5 5 7\n4 5 8 5 4\n4\n5 4\n10 9\n3 8 10 10\n5 dtq qt\n1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "3 5\ntp fh\n7 8\n4 6\n7 7\n2 8\n10 3 4 5 6\n8 7 1 4 8\n2\n5 9\n9 8\n3 6 8 3\n3 jnfrxou pux\n1",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "69 66\nmn qkoe\n58 39\n5 38\n92 10\n53 96\n51 46 75 100 93\n79 90 100 72 56\n60\n58 27\n80 16\n84 14 12 86\n35 kur jpvi\n75",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "40 92\na htj\n66 67\n17 48\n86 66\n84 30\n67 20 85 55 58\n13 15 77 29 14\n26\n59 78\n35 10\n42 47 11 53\n84 hkqhpqq kaug\n67",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "24 84\niaj b\n15 92\n58 25\n16 10\n34 69\n72 87 13 47 76\n2 12 7 69 88\n5\n25 22\n64 30\n38 32 70 100\n51 gl pvk\n52",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "98 73\ndnytp du\n58 85\n15 21\n44 89\n15 70\n23 72 49 6 19\n15 74 88 58 24\n56\n29 63\n28 60\n34 12 19 88\n10 fblrtb nykxd\n30",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "94 53\nwqwh fi\n49 58\n8 57\n46 65\n21 78\n39 45 20 97 70\n66 73 47 83 58\n95\n16 7\n14 50\n22 31 14 32\n39 kyo emr\n16",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "33 11\nbhym iz\n40 7\n16 50\n38 35\n28 28\n40 35 31 18 29\n12 44 18 9 32\n22\n22 43\n10 6\n20 37 17 46\n7 h uxba\n12",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "32 43\nfcdo xmxvi\n48 27\n22 39\n44 9\n33 50\n43 11 15 47 34\n43 38 19 38 37\n30\n25 16\n29 30\n42 28 26 31\n40 lrrxx s\n16",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "24 27\nifxfq kgn\n46 48\n43 36\n25 47\n34 35\n37 20 22 37 13\n8 18 32 47 31\n43\n9 34\n21 37\n17 39 52 44\n31 ffzqu yh\n22",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "14 7\npiyy vo\n32 46\n46 21\n43 10\n17 14\n9 33 30 46 16\n22 29 32 23 35\n40\n43 21\n32 18\n29 31 36 38\n32 eqfg ifi\n16",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "10 39\ni ci\n31 33\n44 13\n40 10\n39 24\n30 42 14 37 10\n22 29 6 44 27\n42\n18 16\n12 14\n48 47 46 19\n17 bne xnsab\n25",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "10 44\nuedam aqxh\n51 5\n48 22\n42 26\n14 52\n43 9 9 38 46\n8 27 46 32 46\n28\n31 15\n45 45\n26 18 46 18\n9 beoz zwfql\n41",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "10 52\nbr jtdo\n45 21\n51 11\n31 32\n32 34\n47 29 25 19 52\n26 34 18 17 26\n34\n45 9\n27 9\n33 29 25 47\n30 ilp eye\n43",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "105 105\nhrg jqcra\n105 105\n105 105\n105 105\n105 105\n105 105 105 105 105\n105 105 105 105 105\n105\n105 105\n105 105\n105 105 105 105\n105 kbug es\n105",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "105 105\nueqo zq\n105 105\n105 105\n105 105\n105 105\n105 105 105 105 105\n105 105 105 105 105\n105\n105 105\n105 105\n105 105 105 105\n105 wizgmuj lhahv\n105",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1 2\nrqwya cliz\n2 2\n1 105\n105 1\n1 1\n104 2 105 1 104\n105 105 105 105 2\n105\n1 2\n105 104\n105 105 1 2\n2 avzxkhz c\n104",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "1 2\ncub tsb\n105 1\n1 105\n105 105\n2 104\n104 104 105 2 105\n104 1 1 2 2\n1\n105 104\n2 1\n2 2 1 105\n104 wrogom o\n1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:18",
  "total_test_cases": 20
}