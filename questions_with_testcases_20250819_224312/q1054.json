{
  "problem_code": "problems",
  "title": "Induced favoritism",
  "tags": [],
  "text": "In a kingdom far, far away there are N cities numbered 1 through N, some pairs of cities being connected by roads. When two cities are directly connected by a road, we will say these cities are neighbors. As a result of the careful planning of its monarchs, the kingdom's road system has very special characteristics. We know there are no two cities connected by more than one road, and that all roads connect different cities. Another very peculiar property of the roads is that there is exactly one path between any two cities, consisting of a sequence of roads connecting neighboring cities from the initial to the final one.In this kingdom far, far away, the king wants to impose curling as the national sport. He therefore wants each city to have a favorite curling team, so that the feeling of belonging of its citizens is enhanced by all of them supporting the same team. There are some cities which already have a favorite team, and because curling is a deep passion these choices cannot be changed. However, other cities don't yet have a favorite curling team, so one will have to be assigned to them in order for it to become the city's favorite.The president of the Institute for the Competitive Practice of Curling (ICPC) has requested your help, because the king has entrusted it with assigning the favorite teams for the cities that don't yet have one. The problem is that there are too many cities in the kingdom, so the ICPC doesn't really know how to complete this task. We know there are E curling teams which have been numbered 1 through E, and there is no budget to create more. The ICPC has provided you with a riot index between teams for every pair of teams, i.e. an integer D[i, j] representing the degree of hostility between followers of teams i and j, for i, j = 1, 2, ..., E. Note that there even exists a riot index for a given team with itself, as it is possible that inhabitants of two neighboring cities with the same favorite team start to fight in order to see which one has the best following.The ICPC has asked you to assign a favorite team to every city in the kingdom not having one yet, in such a way that the riots between neighboring cities are minimized. In order to do this, you should minimize the national riot index, which is calculated by summing all the riot indices for teams assigned to neighboring cities. Can you help the ICPC determine the minimum possible value of the national riot index?In a kingdom far, far away there areNcities numbered1throughN, some pairs of cities being connected by roads. When two cities are directly connected by a road, we will say these cities are neighbors. As a result of the careful planning of its monarchs, the kingdom's road system has very special characteristics. We know there are no two cities connected by more than one road, and that all roads connect different cities. Another very peculiar property of the roads is that there is exactly one path between any two cities, consisting of a sequence of roads connecting neighboring cities from the initial to the final one.In this kingdom far, far away, the king wants to impose curling as the national sport. He therefore wants each city to have a favorite curling team, so that the feeling of belonging of its citizens is enhanced by all of them supporting the same team. There are some cities which already have a favorite team, and because curling is a deep passion these choices cannot be changed. However, other cities don't yet have a favorite curling team, so one will have to be assigned to them in order for it to become the city's favorite.The president of theInstitute for the Competitive Practice of Curling(ICPC) has requested your help, because the king has entrusted it with assigning the favorite teams for the cities that don't yet have one. The problem is that there are too many cities in the kingdom, so the ICPC doesn't really know how to complete this task. We know there areEcurling teams which have been numbered1throughE, and there is no budget to create more. The ICPC has provided you with a riot index between teams for every pair of teams,i.e.an integerDijrepresenting the degree of hostility between followers of teamsiandj, fori, j = 1, 2, ..., E. Note that there even exists a riot index for a given team with itself, as it is possible that inhabitants of two neighboring cities with the same favorite team start to fight in order to see which one has the best following.The ICPC has asked you to assign a favorite team to every city in the kingdom not having one yet, in such a way that the riots between neighboring cities are minimized. In order to do this, you should minimize the national riot index, which is calculated by summing all the riot indices for teams assigned to neighboring cities. Can you help the ICPC determine the minimum possible value of the national riot index?InputThere are multiple test cases in the input file. For each test case, the first line contains two integersNandE, representing respectively the number of cities and the number of curling teams in the kingdom (2 ≤ N ≤ 5 * 104and1 ≤ E ≤ 50). The followingElines describe the riot indices between the curling teams. Each of these lines containsEintegers, thej-th integer of thei-th of these lines beingDij, the riot index between teamsiandj(0 ≤ Dij≤ 1000withDij= Djifori, j = 1, 2, ..., E).The followingElines describe the favorite teams of the cities which have already chosen one. Thei-th of these lines starts with a non-negative integerKifollowed by a list ofKicities whose favorite team is numberi(0 ≤ Ki≤ Nfori = 1, 2, ..., E). No city has more than one favorite team, and there are no repeated cities in the lists.The lastN-1lines describe the roads between the kingdom's cities. Each of them contains two integersAandB, indicating that there is a road between cityAand cityB(1 ≤ A, B ≤ NwithA ≠ B). The roads are bidirectional and there are no repeated roads in the input. It is guaranteed that there is a unique path between every pair of cities, possibly going through other intermediate cities.OutputFor each test case, print one line containing an integer representing the minimum value of the national riot index that can be achieved by optimally assigning the favorite teams.ExampleInput:3 2\r\n2 1\r\n1 2\r\n0\r\n0\r\n1 2\r\n1 3\r\n6 3\r\n3 2 1\r\n2 3 4\r\n1 4 3\r\n2 1 3\r\n0\r\n0\r\n1 2\r\n1 3\r\n1 4\r\n3 5\r\n3 6Output:2\r\n7",
  "sample_input": "Input:3 2\r\n2 1\r\n1 2\r\n0\r\n0\r\n1 2\r\n1 3\r\n6 3\r\n3 2 1\r\n2 3 4\r\n1 4 3\r\n2 1 3\r\n0\r\n0\r\n1 2\r\n1 3\r\n1 4\r\n3 5\r\n3 6Output:2\r\n7",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TAP2015F",
  "scraped_at": "2025-08-17 00:33:28",
  "test_cases": [
    {
      "input": "3 2\r\n2 1\r\n1 2\r\n0\r\n0\r\n1 2\r\n1 3\r\n6 3\r\n3 2 1\r\n2 3 4\r\n1 4 3\r\n2 1 3\r\n0\r\n0\r\n1 2\r\n1 3\r\n1 4\r\n3 5\r\n3 6",
      "expected_output": "2\r\n7",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "4 2\n1 4\n1 2\n1\n1\n3 3\n2 1\n3 5\n5 2 3\n2 1 1\n5 2 2\n3 3 4\n4\n1\n2 2\n5 5\n4 4\n2 2\n2 4",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "4 5\n5 4\n3 5\n2\n1\n1 3\n5 2\n1 3\n4 5 5\n5 5 3\n3 5 3\n5 1 5\n3\n3\n1 2\n1 2\n2 1\n4 3\n5 1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "3 1\n1 3\n2 5\n1\n5\n4 3\n5 5\n1 1\n5 4 5\n3 5 2\n3 5 1\n3 3 3\n4\n3\n4 2\n1 3\n2 5\n4 3\n1 2",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "5 2\n3 1\n4 4\n3\n1\n4 1\n3 1\n1 1\n3 5 1\n1 5 1\n5 2 5\n2 1 1\n4\n3\n1 1\n2 5\n4 2\n1 1\n2 1",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "4 2\n3 1\n1 4\n3\n2\n3 2\n3 4\n2 1\n4 4 2\n4 4 2\n3 5 2\n1 2 3\n3\n2\n4 1\n4 3\n5 4\n2 5\n1 5",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "5 5\n3 4\n5 3\n5\n1\n3 4\n5 3\n4 4\n4 3 4\n2 4 3\n2 3 4\n3 4 4\n1\n5\n2 3\n5 5\n2 1\n3 5\n3 2",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "1 1\n5 1\n4 4\n3\n1\n5 2\n1 1\n2 2\n1 1 4\n1 5 4\n4 3 1\n5 4 3\n5\n2\n5 3\n4 4\n5 4\n2 5\n1 5",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "3 3\n2 2\n4 3\n1\n4\n4 4\n5 1\n2 5\n3 5 3\n2 1 3\n2 2 1\n4 4 2\n4\n1\n5 1\n1 1\n4 3\n3 2\n3 5",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "1 1\n2 2\n1 2\n2\n2\n1 1\n2 2\n1 1\n2 1 2\n2 2 1\n1 2 1\n1 1 1\n2\n1\n2 1\n1 2\n2 1\n1 1\n1 1",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "1 2\n1 2\n2 2\n2\n2\n1 1\n2 2\n2 1\n1 2 1\n1 1 2\n2 1 1\n2 2 1\n2\n1\n1 2\n2 1\n2 1\n1 1\n1 2",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "2 1\n2 2\n2 2\n2\n2\n1 2\n1 2\n2 2\n1 2 2\n1 2 1\n1 1 2\n2 1 2\n1\n2\n2 1\n1 2\n1 2\n1 1\n1 1",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "1 2\n2 2\n2 2\n1\n1\n2 1\n1 2\n1 2\n2 1 2\n1 1 1\n1 1 1\n2 1 1\n1\n2\n1 2\n1 2\n1 1\n2 2\n1 1",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "1 2\n2 2\n1 2\n1\n2\n2 1\n2 2\n2 2\n1 2 2\n2 1 1\n1 2 1\n1 2 1\n2\n1\n2 2\n1 1\n2 2\n1 1\n1 2",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "2 2\n2 2\n2 2\n1\n2\n2 1\n2 2\n1 2\n2 2 1\n2 2 2\n1 1 1\n2 1 2\n1\n2\n2 2\n1 1\n2 2\n1 2\n1 1",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "1 2\n2 2\n2 1\n2\n2\n1 1\n2 2\n2 2\n1 2 1\n2 1 2\n2 1 2\n2 1 1\n2\n1\n1 1\n1 2\n2 2\n2 1\n2 2",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "5 5\n5 5\n5 5\n5\n5\n5 5\n5 5\n5 5\n5 5 5\n5 5 5\n5 5 5\n5 5 5\n5\n5\n5 5\n5 5\n5 5\n5 5\n5 5",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "5 5\n5 5\n5 5\n5\n5\n5 5\n5 5\n5 5\n5 5 5\n5 5 5\n5 5 5\n5 5 5\n5\n5\n5 5\n5 5\n5 5\n5 5\n5 5",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "4 5\n4 1\n4 5\n1\n2\n5 4\n1 2\n2 5\n4 5 4\n1 5 4\n1 2 1\n5 4 1\n1\n5\n5 2\n4 5\n5 5\n1 5\n4 2",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "4 1\n2 5\n5 5\n1\n4\n5 1\n4 4\n1 4\n5 5 1\n5 5 2\n4 2 2\n5 5 5\n2\n5\n5 2\n2 2\n1 1\n2 4\n5 2",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:16",
  "total_test_cases": 20
}