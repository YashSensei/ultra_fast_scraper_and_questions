{
  "problem_code": "problems",
  "title": "Moon Safari (Extreme)",
  "tags": [],
  "text": "This problem is a harder version ofMOON2.Your task is: given $N$, $a$ and $r$, compute$$ S(N, a, r) = \\sum_{i=1}^N a^i i^r. $$InputThe first line contains an integer $T$, the number of test cases.On the next $T$lines, you will be given three integers $N$, $a$and $r$.OutputOutput $T$lines, one for each test case, with $S(N, a, r)$.Since the answer can get very big, output it modulo $10^9+7$.ExampleInput:23 4 56 7 8Output:16068329990641ConstraintsOverall constraints:$1 \\leq T \\leq 10^5$$1 \\leq N \\leq 10^{18}$$1 \\leq a \\leq 10^{18}$$1 \\leq r \\leq 10^8$More precise information: there are 6 test cases.Test #0: $1 \\leq T \\leq 100000$ and $1 \\leq r \\leq 1000$.Test #1:$1 \\leq T \\leq 10000$ and $1 \\leq r \\leq 10000$.Test #2:$1 \\leq T \\leq 1000$ and $1 \\leq r \\leq 100000$.Test #3:$1 \\leq T \\leq 100$ and $1 \\leq r \\leq 1000000$.Test #4:$1 \\leq T \\leq 10$ and $1 \\leq r \\leq 10000000$.Test #5:$T = 1$ and $1 \\leq r \\leq 100000000$.InformationFour trips on the moon are provided,Moon(easy),Moon1(medium),Moon2(hard),Moon4(extreme) with different constraints.Please pay attention to the constraints which may differ from the previous versions.Also please handle the constraints carefully.We do not provide the intended time complexity in order to encourage possible various ways of thinking.My fastest C++ code got AC under in 12.14s. (approx 2.02s per file)Good luck and have fun :-)You may be surprised why the code of this problem is notMoon3. It is because4 is a lucky number on the moon.This problem is the 4th one in the Moon series.4 is a power of 2, which indicates exponential increasing difficulty starting from 2.Moon3 has been used.",
  "sample_input": "Input:23 4 56 7 8Output:16068329990641",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/MOON4",
  "scraped_at": "2025-08-17 00:33:59",
  "test_cases": [
    {
      "input": "23 4 56 7 8",
      "expected_output": "16068329990641",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "2 1 10 10 5",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "10 2 3 1 1",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "2 8 3 1 2",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "61 59 71 75 19",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "11 98 30 46 89",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "26 53 4 86 19",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "67 57 18 5 56",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "9 85 58 90 55",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "144 467 182 156 187",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "214 368 93 51 470",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "76 441 152 54 261",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "455 179 213 374 126",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "133 121 469 454 293",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "489 486 393 321 354",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "328 358 444 224 205",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "999 2 1000 999 1",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "1 2 1000 2 1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:21",
  "total_test_cases": 20
}