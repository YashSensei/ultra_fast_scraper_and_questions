{
  "problem_code": "problems",
  "title": "Treasure Island",
  "tags": [],
  "text": "Finding the treasures hidden centuries ago by the pirates of the Caribbean islands is no easy task, but even more difficult is living to tell the story. This is because, as everybody knows, pirates had supernatural powers which they used to curse the person who took their treasure unauthorized.A very common curse among the most powerful of pirates, and for which it is always a good idea to be prepared, is known today as thedeadly mist. Whenever a pirate's treasure is found, this curse will make a poisonous mist lift from the ground until the whole island gets covered by it. Any living creature that is touched by the mist will die instantly, something especially undesirable for those who have just found a treasure. The only way to save yourself is then to return to your boat, always going through areas that have not yet been covered by the mist, and thus flee with that part of the treasure that may have been rescued. In this problem we are interested in knowing what's the maximum amount of time that one can take to collect the treasure in such a way so as to be able to return to the boat alive.To simplify the problem, we will consider that an island can be represented by a grid withRrows andCcolumns, in which the cell in thei-th row and thej-th column has heightHijabove sea level. Furthermore, we will assume that the treasure is always hidden in the cell in row1and column1, because this is the one furthest away from the only place where the boat can set anchor, which is the cell in rowRand columnC. The deadly mist appears at sea level at the very same instant that the treasure is found, and then rises on all the island at a rate of one unit of height per second, so that aftertseconds one cannot be in any cell of height less or equal tot. In order to return to the boat, you may go from one cell to another only if they share a side, so that if you are on a given cell you can only move horizontally to the cell before or after it in the same row, or vertically to the cell before or after it in the same column, but you cannot move diagonally or cross the boundaries of the island. Each such movement from one cell to another takes exactly one second.InputThe first line contains two integer numbersRandC, respectively the number of rows and columns of the grid that represents the island, which consists of at least two cells (1 ≤ R, C≤500andR×C ≥ 2). Each of the followingRlines containsCvalues. In thei-th of theseRlines, thej-th value is an integerHijrepresenting the height of the cell at rowiand columnj(1≤Hij≤106fori = 1, ..., Randj = 1, ..., C).OutputPrint a single line containing an integer number representing the maximum amount of time in seconds that one can take to collect the treasure, so as to be able to return to the boat without being reached by the deadly mist. Print the number-1if it is impossible to return to the boat even if one starts the way back as soon as the treasure is discovered.Example 1Input:3 3\r\n2 3 4\r\n3 4 5\r\n4 5 6Output:1Example 2Input:3 3\r\n1 2 3\r\n2 2 3\r\n2 4 5Output:-1Example 3Input:3 2\r\n1000000 1000000\r\n1000000 1000000\r\n1000000 314Output:310",
  "sample_input": "Input:3 3\r\n2 3 4\r\n3 4 5\r\n4 5 6Output:1",
  "sample_output": "Input:3 3\r\n1 2 3\r\n2 2 3\r\n2 4 5Output:-1",
  "link": "https://www.spoj.com/problems/TAP2013I",
  "scraped_at": "2025-08-17 00:33:32",
  "test_cases": [
    {
      "input": "3 3\r\n2 3 4\r\n3 4 5\r\n4 5 6",
      "expected_output": "1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3 3\r\n1 2 3\r\n2 2 3\r\n2 4 5",
      "expected_output": "-1",
      "type": "sample_2",
      "description": "Original sample 2 from problem statement"
    },
    {
      "input": "10 3\n9 5 5\n3 3 10\n4 4 7",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "1 7\n9 8 1\n7 2 3\n1 2 5",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "9 6\n8 5 7\n10 1 1\n8 10 6",
      "expected_output": "To be computed",
      "type": "small_case_5",
      "description": "Generated small test case"
    },
    {
      "input": "5 62\n32 21 35\n20 5 62\n15 60 61",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "58 17\n50 58 13\n9 73 34\n49 3 10",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "37 44\n37 100 83\n80 91 54\n45 91 84",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "42 64\n66 22 18\n42 30 38\n11 73 64",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "21 68\n55 90 71\n72 95 25\n29 97 26",
      "expected_output": "To be computed",
      "type": "medium_case_10",
      "description": "Generated medium test case"
    },
    {
      "input": "486 238\n473 146 197\n235 197 125\n491 115 147",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "328 364\n490 327 458\n401 64 332\n84 96 425",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "50 332\n259 312 230\n58 329 171\n212 393 79",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "218 60\n188 178 142\n342 135 453\n130 138 120",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "62 387\n124 371 266\n58 341 451\n279 221 255",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "424 93\n255 326 357\n309 276 307\n241 308 62",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "87 357\n212 426 226\n304 87 165\n307 467 161",
      "expected_output": "To be computed",
      "type": "large_case_17",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000\n1000 1000 1000\n1000 1000 1000\n1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000\n1000 1000 1000\n1000 1000 1000\n1000 1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_19",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000\n2 1000 1\n1 1 1\n1000 2 999",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:18",
  "total_test_cases": 20
}