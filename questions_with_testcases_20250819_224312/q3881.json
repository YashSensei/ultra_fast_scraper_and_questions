{
  "problem_code": "problems",
  "title": "Nested Palindromes",
  "tags": [],
  "text": "Palindromes are numbers that read the same forwards and backwards. Your friend Percy recently became interested in a special kind of palindrome that he calls aNested Palindrome. ANested Palindromemeets three conditions:The number is a palindrome.Split the number in the middle. The first half of the digits of the number is also aNested Palindrome. If the number has an odd number of digits, don’t consider the middle digit as part of the first half.No two adjacent digits are the same.Percy says that he has written aNested Palindromewith no leading zeros on a slip of paper. Next, Percy says that he has erased some of the digits in the number and replaced those digits with question marks. He asks you to think about all possible numbers, in increasing order, that can fill those digits and could possibly form the number Percy wrote. Of course, Percy may not be telling the truth about having written aNested Palindromein the first place.Percy tells you that the number he wrote is thekth number of this potentially large list. Your task is to find thatkth number.InputThere will be several test cases in the input. Each test case will consist of two lines. The first line will contain an integerk(1 ≤k≤ 1018), which is the position in the ordered list you must find. The second line contains a string of length 1 to 10,000, consisting only of digits (‘0’ to ‘9’) and question marks (‘?’). Input is terminated by a line with a single0.OutputFor each test case, output theNested Palindromethat Percy is looking for. If that number does not exist, or if the string cannot form aNested Palindrome, output-1. Output no spaces, and do not separate answers with blank lines.ExampleInput:11?11?3?1?1?55???551?130?00Output:101131212707-1-1",
  "sample_input": "Input:11?11?3?1?1?55???551?130?00Output:101131212707-1-1",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/NESPALIN",
  "scraped_at": "2025-08-17 00:34:24",
  "test_cases": [
    {
      "input": "11?11?3?1?1?55???551?130?00",
      "expected_output": "101131212707-1-1",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3 5 1 3 3 2 4 9 8\nwfsannio",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "6 7 10 10 5 4 5 3 3\nqwatnig",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "5 2 10 3 5 1 7 6 3\nmszpsxxcdjglpwviybjm",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "62 45 8 89 55 95 12 28 63\nouwsry",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "56 33 1 16 6 31 28 7 52\nfcrqelgxiguvsebh",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "39 49 13 70 84 82 23 1 89\nvbabbeqp",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "98 53 17 43 24 53 56 39 88\ntwispdenofsqso",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "76 85 14 96 42 70 7 94 1\nbuonryrwdbjdxem",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "347 406 243 319 273 345 415 140 136\niqs",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "50 430 364 465 102 91 314 238 218\nytwowk",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "139 183 233 453 441 394 78 267 311\nipfildoljeul",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "427 94 256 112 380 344 230 336 344\nlwnkrbfltdccmxzlfd",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "104 278 410 65 259 299 214 499 219\nkmfxwfjqmjzmjcqmf",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "244 218 235 463 232 417 396 69 424\nmodbixhgwymuzidjpzy",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "121 484 261 89 246 113 232 196 443\nyzgpeuwalrnirehvnubt",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000\ngriuwlnu",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000\nrwzmca",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 2 1000 1 1 2 1000 1 999\nxvopugintoz",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "999 2 1 999 1000 1 1 1 1000\nqwmmnrfbumvqdeafuyb",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:25",
  "total_test_cases": 20
}