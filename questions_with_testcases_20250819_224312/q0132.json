{
  "problem_code": "problems",
  "title": "Permutation Game",
  "tags": [],
  "text": "Harsha is given 9 integers a1, a2, a3... a9. This denotes that he is given a11's, a22's ... a99's. Let 'x' = (a1+ a2+ ... a9). Now, Harsha makes all possible 'x' digit numbers by using these given digits. Let S be the set of all such numbers which he makes. Now he constructs a directed graph containing |S| nodes, in which each node denotes a unique number from the set. For all numbers u, v belonging to S, there is a directed edge from node 'u' to node 'v in the graph iff u > v. It is easy to note that we obtain a directed acyclic graph. What's more, the edges of the graph are weighted. The weight of an edge joining node 'u' and node 'v' is equal to u + v. Now, Deepak decides to test Harsha's memory and gives him 'Q' queries. Each query consists of two numbers 'u', 'v' (u > v, both belonging to the set S). For each query Harsha must provide the following answers:How many distinct paths are there from node 'u' to node 'v' in the graph.For each distinct path 'i' from node 'u' to node 'v', let Sidenote the sum of weights of all edges on this path. Calculate the value of sum(Si), for every distinct path 'i' from node 'u' to node 'v'.InputThe first line of input contains 9 integers a1, a2... a9. The second line contains a single integer 'Q', denoting the number of queries. Each of the next 'Q' lines contain 2 numbers 'u' and 'v'.OutputFor each query, output two space separated integers denoting the number of distinct paths and sum of weights of all paths respectively. Since the output can be large, output these quantities modulo 1000000007.Two paths (v1, v2... vm) and (u1, u2... un) are distinct if:m ≠ nm = n, there exists some index 'k' (1 ≤ k ≤ m) such that vk≠ ukConstraints1 ≤ (a1+ a2+ ... a9) ≤ 5001 ≤ Q ≤ 20ai≥ 0ExampleInput:2 0 1 0 0 0 0 0 0\r\n1\r\n311 113Output:2 1110ExplanationTest case 1: The set S for the above problem is {311, 113, 131}. The edges of the graph are 311→131, 311→113, 131→113. There are two distinct paths from 311 to 113, namely (311→131→113) and (311→113). The sum of weights of edges on path-1 = (311 + 131) + (131 + 113) = 686. For path-2, the sum of weights of edges = (311 + 113) = 424. Therefore, answer = 686 + 424 = 1110.",
  "sample_input": "Input:2 0 1 0 0 0 0 0 0\r\n1\r\n311 113Output:2 1110",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/BTCODE_I",
  "scraped_at": "2025-08-17 00:33:05",
  "test_cases": [
    {
      "input": "2 0 1 0 0 0 0 0 0\r\n1\r\n311 113",
      "expected_output": "2 1110",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "8 6 4 8 1 6 10 7 4\n3\n4 4",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "8 5 9 10 1 6 3 2 3\n8\n7 7",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "6 8 8 6 4 5 8 3 4\n2\n6 8",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "71 66 44 26 20 27 75 7 89\n72\n92 91",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "57 74 57 15 45 58 87 51 81\n35\n67 36",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "22 28 100 32 59 3 31 37 20\n67\n9 27",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "71 61 30 2 13 37 15 45 89\n26\n83 19",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "27 38 61 14 12 12 16 20 71\n71\n84 92",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "200 253 130 189 340 121 171 263 194\n348\n162 470",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "256 216 192 206 240 438 442 76 80\n370\n410 414",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "145 239 262 149 428 476 378 121 492\n390\n485 389",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "324 346 448 312 351 491 351 100 495\n429\n282 350",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "273 342 309 114 166 136 144 61 476\n461\n385 227",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "198 92 114 395 220 63 430 214 406\n384\n105 300",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "368 496 139 251 403 449 223 73 456\n372\n63 370",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000\n1000 1000",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 999 2 2 1000 2 2 1000\n1\n1 1",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "2 1000 1 1000 999 1 1000 2 1000\n1\n1000 2",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:12",
  "total_test_cases": 20
}