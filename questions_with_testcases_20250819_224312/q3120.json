{
  "problem_code": "problems",
  "title": "Travelling tours",
  "tags": [],
  "text": "In Hanoi, there are N beauty-spots (2 ≤ N ≤ 200), connected by M one-way streets. The length of each street does not exceed 10000. You are the director of a travel agency, and you want to create some tours around the city which satisfy the following conditions:Each of the N beauty-spots belongs to exactly one tour.Each tour is a cycle which consists of at least 2 places and visits each place once (except for the place we start from which is visited twice).The total length of all the streets we use is minimal.InputThe first line of input contains the number of test cases t (t ≤ 15). The first line of each testcase contains the numbers N, M. The next M lines contain three integers U V W which mean that there is one street from U to V of length W.OutputFor each test case you should output the minimal total length of all tours.ExampleInput:2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3Output:42\r\n40ExplanationTest 1:Tour #1: 1 → 2 → 3 → 1 ⇒ Length = 20Tour #2: 6 → 5 → 4 → 6 ⇒ Length = 22Test 2:Tour #1: 1 → 3 → 2 → 1 ⇒ Length = 27Tour #2: 5 → 4 → 5 ⇒ Length = 13",
  "sample_input": "Input:2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3Output:42\r\n40",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/TOURS",
  "scraped_at": "2025-08-17 00:34:24",
  "test_cases": [
    {
      "input": "2\r\n6 9\r\n1 2 5\r\n2 3 5\r\n3 1 10\r\n3 4 12\r\n4 1 8\r\n4 6 11\r\n5 4 7\r\n5 6 9\r\n6 5 4\r\n5 8\r\n1 2 4\r\n2 1 7\r\n1 3 10\r\n3 2 10\r\n3 4 10\r\n4 5 10\r\n5 3 10\r\n5 4 3",
      "expected_output": "42\r\n40",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "2\n2\n6",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "2\n2\n2",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n4\n1\n8\n8\n10",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "19\n47086619\n30478209\n32680748\n17674752\n48084691\n40284689\n75550758\n98520565\n60779246\n37300935\n68979497\n13745112\n11064765\n49942270\n69686921\n16505632\n48540859\n68206686\n61794560",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "11\n81092626\n19078808\n32142393\n28942129\n75986039\n6927416\n28590791\n99195047\n69052014\n601844\n90784134",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n60338462\n30971787\n60037369\n85466804\n26044820\n59294766\n32361315\n39672818",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n80646058\n10744933\n88261095\n7196967\n7030786\n95580258\n84697099\n26699040",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "8\n57537383\n1231237\n19715410\n95411639\n7344082\n43446805\n59966749\n22798892",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "164\n99326\n35361\n87281\n90540\n7233\n71813\n18324\n38057\n71595\n47711\n33788\n2780\n92948\n71684\n18025\n40229\n16332\n82815\n87696\n48839\n35681\n42531\n80716\n51859\n45253\n47784\n1136\n31486\n39652\n69460\n61622\n93352\n4664\n55664\n40679\n61411\n51668\n59487\n11745\n41372\n61141\n66422\n55934\n52128\n81073\n64610\n18256\n45002\n61007\n20219\n19215\n61181\n81376\n24974\n12820\n15237\n56413\n11261\n76369\n17107\n39128\n56128\n10979\n31078\n46105\n19427\n70774\n87064\n4705\n73994\n56180\n51764\n45204\n86959\n8970\n61979\n98273\n57974\n36992\n55315\n15360\n82013\n82689\n63003\n96932\n70209\n43812\n88527\n45096\n40219\n16643\n79461\n65215\n34070\n68323\n97659\n3312\n89883\n4663\n65905\n18723\n76684\n70404\n307\n16492\n41952\n92243\n98228\n50244\n90640\n22566\n27863\n39396\n64437\n71108\n29549\n23281\n5188\n92709\n28793\n76557\n46864\n82843\n16633\n2296\n46592\n33965\n46794\n18137\n78309\n12892\n46468\n71498\n12723\n27430\n89350\n36306\n76576\n53284\n4150\n14366\n99664\n71731\n69698\n67246\n91591\n60816\n25418\n294\n76109\n73109\n69573\n91798\n89488\n51117\n86470\n10996\n57247\n62996\n27498\n72416\n43839\n76783\n81000",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "199\n5107\n72694\n24895\n6497\n46029\n6996\n57044\n19592\n75195\n18897\n93483\n27780\n87090\n19216\n36595\n27449\n88442\n72101\n8865\n36600\n42044\n94672\n94478\n17262\n12441\n35012\n12539\n44180\n84431\n53544\n4662\n55234\n77660\n65725\n88066\n46851\n41418\n94268\n12717\n51260\n81984\n67643\n49384\n89952\n55051\n43075\n59273\n98172\n40832\n67251\n3332\n2368\n74542\n10568\n45400\n29919\n85307\n7822\n54868\n18904\n68508\n8686\n85656\n74230\n27698\n2720\n34045\n11687\n9536\n63467\n96015\n13499\n9306\n35960\n86214\n10863\n56735\n87524\n4302\n83984\n78241\n85608\n28984\n33141\n60469\n5342\n22477\n57091\n92553\n73838\n94291\n67249\n26033\n47186\n12054\n70319\n6291\n52862\n73292\n21103\n95608\n74885\n20936\n77279\n87465\n75480\n34697\n60956\n32630\n20296\n22103\n48989\n66463\n3708\n30320\n99870\n62920\n22876\n8485\n35802\n87987\n78854\n74902\n81566\n22293\n14646\n49714\n66549\n58728\n94562\n34050\n8425\n67793\n59605\n24600\n77208\n35516\n53866\n15716\n63838\n51003\n48014\n65077\n35577\n43701\n80461\n87640\n80632\n29971\n56423\n59199\n2262\n51719\n29553\n81144\n40705\n43909\n53047\n15597\n16370\n91335\n70305\n35840\n90898\n8777\n93694\n54167\n48641\n85540\n52502\n22179\n56363\n66026\n19166\n43331\n28736\n22442\n49400\n9351\n55935\n44529\n55696\n87963\n10855\n3654\n73409\n13537\n2508\n33487\n7048\n71037\n10134\n67564\n29164\n51521\n92508\n31704\n95836\n38582",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "71\n77952\n87432\n99811\n63278\n67803\n40235\n85361\n43423\n10350\n79209\n9630\n58749\n47297\n12120\n61007\n23452\n92468\n33207\n55305\n40941\n19276\n98\n46789\n80190\n97443\n29004\n5468\n29188\n51577\n57808\n68053\n21399\n64182\n66595\n29244\n5927\n53505\n87696\n59833\n53866\n28871\n33179\n71012\n45141\n41208\n42103\n58542\n31649\n83800\n94313\n2692\n62425\n22083\n73169\n86200\n48314\n70495\n23132\n4451\n79359\n97047\n26538\n6042\n68407\n10981\n46202\n8994\n86502\n21806\n69910\n83762",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "64\n11704\n95664\n30650\n30102\n89815\n39748\n72204\n84440\n24205\n28513\n58271\n17745\n24767\n2220\n21346\n14137\n45850\n15846\n95917\n52172\n46025\n21042\n28848\n13169\n75856\n98158\n87177\n62993\n47952\n19045\n60844\n35512\n38296\n43881\n39531\n68246\n55666\n20669\n80262\n5956\n43920\n54311\n98067\n97183\n20012\n22455\n80818\n98775\n73619\n57247\n32309\n34887\n46853\n13687\n72525\n96853\n87130\n52930\n86423\n12283\n81745\n97266\n75024\n23805",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "165\n55617\n58224\n84053\n77695\n93952\n74152\n99804\n35959\n88145\n90767\n88958\n81775\n13603\n57633\n77886\n13685\n89260\n790\n93493\n52659\n91802\n68344\n61938\n90962\n63398\n33826\n7560\n43071\n26144\n8041\n71425\n96206\n20213\n5318\n84879\n64121\n3766\n50119\n15242\n25379\n28716\n56628\n11749\n2419\n75397\n58279\n83775\n82119\n56477\n53560\n37951\n30188\n34436\n40379\n23629\n63122\n2181\n10790\n42337\n36870\n69190\n35593\n52784\n37975\n53099\n41311\n96336\n42663\n8396\n61400\n56622\n98979\n71275\n2232\n41954\n23310\n95088\n41106\n88291\n4290\n25686\n52269\n28225\n23851\n41821\n30245\n42067\n8091\n65532\n29536\n88906\n77853\n40143\n19526\n40618\n42168\n82403\n17030\n77547\n26379\n2980\n5512\n32956\n31415\n66796\n5482\n88601\n99462\n59618\n12071\n64783\n4510\n31146\n17031\n7457\n78355\n21127\n80440\n33299\n68184\n47302\n33475\n3957\n80257\n58824\n20827\n10979\n72802\n56005\n59093\n55107\n66727\n46104\n91630\n58285\n65119\n53655\n12356\n11230\n68729\n99520\n95763\n35820\n80149\n950\n8789\n45540\n49972\n90766\n24113\n29908\n5599\n58923\n40351\n32588\n99948\n26648\n98717\n37075\n75057\n68882\n38205\n34006\n65575\n83807",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "152\n14940\n12966\n25497\n30187\n4801\n15909\n3027\n79401\n18581\n81107\n65310\n53957\n55144\n99506\n37495\n33033\n23362\n26293\n60608\n27396\n35463\n55249\n47985\n47175\n23314\n13450\n34381\n29424\n29537\n83605\n62742\n67266\n81563\n60906\n45988\n83177\n54554\n60944\n50763\n39616\n21277\n54635\n85725\n36062\n29552\n44945\n54278\n72391\n88901\n7375\n79321\n10884\n49574\n40917\n60292\n76023\n36249\n32084\n96161\n18965\n58467\n55187\n98345\n74117\n36470\n79700\n1324\n63584\n67313\n30892\n87070\n12936\n50036\n31362\n88479\n48788\n91335\n50509\n44654\n25283\n20062\n77878\n79440\n2287\n89617\n62979\n75770\n81599\n81258\n90971\n79643\n96511\n3273\n27108\n20186\n44714\n44135\n94605\n11121\n86699\n47895\n91069\n85127\n40012\n60190\n79190\n45302\n58758\n2094\n18284\n46658\n19586\n21167\n44380\n93735\n79918\n90008\n6131\n6603\n34402\n53653\n58793\n13870\n73936\n6499\n58937\n29898\n97113\n4313\n4405\n3873\n93626\n33264\n47405\n58980\n77913\n20140\n25988\n60210\n653\n18916\n69934\n11559\n82890\n39354\n7526\n4704\n47932\n21898\n75613\n82859\n19321",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "157\n50749\n21239\n26166\n24563\n67542\n37753\n14072\n6448\n87947\n1332\n77601\n2839\n4211\n4144\n63043\n40820\n81458\n50848\n41246\n4559\n47511\n85734\n39232\n46259\n52523\n93960\n87887\n10106\n26646\n13904\n71200\n52512\n39839\n83226\n80790\n55556\n4443\n51532\n82549\n73699\n7404\n98662\n20886\n83419\n39386\n31409\n97791\n71518\n20058\n81187\n29640\n5486\n54151\n4983\n73210\n42731\n77660\n25918\n40085\n52693\n71041\n77105\n3496\n57903\n44779\n62070\n14661\n50313\n76753\n43462\n32796\n69026\n37309\n52803\n61179\n61898\n95914\n20542\n22676\n13770\n7778\n32586\n88979\n48616\n26017\n8980\n93150\n54638\n47885\n98118\n47306\n40101\n34454\n17061\n95018\n54551\n39794\n42174\n83329\n17642\n40018\n454\n44040\n95506\n75039\n2740\n71863\n42469\n18956\n61315\n40818\n32551\n6836\n77236\n49848\n96835\n50129\n97649\n64547\n68580\n2441\n57983\n13030\n17797\n70458\n27665\n90831\n23520\n8438\n50108\n48561\n22329\n26431\n5572\n21576\n71864\n6387\n43179\n71093\n48815\n52416\n15731\n30080\n49432\n6135\n32569\n50662\n64251\n93449\n73440\n76323\n40887\n2776\n94697\n72186\n11545\n93831",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n48171913\n1664257\n38139917\n34566271\n42688365\n39930778\n14248503\n11182281\n94531582\n5649778\n37283324\n33991618\n44285763\n76623130\n67971493\n49059756\n23527708\n96124774\n35508065\n2664108\n9035008\n81177102\n87488485\n48987915\n56083493\n58205822\n64442329\n25652069\n1757330\n27633401\n40950090\n98115817\n8049709\n8301511\n58838983\n68263764\n78456658\n15741214\n74811852\n99429817\n95805760\n53119116\n15391335\n54537372\n41370579\n63877240\n70865443\n25993187\n71398043\n40305620\n45712052\n21073883\n62095436\n82097638\n42794096\n27825358\n72167731\n39816552\n63396135\n53656636\n91651766\n93884893\n12016481\n23825247\n46771130\n40857067\n34753935\n52929470\n98290700\n48925525\n73593688\n42014864\n50901300\n83517866\n69064280\n15900815\n57890224\n42226120\n48700995\n97130791\n19699426\n49140397\n74016940\n79352459\n3486171\n53896200\n6193492\n76706148\n8427879\n89067079\n67396072\n10311331\n5601618\n96159560\n60214092\n85439255\n26914010\n85765070\n11122881\n30858040\n88694796\n59734510\n78937990\n85909859\n46229002\n24979085\n71503285\n65970826\n76827474\n62366831\n98341069\n95989244\n6959186\n29585089\n38021458\n346952\n50575296\n15324049\n16775907\n63175871\n91811941\n35858495\n48361068\n84755364\n55284529\n76570760\n24588272\n20806137\n7832138\n17883860\n34016944\n32270411\n76065920\n49921755\n99696040\n25169788\n70118216\n65712428\n6549054\n63822188\n46507308\n86688967\n40536443\n16623400\n45467876\n74110643\n36824014\n39950820\n90729145\n18106167\n41024775\n71050066\n55245840\n72566056\n46799351\n11136059\n791241\n82629946\n44261298\n39135525\n68236523\n49906605\n24175251\n84829883\n76538163\n51215230\n4771758\n29606290\n24685788\n26958720\n46046661\n87072656\n82248464\n94245375\n12508311\n98775881\n59400674\n98467711\n65028037\n68237928\n90814476\n14117506\n92960527\n71776746\n3799847\n10601774\n95568813\n16370493\n20332571\n75172441\n57579470\n7575460\n39667863\n77786989\n85589007\n96787567\n81323710\n111745\n12369554\n57763243",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n85654743\n90709578\n86250902\n48217635\n34350895\n23241084\n55568657\n48996863\n56985001\n10792582\n77587009\n49760990\n90757526\n87113424\n8362247\n42385197\n10550474\n71954912\n58283852\n36114390\n74506242\n55559820\n36005070\n68080709\n33857648\n57897268\n37324387\n89163320\n85765801\n63291527\n47119152\n43840220\n96999604\n95222677\n40305746\n47632898\n67692926\n2849328\n96739595\n42977017\n54503220\n50387701\n41539772\n93040165\n58596914\n94877186\n26394672\n98857352\n8052892\n577465\n60025183\n21691128\n13485549\n16186174\n62728497\n66690605\n95237832\n48841679\n96358746\n99673042\n74712781\n13707264\n84248939\n24512431\n83799856\n53582578\n66844147\n1993106\n37985\n11896086\n40255913\n64675658\n82956380\n15926861\n98762984\n45798694\n26878103\n39900932\n11782976\n85605967\n24232986\n35111239\n27876950\n91939137\n22554959\n90226590\n84756175\n26906198\n60737270\n7574604\n83450166\n84213692\n76236061\n86617729\n35928174\n14637584\n10375714\n71307560\n16205221\n67683659\n44574591\n25494160\n10607320\n22582656\n45994621\n61721814\n12522915\n46824069\n27646807\n69225233\n53066435\n16185880\n38557002\n16545572\n56353777\n70068448\n36630897\n86956286\n31818236\n31252876\n67827192\n51805570\n2926071\n35350741\n2561532\n52671539\n56540862\n82979491\n77663364\n41057081\n10749479\n47285121\n83745249\n6949367\n29065760\n48892348\n35473908\n31705648\n15253257\n38128282\n67192362\n65906593\n97743530\n60190573\n88372450\n39473781\n22906716\n29179258\n39881774\n6692546\n53486590\n90000290\n48545476\n54372775\n52931705\n27230622\n29848397\n87984070\n57594559\n60834121\n27313249\n39610229\n12729698\n59206347\n61473756\n46744731\n38693353\n32864540\n41255491\n98775331\n79104492\n62568181\n90789968\n62565464\n37977931\n99368203\n84032752\n69036559\n38152210\n20656758\n98463583\n11678679\n94703832\n18585625\n37602715\n46696932\n12887029\n44473949\n40588519\n80585995\n30070226\n33404325\n85667493\n6825784\n25956430\n8615360\n44430942\n50552972\n40669808\n39713521",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "2\n88517987\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 2)"
    },
    {
      "input": "200\n1\n73918481\n84541866\n27686526\n1\n93487399\n1\n100000000\n1\n1\n1\n100000000\n1\n1\n100000000\n47938152\n1\n100000000\n1\n1\n86431207\n100000000\n1\n1\n65717078\n27902923\n1\n1\n1\n100000000\n1\n100000000\n27941881\n100000000\n1\n3317178\n12691040\n1\n1\n1098905\n1\n1\n19547544\n27566221\n100000000\n100000000\n100000000\n100000000\n55569725\n1\n1\n1\n98530933\n100000000\n55954608\n1\n1\n100000000\n1\n100000000\n100000000\n1\n100000000\n27877737\n100000000\n1\n1\n1\n1\n1\n36419463\n100000000\n71455678\n100000000\n100000000\n1\n1\n100000000\n100000000\n33302102\n100000000\n100000000\n1\n1\n100000000\n1\n100000000\n59889413\n100000000\n12387905\n100000000\n84495656\n100000000\n1\n100000000\n100000000\n41436641\n100000000\n100000000\n66036724\n46189145\n100000000\n80557635\n29173123\n1\n88028147\n93505829\n19959133\n1\n1\n1\n100000000\n1\n45587441\n1\n61798151\n1\n583663\n1\n100000000\n1\n100000000\n100000000\n100000000\n100000000\n50973220\n38722483\n7407713\n100000000\n1\n53401440\n86926069\n100000000\n100000000\n100000000\n100000000\n1\n1\n1\n22860410\n24212888\n100000000\n87700157\n74003594\n100000000\n100000000\n1\n4259097\n1\n35547708\n1\n100000000\n31628403\n1\n45404648\n100000000\n57578997\n100000000\n1\n1\n1\n79160358\n1\n100000000\n1\n15304320\n89693681\n1\n99287898\n74275927\n1\n100000000\n100000000\n100000000\n1\n1\n45091999\n100000000\n1\n100000000\n1\n100000000\n71743661\n100000000\n1\n57823046\n100000000\n100000000\n1\n60191808\n1\n100000000\n1\n1\n94549869\n90322776\n100000000\n1\n36222492\n1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 200)"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:22",
  "total_test_cases": 20
}