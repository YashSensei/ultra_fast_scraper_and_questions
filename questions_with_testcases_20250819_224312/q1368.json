{
  "problem_code": "problems",
  "title": "Military patrol",
  "tags": [],
  "text": "Dystopia consists of N cities. There are one-way roads connecting some pairs of cities. The dysfunctional state has recently seen a lot of protests to overthrow the tyrannical ruler and the government plans to use military patrol vehicles to make sure that the protests are suppressed. Every patrol vehicle is assigned a sequence of cities. If a patrol vehicle is assigned the cities c1, c2... ckthen it starts from the city c1and takes the direct one-way road to c2, from there it takes the one-way road to c3and so on. Finally the vehicle takes the one way road from ckto c1. This routine is repeated everyday to keep the protestors perpetually under fear.Now note that:Every city has to appear in exactly one vehicle's patrol sequence exactly onceEvery patrol vehicle has to move - so it has to be assigned more than one cityThe government does not have any limit on the number of patrol vehicles it can use. However, they want to make sure that the least possible amount of money is spent on the patrol mission and hence they want to minimise the total distance travelled by the patrol vehicles.Given the road network of Dystopia, find the minimum total distance the patrol vehicles need to move so that all the cities can be patrolled. If it is impossible to organise a nationwide patrol with the given constraints, report the same.InputFirst line of the contains T, the number of test cases (T ≤ 10)This is followed by the descriptions of the T test cases. The first line of the description contains two integers N and R, the number of cities and one way roads respectively (N ≤ 200, R ≤ 10000). The cities are numbered 1, 2, 3 ... N This is followed by R lines, each representing a one way road by 3 integers N1, N2and D : the start city, the end city and the length of the road respectively (N1≠ N2, 1 ≤ D ≤ 1000000). You are assured that there is no more than one one way road from any N1to N2OutputFor each test case output one line. If the patrol can be done, output the minimum total distance that the patrol vehicles have to travel. Otherwise output ImpossibleExampleInput:2\r\n3 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n4 6\r\n1 2 2\r\n2 3 2\r\n3 4 2\r\n4 1 2\r\n1 4 1\r\n3 2 1Output:Impossible\r\n6",
  "sample_input": "Input:2\r\n3 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n4 6\r\n1 2 2\r\n2 3 2\r\n3 4 2\r\n4 1 2\r\n1 4 1\r\n3 2 1Output:Impossible\r\n6",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/MILPATR",
  "scraped_at": "2025-08-17 00:33:42",
  "test_cases": [
    {
      "input": "2\r\n3 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n4 6\r\n1 2 2\r\n2 3 2\r\n3 4 2\r\n4 1 2\r\n1 4 1\r\n3 2 1",
      "expected_output": "Impossible\r\n6",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5\n3\n6\n7\n3\n8",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "1\n8",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "5\n5\n7\n9\n5\n9",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "7\n23035472\n4934476\n30560063\n37443044\n42051090\n68687152\n82338623",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "18\n70007290\n10558818\n29843732\n36996804\n13984114\n4749633\n87621650\n37792460\n12267234\n4035738\n77991074\n78529434\n47840645\n38097523\n80448320\n91887973\n9562073\n90928950",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "10\n70730624\n6011342\n62955714\n87634189\n98449666\n77812003\n99399561\n94721012\n81295559\n33918789",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "15\n19365469\n3962859\n340453\n60289673\n32793333\n15809238\n53824603\n14547609\n50794726\n73780381\n8884094\n92249428\n92629775\n10412923\n5149841",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "6\n82382008\n52879560\n99733622\n93684054\n38971216\n26697836",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "180\n20191\n79816\n99400\n92946\n5862\n7682\n8598\n51431\n12396\n22136\n82133\n57023\n16851\n73668\n83870\n21336\n4151\n90896\n82066\n70726\n43845\n90047\n57317\n81928\n60616\n13978\n45753\n33577\n34808\n74528\n3884\n11910\n46653\n80552\n27389\n46136\n82381\n96887\n51401\n65920\n38061\n92805\n48087\n10273\n4107\n78132\n8640\n19978\n1224\n37840\n39619\n44466\n31671\n98832\n62146\n61657\n62318\n70838\n3887\n69355\n21594\n40004\n70144\n10451\n70533\n49425\n86504\n99063\n32439\n16102\n7020\n15320\n42787\n58747\n77709\n89900\n61969\n55068\n18539\n93037\n70631\n7955\n29465\n46303\n31756\n94477\n79002\n97300\n91995\n61961\n99261\n47541\n73457\n55080\n2375\n55200\n84644\n2138\n79938\n47591\n94559\n53977\n41539\n30588\n3999\n3765\n15391\n34391\n65892\n45516\n93984\n87222\n51422\n91157\n60581\n68898\n82870\n32315\n71341\n72717\n51523\n22546\n89852\n93060\n88484\n85860\n7828\n80166\n87188\n45253\n98902\n89849\n80900\n27571\n13688\n99538\n41644\n99135\n46854\n76547\n70578\n5962\n81925\n61805\n89672\n51468\n77776\n21755\n71556\n27904\n60629\n32617\n78478\n47426\n12493\n35177\n41839\n49203\n2876\n3316\n54673\n43686\n99085\n46252\n87118\n8432\n26188\n26022\n55660\n29853\n6413\n30920\n45161\n99044\n61988\n47749\n59963\n3575\n22892\n71711",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "20\n72670\n83637\n92594\n38454\n40599\n8017\n25445\n44007\n25952\n35609\n53346\n91507\n86841\n14095\n2132\n9708\n93501\n27658\n91626\n39468",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "97\n36596\n40737\n32247\n25066\n16155\n12018\n16271\n9985\n53963\n99453\n93552\n89303\n73980\n92144\n62807\n97558\n96208\n28738\n62684\n42675\n87442\n55819\n57602\n63134\n42765\n77\n2247\n98318\n66181\n67249\n42086\n14128\n56129\n89982\n7847\n40630\n5923\n17625\n26799\n16552\n72145\n92488\n86103\n13103\n57577\n57575\n77809\n84245\n62500\n82853\n15040\n64104\n25215\n8816\n68138\n80376\n44296\n99785\n98137\n19500\n6344\n77029\n63394\n13527\n89824\n87474\n93433\n2841\n59532\n54084\n82967\n38717\n59933\n37936\n23120\n54149\n15918\n27802\n85468\n18002\n20951\n59564\n2089\n13307\n13921\n86911\n48109\n15020\n42017\n8568\n60360\n46258\n42292\n85201\n13162\n98729\n27425",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "146\n82175\n91310\n13374\n92922\n54723\n92317\n3485\n96400\n24336\n94055\n72173\n63269\n11159\n34615\n82307\n14435\n75370\n10698\n63495\n63958\n4414\n43985\n75154\n62658\n7047\n74242\n57713\n94687\n86984\n83148\n35891\n29732\n92673\n16664\n12361\n49782\n62286\n57174\n44432\n90134\n45013\n20169\n78728\n15975\n50486\n32251\n45719\n89552\n29271\n30144\n75210\n49293\n14819\n25659\n45512\n47595\n22671\n62033\n8902\n8033\n29990\n81373\n87410\n99239\n60521\n25751\n82746\n22226\n85333\n77308\n61728\n9165\n81050\n32662\n55645\n85528\n66721\n12546\n85516\n39354\n42000\n50037\n1237\n54875\n85119\n12685\n58618\n95348\n34591\n18499\n47956\n82492\n69764\n910\n33118\n97617\n10723\n52652\n31349\n2295\n38950\n58904\n49923\n80944\n73764\n31666\n2815\n24440\n65124\n64432\n70185\n74931\n82719\n76168\n70635\n94213\n75670\n97908\n99140\n18830\n57226\n56906\n22470\n5023\n17898\n36704\n58913\n93181\n37293\n82571\n59635\n86188\n89413\n96184\n1217\n94047\n81415\n96590\n66350\n45687\n60077\n23805\n32061\n25458\n24788\n9908",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n51\n86660\n31396\n39245\n6053\n60008\n27877\n22278\n75441\n76251\n50273\n73202\n8886\n65321\n5845\n64529\n56529\n43918\n88072\n44842\n90731\n71292\n54329\n27069\n70958",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "48\n62569\n29025\n18375\n11312\n63298\n53370\n79315\n87250\n64400\n35112\n78651\n85307\n31564\n34956\n83590\n39739\n61117\n50578\n3911\n85395\n45668\n87035\n34667\n35501\n6674\n46652\n14138\n95219\n7836\n29608\n59760\n8987\n43170\n48629\n46187\n4678\n34394\n6023\n10159\n1715\n35786\n98531\n4\n41019\n53083\n59499\n36448\n33410",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "151\n98758\n62161\n77230\n99235\n72608\n28561\n43639\n70652\n29410\n86216\n57307\n91138\n63976\n42371\n44191\n5241\n97205\n18655\n78094\n68122\n92857\n43303\n13614\n8917\n24147\n99145\n56029\n36316\n88682\n10748\n37766\n20314\n53876\n69487\n97732\n30497\n95918\n28462\n45692\n53723\n76268\n63027\n22838\n70454\n59072\n39362\n53754\n87934\n38786\n2270\n83288\n93618\n82360\n41847\n31381\n178\n85997\n16429\n24669\n97337\n14630\n85943\n99909\n50168\n69551\n75423\n11732\n1845\n30436\n4024\n43745\n86715\n91041\n59299\n96665\n36727\n40377\n22228\n96121\n63229\n98507\n9221\n11628\n20871\n92837\n90405\n3254\n65306\n38396\n19383\n33224\n44940\n12383\n65632\n27830\n16279\n218\n82508\n88063\n55558\n6629\n61085\n58354\n58089\n4850\n61614\n91281\n63722\n92395\n85116\n57838\n49203\n75033\n7159\n24394\n31899\n6073\n99052\n73065\n36504\n69138\n45700\n97723\n54324\n85036\n40618\n90142\n47326\n4279\n50757\n89971\n22281\n85030\n45030\n65132\n2563\n49316\n28353\n54097\n41520\n71380\n77722\n85611\n58028\n13151\n14964\n39438\n54375\n43371\n68104\n43972",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "200\n87255277\n55497342\n61905212\n39951731\n48508421\n58666402\n43409726\n85138681\n52917590\n81523287\n54649024\n95312085\n10631776\n77183302\n11518143\n54731915\n93165072\n27950094\n49433747\n67488723\n41723530\n9666209\n25128454\n21219250\n99527986\n18159425\n84807130\n7480423\n78959165\n70769599\n62280045\n64797281\n3559587\n75239096\n50109538\n86003405\n85471081\n66383388\n58779235\n2290962\n96011368\n34161864\n7255634\n66275055\n72763559\n5270397\n63905477\n33518825\n65973741\n71365339\n63537768\n5361922\n52604974\n93033599\n20197395\n17043651\n55807658\n38325\n44382554\n90181680\n66091936\n75536421\n86246840\n96307273\n81814161\n47625938\n60326971\n51048908\n45284526\n1925934\n30820143\n31112478\n48790862\n90324326\n53734192\n45987048\n27979914\n47673772\n62205051\n37746787\n93661010\n9137934\n28189331\n44758788\n85161988\n24522633\n8038949\n99685576\n21567321\n77720349\n20366604\n82374591\n11546392\n43126307\n2367550\n25315226\n57927157\n54056570\n85581736\n62098370\n35859506\n6473828\n94887181\n90263140\n78812283\n42577440\n67694812\n90116733\n52577656\n30273842\n46516471\n19477330\n37169893\n63440470\n69661136\n83290899\n15813242\n3099228\n53894308\n49501930\n35628991\n31955216\n24035787\n80154966\n44296625\n74564003\n87939006\n54788876\n98014494\n78099527\n53091021\n34552594\n91499579\n79980211\n36697792\n11639865\n27262819\n15157418\n46224302\n77341602\n99081793\n91967965\n85892276\n40074014\n3303849\n13720532\n17042248\n25902669\n20443441\n93798451\n42281431\n87719229\n75927085\n32442722\n6436150\n25156379\n89860769\n27091800\n68309588\n51149620\n75142144\n26453548\n90592587\n24453088\n96573074\n53259722\n1180230\n7182455\n41664652\n74237002\n93133870\n44443021\n87276249\n24428052\n57857331\n49037110\n86468702\n60574467\n45247379\n8431071\n96833490\n91401795\n47821426\n43208136\n33048501\n56738033\n663003\n20974096\n39242691\n34189500\n3023732\n72121796\n69008016\n86156624\n77897892\n64766362\n11809187\n78788756\n13312317\n55862787",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "200\n11511674\n36233671\n79153386\n34281764\n57737693\n97216491\n50759192\n915087\n80143135\n65294241\n95074935\n91932290\n79689251\n83185760\n70169014\n58899814\n44589561\n56000043\n14332716\n86032496\n32754166\n11210501\n16422275\n97857715\n26524993\n6691756\n62794982\n67251687\n8279606\n32334823\n21425389\n26724325\n10380467\n91867313\n22128571\n15728148\n45694943\n72175505\n85610801\n5683799\n42047676\n63635211\n8003694\n51926994\n98043158\n26448556\n19969805\n70626185\n31564888\n80534649\n41601512\n19521407\n68175169\n1153650\n68137771\n19350381\n71995326\n8093289\n80301600\n72223554\n65932688\n46482923\n70764000\n72430788\n8687025\n82145474\n94976889\n62779526\n84286237\n65877795\n37178905\n99882825\n35438637\n67623539\n75584699\n91459699\n70407351\n74683966\n58976075\n70549767\n69955529\n5588379\n56341062\n88887188\n21425263\n3872747\n4602839\n45470251\n14321567\n69861121\n64755989\n82391901\n85079741\n64348163\n57049799\n58502799\n82769923\n82601801\n19431359\n9374279\n85261253\n21547580\n19004145\n61782352\n77312604\n46887415\n64363935\n76695913\n17371142\n957743\n6403820\n85877010\n50091395\n41593107\n74817689\n67241411\n95392247\n35505186\n60657738\n48467479\n86893710\n21029801\n63791950\n15567881\n78140000\n43358762\n90921367\n43207640\n38694193\n22236667\n64386790\n36482863\n86513780\n90438363\n8007816\n71640082\n66003045\n70859312\n37408645\n43771348\n25648328\n61006899\n83595729\n36177884\n67966906\n30114682\n22924104\n73191069\n88326958\n31776427\n94976767\n51658128\n80953534\n12804356\n78134414\n85472257\n89261849\n62888731\n73639735\n59016026\n75633859\n63385636\n51182541\n68219331\n81268192\n83748967\n48051938\n38822730\n46970949\n21584312\n84668824\n29804345\n31846990\n94438884\n97597379\n30508099\n17600119\n84066034\n71482237\n29965657\n37368702\n68801824\n92754966\n27926403\n42461061\n74865386\n30969985\n75231928\n5402461\n77577415\n45266485\n7324893\n3819002\n85453764\n56385321\n47405733\n27577010\n74400439\n84223931\n14009294",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 200)"
    },
    {
      "input": "1\n18901362",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 1)"
    },
    {
      "input": "200\n100000000\n1\n91565723\n70028474\n60489645\n100000000\n1\n100000000\n14155827\n1\n100000000\n1\n100000000\n1\n100000000\n40673344\n41848410\n1\n100000000\n100000000\n1\n1\n19582109\n100000000\n1\n1\n76363347\n27407158\n35095666\n96589945\n1\n100000000\n1\n1\n1\n77457421\n52598007\n100000000\n1\n1\n89103254\n1\n100000000\n20573951\n100000000\n1\n81025538\n31023540\n1\n92612247\n100000000\n1\n1\n1\n71535813\n1\n1\n1\n1\n100000000\n100000000\n7037710\n23949027\n1\n79941872\n91669586\n100000000\n100000000\n100000000\n1\n67995896\n1\n1\n1\n1\n76900373\n100000000\n100000000\n1\n77738176\n98009034\n92675829\n18765543\n1\n92217515\n100000000\n25870878\n100000000\n95668708\n100000000\n1\n1\n1\n75470181\n1\n1\n33557791\n1\n39969418\n1\n1\n100000000\n1\n58253877\n100000000\n1\n36820299\n95144525\n1\n1\n56648572\n59923139\n100000000\n100000000\n1\n1\n1\n1\n100000000\n100000000\n100000000\n100000000\n52508359\n71817057\n1\n1\n100000000\n100000000\n1\n91478271\n26797219\n100000000\n100000000\n5631182\n46133068\n100000000\n71571159\n100000000\n40153984\n1\n1\n70305256\n1\n1\n74036187\n100000000\n100000000\n1\n1\n1\n1\n1\n100000000\n100000000\n88489419\n100000000\n1\n1\n1\n1\n1\n1\n100000000\n96958891\n100000000\n18661004\n100000000\n21655953\n1\n1\n1\n23678649\n100000000\n22760443\n1\n1\n1\n88176285\n1\n100000000\n1\n61188144\n99804672\n1\n24226108\n77516757\n100000000\n1\n24182864\n1\n100000000\n57616068\n1\n27843483\n28528686\n1\n100000000\n100000000\n100000000\n1",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 200)"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:17",
  "total_test_cases": 20
}