{
  "problem_code": "problems",
  "title": "Escape from Jail Again",
  "tags": [],
  "text": "A new International Common Prison for Criminals (ICPC) was built, and your old friend Harry was moved there as a prisoner. As before, the new ICPC is one of the most secure prisons in the world. It was designed by and old gamer and as such, the prison is not necessarily closed, but only an incredibly logical and fast mind can get out.The new ICPC can be represented as a grid of square cells. Each cell is empty, or it contains a wall, a door, an opening button or a closing button. Harry was accommodated in an empty cell, and all doors were closed. Nevertheless, Harry told you that he will try to escape. Each time Harry is in a cell, he can move in a single step to an adjacent cell (i.e., a cell that shares a side with his current location). Each time Harry steps on a cell that contains an opening button, all doors open, while each time he steps on a cell that contains a closing button, all doors close. Harry can walk around as he wants within the prison, although he cannot move to a cell that contains a wall, neither to a cell that contains a door if the doors are closed.To escape from the prison, Harry needs to step outside, which means placing himself in one of the cells on the sides and then taking one extra step out in the direction opposite to the prison.You obtained a map of the prison, and Harry deserves your advise. Tell him the minimum number of steps he needs to escape, or warn him that there is no way to get out.InputEach test case is described using several lines. The first line contains two integers N and M indicating respectively the number of rows and columns of the grid that represents the prison (1 ≤ N, M ≤ 100). Line i of the next N lines describes row i of the grid using a string of exactly M characters, where character j represents cell j of that row. This string only contains the following characters with the indicated meanings: “H” is the empty cell where Harry is at the beginning; “.” is an empty cell where Harry is not at the beginning; “W” is a wall; “D” is a door; “O” is an opening button; and “C” is closing button. You may assume that within each test case there is exactly one character “H”. The end of input is indicated with a line containing the number −1 twice.OutputFor each test case, output a single line with a single integer representing the minimum number of steps Harry needs to escape the prison, or the number −1 if it is impossible for him to do so.ExampleInput:5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1Output:21-1811",
  "sample_input": "Input:5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1Output:21-1811",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/ESCJAILA",
  "scraped_at": "2025-08-17 00:33:11",
  "test_cases": [
    {
      "input": "5 8WWWWWWW.WHDC...DW.WW.WCWW.OW..OW.WWWWWWW3 3ODODHDODO3 7WWWWWWWDH..OCDWWWWWWW4 1WHOW1 13HOW.DO.COW.DO-1 -1",
      "expected_output": "21-1811",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "3 2 2 10 1 7 9 4 4 3 5 6\n8 hqmimjmytmrdehegogumazawiuuxmfftxewtrlvxbt rrxmiz nrnrumevfzewo thngdj kjmwekegav c",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Generated small test case"
    },
    {
      "input": "5 9 10 9 2 9 5 3 10 6 10 9\n4 lqasdhg bds bdiqnepocilrhewyrdpa bj jshtaxpqe zyr",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Generated small test case"
    },
    {
      "input": "4 10 1 3 9 1 6 5 4 9 4 1\n5 nztlrrdsmrvkygvastviqaqc lbrgxzlleqa vex jcxjj zbzyrj xu",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Generated small test case"
    },
    {
      "input": "91 68 59 66 58 52 77 7 57 47 65 84\n63 em acvmzikwpr vhuioslsqyjlnjrcbldi rxstrd onfizecnfto f",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Generated medium test case"
    },
    {
      "input": "66 9 17 98 17 10 8 80 36 25 19 27\n58 nluuywnaqnusvrla ceskv rkskrhbrvlguiqubwzdeqgk soi uk hs",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Generated medium test case"
    },
    {
      "input": "48 14 36 19 70 92 47 84 38 10 52 32\n51 sfpqracsdircczsqim iu ohaycbnxfstb bvx ckbueqbmesmjk prlxd",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Generated medium test case"
    },
    {
      "input": "85 38 51 35 46 11 3 67 69 3 75 76\n16 ktahzdcngsaqkthmlnzfv asjncciegz ixh r qk cblpq",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Generated medium test case"
    },
    {
      "input": "39 27 82 72 29 78 14 23 2 92 58 35\n65 iilfru uwgcxsfqgc skntnhnabsdjndtmpsh nhdy drqzcsnupfq larqn",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Generated medium test case"
    },
    {
      "input": "382 469 181 250 226 417 170 379 358 192 137 193\n261 faokawzyignjirndcenyxghhbigjkxoloiavjjr pshxbfz nhzkfupotbmk er uiewwkqon vgn",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Generated large test case"
    },
    {
      "input": "458 474 168 474 251 449 289 282 317 353 128 466\n480 akicvmcipyyqg zyusyzqbrwo xqemzbgewrhfkrjcyq sdz xgkvqlvhggp xha",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Generated large test case"
    },
    {
      "input": "325 436 338 143 393 208 302 161 149 366 60 74\n497 hfsqisqqavcbzdnblgqsrzlo frofkuyeyy qzebivduqvztecctckegxi df wzpqdwpintydyrky bh",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Generated large test case"
    },
    {
      "input": "213 60 415 445 220 483 309 73 448 175 420 276\n356 srqpsdkullufewklinvouojmmal gsjkufe hju sn sfeuerzppocnazd hbfs",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Generated large test case"
    },
    {
      "input": "230 256 417 197 113 193 167 338 288 53 422 83\n319 lslpcwbdrpukiplfwpdnknmameni qavsu jdcayla vktng xvvlqfpwkj loy",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Generated large test case"
    },
    {
      "input": "464 172 464 282 236 413 142 77 123 301 500 416\n126 nnmjgffrzobqefyptifuhqfklfxiibrodnrgz n mcavsisqgwbkvlstqedp wzzw hzmybbayrnhs dj",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Generated large test case"
    },
    {
      "input": "398 421 489 398 394 268 166 243 325 350 261 464\n414 lj zjjyvfhdk vfgoevvdvhgl rdovh gdpnxltuwcahet iva",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Generated large test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000 klsyyfpnsybwho vzs plmucfemczkdixxckdftnj ksqwjv uyx simhx",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Generated max test case"
    },
    {
      "input": "1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000\n1000 xzajnjjuirmivoqwxbzsbdhouyubkoizv tmgnqipurb feaqkbnu wenxqj yywbixneijoipxuta fwu",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Generated max test case"
    },
    {
      "input": "2 999 2 1000 999 1000 2 1 999 1000 999 2\n2 jnewlrbqnwygldhtvmmcdeythvqxembyfga p qqpusd nhi srzxifhvqmufu g",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Generated edge test case"
    },
    {
      "input": "999 2 2 1 1000 1 2 2 1 1 1 2\n1000 cr jh zebsdcsdsdxnckdptsys kf jmgohqfwdcyn o",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Generated edge test case"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:14",
  "total_test_cases": 20
}