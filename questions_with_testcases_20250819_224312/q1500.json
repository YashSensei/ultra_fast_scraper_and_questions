{
  "problem_code": "problems",
  "title": "Spaceships in Space",
  "tags": [],
  "text": "Aliens attack! Run for your lives!... or not, it's only a video game. And even then, although alien spaceships are flying straight for the Earth, it's not terribly important to destroy them all. Gregory the Gamer only wants that sweet high score.To be more precise, there arenenemy spaceships, flying in a row. Every spaceship is of one of three colours. Our own spaceship is flying opposite of those, from left to right, and can destroy any of them. Destroying a spaceship of colour i is worth pipoints. If you destroy more than one spaceship of the same color in a row, you get more points - second spaceship in sequence is worth \r\n2pipoints, for the third one you get 3piand so on. The maximum number of points you can get for one spaceship is limited byM- if the previous rule dictates more than that, you get exactlyMpoints instead.What is the highest score Gregory can get?InputThe first line contains a single integert, denoting number of test cases. Thenttest cases follow.The first line of a test case contains two integersn,M- number of spaceships and points limit for one spaceship (1 ≤n≤ 105, 1 ≤M≤ 100).In the next line there are three integers 1 ≤pA,pB,pC≤M- point values for destroying spaceships of different colours.In the last line there is a string of lengthn- description of subsequent spaceships. Every character is one of the following: A, B, C. Different characters correspond to different colours.OutputFor every test case you should output one integer - highest score you can get.ExampleInput:2\r\n7 5\r\n1 1 5\r\nAAACAAA\r\n6 10\r\n1 1 10\r\nABABABOutput:20\r\n7ExplanationIn the first test case we destroy all six spaceships of colour A, and we get 1+2+3+4+5+5 = 20 points. If we destroyed all of them instead, we'd get (1+2+3)+5+(1+2+3) = 17 points.In the second test case we can first destroy all spaceships of colour A, and then the last spaceship of colour B, which will give us (1+2+3)+1 = 7.",
  "sample_input": "Input:2\r\n7 5\r\n1 1 5\r\nAAACAAA\r\n6 10\r\n1 1 10\r\nABABABOutput:20\r\n7",
  "sample_output": "Not found",
  "link": "https://www.spoj.com/problems/SPA",
  "scraped_at": "2025-08-17 00:33:45",
  "test_cases": [
    {
      "input": "2\r\n7 5\r\n1 1 5\r\nAAACAAA\r\n6 10\r\n1 1 10\r\nABABAB",
      "expected_output": "20\r\n7",
      "type": "sample_1",
      "description": "Original sample 1 from problem statement"
    },
    {
      "input": "5\n6\n6\n8\n9\n2",
      "expected_output": "To be computed",
      "type": "small_case_2",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "2\n5\n4",
      "expected_output": "To be computed",
      "type": "small_case_3",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "4\n2\n4\n9\n3",
      "expected_output": "To be computed",
      "type": "small_case_4",
      "description": "Small array (N ≤ 5)"
    },
    {
      "input": "10\n98050194\n10210910\n34895624\n31856237\n86232354\n77864707\n10493226\n7894477\n7665857\n53382825",
      "expected_output": "To be computed",
      "type": "medium_case_5",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "13\n30988664\n55453112\n50838914\n11232466\n93820238\n54871208\n25250719\n14910963\n85081660\n83390367\n43946142\n43777878\n87366720",
      "expected_output": "To be computed",
      "type": "medium_case_6",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "17\n5483981\n49510570\n74377259\n76537207\n84889184\n73989177\n2888974\n10504733\n36741807\n55178345\n91295923\n9705142\n82577405\n90475421\n63519889\n16397816\n78193782",
      "expected_output": "To be computed",
      "type": "medium_case_7",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "16\n62585428\n99962742\n97441872\n61008639\n35219103\n14342632\n64389214\n20409370\n61194712\n32953195\n24317346\n38208742\n73254994\n20214291\n90409004\n26262148",
      "expected_output": "To be computed",
      "type": "medium_case_8",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "20\n14802696\n56241505\n5194767\n55242210\n47200873\n58126031\n21122532\n71454965\n56165612\n99281703\n54747753\n39049337\n99120213\n87989258\n33234983\n10884090\n98801149\n37992606\n55222036\n28848225",
      "expected_output": "To be computed",
      "type": "medium_case_9",
      "description": "Medium array (5 < N ≤ 20)"
    },
    {
      "input": "98\n89791\n69279\n42515\n64199\n5465\n52271\n6749\n90424\n67604\n84858\n69763\n80055\n8653\n4056\n87283\n45648\n60190\n58444\n84832\n96611\n18253\n28722\n52207\n50530\n29823\n19249\n65135\n49853\n74412\n40710\n26062\n44598\n41226\n92561\n33098\n64944\n1753\n82427\n59957\n70041\n90350\n10902\n5417\n91623\n65895\n49481\n28870\n10214\n40736\n16778\n81261\n7487\n15387\n72525\n85781\n76236\n5608\n42801\n57907\n84952\n93668\n35220\n11091\n50579\n23187\n82274\n21659\n85234\n24489\n17538\n59215\n86444\n14837\n16981\n50274\n45305\n19562\n38036\n97030\n93187\n36791\n82430\n23369\n58119\n4990\n78855\n68028\n27697\n90750\n81367\n22663\n5105\n46145\n41644\n9593\n1855\n42318\n99415",
      "expected_output": "To be computed",
      "type": "large_case_10",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "77\n34486\n27853\n84099\n27023\n20701\n83218\n15513\n37309\n51051\n60151\n53893\n84088\n69160\n59308\n21709\n52208\n90877\n833\n45791\n97896\n53322\n89928\n43629\n98817\n92759\n85867\n65430\n65640\n26651\n79636\n81680\n94989\n36637\n36137\n63877\n68403\n33650\n34105\n26387\n51615\n98889\n94691\n6632\n44243\n81135\n40022\n41902\n70263\n45493\n25674\n13854\n90676\n64573\n86700\n70314\n73118\n71310\n3105\n9122\n2144\n70409\n12350\n84196\n79485\n94548\n74092\n41637\n58557\n11944\n24080\n84206\n16840\n33604\n70116\n6391\n95086\n3600",
      "expected_output": "To be computed",
      "type": "large_case_11",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "25\n327\n99390\n70056\n60659\n68274\n80867\n20644\n62932\n7906\n20307\n43976\n57664\n94791\n90911\n64958\n45052\n83839\n26242\n7664\n75414\n77775\n93757\n64563\n46964\n53974",
      "expected_output": "To be computed",
      "type": "large_case_12",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "100\n89779\n84279\n80323\n72258\n63353\n73816\n79512\n39204\n5158\n38480\n236\n75596\n32778\n67076\n46269\n37730\n63246\n1786\n58564\n40639\n14852\n25991\n11668\n2943\n12964\n48494\n66291\n47830\n41827\n50367\n91022\n62394\n55268\n89441\n76764\n24478\n81262\n19920\n35180\n69463\n23728\n9332\n99103\n5084\n11155\n34375\n14691\n75776\n93435\n74238\n27139\n61418\n86152\n45327\n1973\n90981\n73050\n80907\n50115\n88116\n37290\n29228\n64386\n52968\n14912\n54419\n93584\n72641\n75754\n71696\n30762\n61638\n80659\n111\n25128\n557\n7918\n59909\n1657\n99164\n14669\n21897\n69853\n25528\n16899\n18118\n64430\n37515\n98446\n14023\n35293\n31956\n82248\n90667\n64729\n48524\n34429\n48426\n10044\n50846",
      "expected_output": "To be computed",
      "type": "large_case_13",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "79\n82616\n38395\n97292\n62568\n2999\n40857\n87122\n89418\n95647\n61316\n46210\n70130\n97501\n20828\n27418\n69097\n75007\n43537\n21567\n15337\n73197\n79417\n67108\n66851\n83423\n85014\n45135\n12104\n16631\n37464\n13942\n93359\n4533\n65723\n23799\n47143\n8565\n48984\n76034\n50759\n809\n24020\n77673\n31204\n31083\n68786\n10741\n372\n14415\n11512\n15266\n85257\n72058\n74300\n70776\n75487\n2651\n24571\n39247\n72041\n61643\n43898\n23263\n6923\n11236\n37292\n99727\n23230\n67157\n10751\n84003\n16889\n83274\n29832\n36063\n5854\n56441\n90907\n77025",
      "expected_output": "To be computed",
      "type": "large_case_14",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "29\n37964\n75837\n28975\n49927\n17966\n59610\n62912\n65724\n73620\n36742\n25476\n90038\n3217\n7880\n620\n32685\n49585\n89635\n21338\n59957\n54881\n56222\n47108\n36293\n62009\n43744\n37744\n96829\n36355",
      "expected_output": "To be computed",
      "type": "large_case_15",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "102\n40910\n23972\n33839\n4698\n35183\n70605\n42695\n37947\n87777\n85296\n60409\n80938\n97377\n18848\n82310\n46703\n41571\n37051\n4985\n67306\n26356\n43112\n54627\n63031\n6758\n46567\n31647\n32158\n72868\n32651\n38882\n28173\n37977\n48246\n53350\n42905\n75685\n72854\n24555\n20577\n19065\n13459\n13836\n91508\n29202\n48258\n75523\n37359\n5422\n44744\n40061\n23953\n44646\n174\n21047\n99275\n36808\n85834\n76333\n16515\n91931\n76104\n19147\n44311\n27405\n3453\n61328\n23671\n70351\n13522\n66283\n90659\n71287\n63456\n73092\n85060\n53725\n47890\n67736\n20634\n3940\n36560\n97561\n85544\n47850\n57444\n76851\n82224\n10914\n91017\n27543\n54738\n454\n9981\n79766\n27328\n37712\n32178\n28090\n48953\n78441\n73024",
      "expected_output": "To be computed",
      "type": "large_case_16",
      "description": "Large array (20 < N ≤ 500)"
    },
    {
      "input": "105\n34014632\n37395640\n28838022\n26037837\n45942947\n4418943\n5337285\n48390941\n11986662\n16908782\n2904118\n69079525\n70421182\n95227379\n50284858\n85364877\n61237793\n53236171\n5428874\n59847985\n56881584\n40003133\n89033447\n57141489\n36157390\n68889157\n30239723\n67563664\n15584310\n75290360\n53413830\n52303279\n10633021\n29870602\n11202851\n12962659\n7712112\n84610973\n96161729\n10132710\n15213901\n3993797\n79905134\n91146059\n48867973\n74208727\n46198046\n23150350\n89268374\n14234440\n6031171\n98768945\n31451669\n26338988\n97543200\n80909832\n15165654\n32757256\n53591888\n5670021\n7224019\n44142367\n13065183\n68337737\n27867415\n23815568\n50224059\n3981011\n50545750\n20437831\n75724656\n79556074\n74988033\n85684051\n92330202\n31896116\n29349985\n61425324\n24250823\n23044270\n81671785\n33276824\n72482925\n48194688\n61446648\n88481747\n62040233\n30119543\n10501033\n34065039\n50387592\n78951935\n42800947\n56310149\n48291793\n31734784\n52462467\n38705720\n72761738\n73088091\n63468923\n60200997\n74634788\n97524731\n11795806",
      "expected_output": "To be computed",
      "type": "max_case_17",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "105\n92051814\n33033344\n8236059\n55724719\n63314950\n76976449\n85014730\n19456969\n5808109\n81443429\n54478947\n64347761\n9478776\n1211725\n81387771\n58842124\n42779316\n77118036\n76952428\n39258674\n48320800\n62974802\n71380632\n67024718\n94163864\n60861033\n20374210\n35910661\n28708367\n26759936\n61852621\n14998404\n92452681\n5014925\n11716858\n59256445\n51741109\n24153673\n34314577\n78882351\n34795540\n17326585\n18116889\n57759126\n9195772\n72457793\n49132980\n36384164\n7636676\n93608146\n47629846\n79638606\n70867740\n7493593\n3968135\n85086680\n29594894\n52710647\n69527581\n90205019\n12904126\n16225424\n72870345\n69324747\n66123476\n65908108\n43995938\n41428566\n29256233\n91384268\n20468023\n83856795\n34691664\n63731285\n53290189\n6900655\n75745576\n51426356\n93037124\n22012034\n29788807\n21629964\n46959606\n61146581\n81587978\n1024123\n53241551\n32729009\n13594381\n73261654\n47408629\n27292986\n85108678\n69547760\n7022492\n55015950\n82533371\n69604298\n58422934\n20635224\n77239964\n45688359\n37394815\n48218273\n19104524",
      "expected_output": "To be computed",
      "type": "max_case_18",
      "description": "Maximum size array (N = 105)"
    },
    {
      "input": "1\n1",
      "expected_output": "To be computed",
      "type": "edge_case_19",
      "description": "Edge case array (N = 1)"
    },
    {
      "input": "1\n100000000",
      "expected_output": "To be computed",
      "type": "edge_case_20",
      "description": "Edge case array (N = 1)"
    }
  ],
  "test_cases_generated_at": "2025-08-19 22:43:17",
  "total_test_cases": 20
}